#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble
\usepackage{dcolumn}
\usepackage{booktabs}
\usepackage{array}
\usepackage{longtable}
\usepackage{graphicx}
\renewcommand{\doiprefix}{doi:\kern-1pt}
\setlength{\bibsep}{10pt}

% use 'handout' to produce handouts
%\documentclass[handout]{beamer}
\usepackage{wasysym}
\usepackage{pgfpages}
%for bold upright roman in math for matrix algebra
\newcommand{\vn}[1]{\mbox{{\it #1}}}\newcommand{\vb}{\vspace{\baselineskip}}\newcommand{\vh}{\vspace{.5\baselineskip}}\newcommand{\vf}{\vspace{\fill}}\newcommand{\splus}{\textsf{S-PLUS}}\newcommand{\R}{\textsf{R}}

%%\input{theme/guidePreambleSweavel.tex} 
%%% From beamer slide:
\usepackage{Sweave}
%% 
%% This controls display of code chunks
\usepackage{ae,fancyvrb,relsize,listings}

\providecommand{\Sweavesize}{\normalsize}
\providecommand{\Rsize}{}
\renewcommand{\Rsize}{\normalsize}
\providecommand{\Routsize}{\scriptsize}

\providecommand{\Rcolor}{\color[rgb]{0.1, 0.1, 0.1}}
\providecommand{\Routcolor}{\color[rgb]{0.2, 0.2, 0.2}}
\providecommand{\Rcommentcolor}{\color[rgb]{0.101, 0.43, 0.432}}

\providecommand{\Rbackground}{\color[gray]{0.91}}
\providecommand{\Routbackground}{\color[gray]{0.935}}
% Can specify \color[gray]{1} for white background or just \color{white}

\lstdefinestyle{Rinput}{
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  basicstyle=\Rsize\Rcolor\ttfamily,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%,
  commentstyle=\Rcommentcolor\ttfamily,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1{==}{{=\,=}}2{--}{{-\,-}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},%
  backgroundcolor=\Rbackground,%
  numbers=left,%
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}%

% Other options of interest:
% frame=single,framerule=0.1pt,framesep=1pt,rulecolor=\color{blue},
% numbers=left,numberstyle=\tiny,stepnumber=1,numbersep=7pt,
% keywordstyle={\bf\Rcolor}

\lstdefinestyle{Routput}{fancyvrb=false,
  literate={~}{{$\sim$}}1{R^2}{{$R^{2}$}}2{^}{{$^{\scriptstyle\wedge}$}}1{R-squared}{{$R^{2}$}}2,%
  basicstyle=\Routcolor\Routsize\ttfamily,%
  backgroundcolor=\Routbackground,
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1 {==}{{=\,=}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},
  numbers=left,
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}

\renewenvironment{Schunk}{}{}
\renewenvironment{Sinput}{}{}
\let\Sinput\relax
\let\Scode\relax
\let\Soutput\relax
\lstnewenvironment{Sinput}{\lstset{style=Rinput}}{}
\lstnewenvironment{Scode}{\lstset{style=Rinput}}{}
\lstnewenvironment{Soutput}{\lstset{style=Routput}}{}
%%end paste in from guidePreambleSweavel.tex


\lstset{tabsize=2, breaklines=true, style=Rinput, breakatwhitespace=true}

\fvset{listparameters={\setlength{\topsep}{0em}}}

\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.90}
\usepackage{realboxes}
\providecommand*{\code}[1]{\texttt{#1}}
\renewcommand{\code}[1]{%
\Colorbox{light-gray}{#1}%
}%
%% end of paste

\usepackage[natbibapa]{apacite}

\definecolor{darkblue}{HTML}{1e2277}

%would be in beamerthemekucrmda%
\mode<presentation>
\definecolor{kublue}{RGB}{0,81,186}
\usefonttheme{professionalfonts}
\useoutertheme{infolines}
\useinnertheme{rounded}
%disable rounded for alert and example boxes%
\setbeamertemplate{blocks}[default]
\usecolortheme{whale}
\usecolortheme{orchid}
\setbeamercolor{structure}{bg=kublue,fg=kublue!90!black}
%\setbeamercolor{structure}{fg=kublue}
\setbeamercolor{frametitle}{bg=kublue}
\setbeamercolor{section in toc}{fg=kublue!40!black}

\setbeamertemplate{frametitle continuation}[from second]
\renewcommand\insertcontinuationtext{...}
\beamertemplatenavigationsymbolsempty
%end of beamerthemekucrmda%

%If you want bigger margins, try this:
\setbeamersize{text margin left=05mm,text margin right=10mm} 
\hypersetup{colorlinks,allcolors=.,urlcolor=darkblue}
%Following seems to have no effect now
%\usepackage{handoutWithNotes}
%\pgfpagesuselayout{3 on 1 with notes}[letterpaper, border shrink=5mm]

\titlegraphic{\includegraphics[width=6cm]{theme/logo}}
\logo{\includegraphics[width=5mm]{theme/logomini}}
\end_preamble
\options aspectratio=1609
\use_default_options false
\begin_modules
logicalmkup
sweave
natbibapa
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref false
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style \use_bibtopic false
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\branch R
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch semboot
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\branch cfalvm
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%following is LyX shortcut 
\backslash
vb for bold upright math for matrices
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\vb}[1]{\bm{\mathrm{#1}}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch R
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% tmpout directory must exist first
\end_layout

\begin_layout Plain Layout

<<excludemetmpout, echo=FALSE, include=FALSE, results=hide>>=
\end_layout

\begin_layout Plain Layout

tdir <- "tmpout"
\end_layout

\begin_layout Plain Layout

if(!dir.exists(tdir)) dir.create(tdir, showWarnings=FALSE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=tmpout/t,split=T,ae=F,height=4.5,width=7}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<excludemeRoptions, echo=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

opts.orig <- options()
\end_layout

\begin_layout Plain Layout

options(width=100, prompt = " ", continue = "  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE)
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

par.orig <- par(no.readonly = TRUE) 
\end_layout

\begin_layout Plain Layout

pjmar <- c(4.1, 4.1, 1.5, 2.1)
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(mar=pjmar, ps=12, xpd=F)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=F,family="Times",pointsize=12)
\end_layout

\begin_layout Plain Layout

if(!file.exists("theme")) file.symlink("../../../../template/theme", "theme")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Title
The DiffTest Trauma 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
difftest
\end_layout

\end_inset


\end_layout

\begin_layout Subtitle
(and how I'm recovering from it)
\end_layout

\begin_layout Author
Paul Johnson
\begin_inset Flex InstituteMark
status open

\begin_layout Plain Layout
1
\end_layout

\end_inset


\end_layout

\begin_layout Institute
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
1
\end_layout

\end_inset

Center for Research Methods and Data Analysis 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
CRMDA
\end_layout

\end_inset


\end_layout

\begin_layout Date
2019
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
The following causes the table of contents to be shown at the beginning
 of every subsection.
 Delete this, if you do not want it.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
AtBeginSection[]{
\end_layout

\begin_layout Plain Layout

  
\backslash
frame<beamer>{ 
\end_layout

\begin_layout Plain Layout

    
\backslash
frametitle{Outline}
\end_layout

\begin_layout Plain Layout

    
\backslash
tableofcontents[currentsection] 
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Outline}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
R User Point of view
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks,containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{R's anova() function}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Is this model better than that model? 
\emph on
We are always asking that.
\end_layout

\begin_layout Itemize
In R 
\begin_inset CommandInset citation
LatexCommand citep
key "RCore"
literal "true"

\end_inset

, one of the staples of regression analysis is the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 function.
\end_layout

\begin_layout Itemize
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 is a generic function comparing fitted models.
 There are versions for many kinds of models.
\end_layout

\begin_layout Itemize
In regression, for example
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

m1 <- lm(y ~ x1 + x2 + x3 + x4, data = fakedata)
\end_layout

\begin_layout Plain Layout

m2 <- lm(y ~ x1 + x2, data = fakedata)
\end_layout

\begin_layout Plain Layout

anova(m2, m1)
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
The output will be an F test, indicating whether or not m1 
\begin_inset Quotes eld
\end_inset

got worse
\begin_inset Quotes erd
\end_inset

 when x3 and x4 were omitted 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks,containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Write that out as a hypothesis test}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Models are nested if the 
\begin_inset Quotes eld
\end_inset

smaller
\begin_inset Quotes erd
\end_inset

 one can be achieved by deleting features from the larger one.
 (or the larger one is achieved by adding features to the smaller one)
\end_layout

\begin_layout Itemize
the larger model is 
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+\beta_{4}x4_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
the smaller model omits variables x3 and x4:
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
The null hypothesis is 
\begin_inset Formula $H_{0}:\beta_{3}=\beta_{4}=0$
\end_inset


\end_layout

\begin_layout Itemize
In ordinary least squares regression analysis, the F test is appropriate.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks,containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Here's what confuses most new R users}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 function is a general purpose thing, applies to many model types, even
 ones that are not based on 
\begin_inset Quotes eld
\end_inset

sums of squares
\begin_inset Quotes erd
\end_inset

 or ANOVA concepts.
 
\end_layout

\begin_layout Itemize
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 does provide an 
\begin_inset Quotes eld
\end_inset

F
\begin_inset Quotes erd
\end_inset

 test for regression, as ANOVA users expect
\end_layout

\begin_layout Itemize
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 for other types of models will provide a likelihood ratio test or a score
 test or a 
\begin_inset Formula $\ldots$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
R design philosophy urges us to re-use function names were possible.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What about lavaan?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Flex Code
status open

\begin_layout Plain Layout
lavaan
\end_layout

\end_inset

 implemented code for the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 generic function.
 
\end_layout

\begin_layout Itemize
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 re-organizes the information and passes it along to a lavaan specific model
 comparison function called 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
lavTestLRT()
\end_layout

\end_inset

.
 Users can access that directly if they don't want to use 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What is a Likelihood Ratio Test?}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Basic Idea.
 
\end_layout

\begin_layout Itemize
Step 1.
 Run 1 model.
 
\end_layout

\begin_layout Itemize
Step 2.
 Add some features and run that again.
 
\end_layout

\begin_layout Itemize
These models are 
\begin_inset Quotes eld
\end_inset

nested
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
may not delete elements while adding more.
 
\end_layout

\begin_layout Itemize
may not change sample size while adding features
\end_layout

\end_deeper
\begin_layout Itemize
Step 3.
 Compare the 2 models by comparing their likelihoods.
 Let 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $L_{max}$
\end_inset

 be the value of the likelihood value at its maximum for the model with
 the most features.
\end_layout

\begin_layout Itemize
\begin_inset Formula $L_{0}$
\end_inset

 be the value of the likelihood function in a 
\begin_inset Quotes eld
\end_inset

smaller
\begin_inset Quotes erd
\end_inset

 model.
\end_layout

\end_deeper
\begin_layout Itemize
Let 
\begin_inset Formula $\lambda$
\end_inset

, (Greek 
\begin_inset Quotes eld
\end_inset

lambda
\begin_inset Quotes erd
\end_inset

), be the 
\begin_inset Quotes eld
\end_inset

likelihood ratio
\begin_inset Quotes erd
\end_inset

 of 
\begin_inset Formula $L_{0}$
\end_inset

 to 
\begin_inset Formula $L_{max}$
\end_inset

:
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\lambda=\frac{L_{0}}{L_{max}}=\frac{L_{smaller\,model}}{L_{bigger\,model}}
\]

\end_inset


\end_layout

\begin_layout Standard
Intuitively, 
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\lambda$
\end_inset

 is near 1, then the models are about the same, so choose the smaller one.
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\lambda$
\end_inset

 is very very small, then the smaller model is much worse, so keep the other.
 
\end_layout

\end_deeper
\begin_layout Itemize
Here's the magic trick.
 If the sample size upon which these models are calculated is infinite,
 then 
\end_layout

\begin_deeper
\begin_layout AlertBlock
\begin_inset Argument 2
status open

\begin_layout Plain Layout
\begin_inset Formula $-2\ln(\lambda)$
\end_inset

 has a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution with 
\begin_inset Formula $k$
\end_inset

 degrees of freedom
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
where 
\begin_inset Formula $k$
\end_inset

 is the number of parameters removed in the smaller model.
 
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
Sometimes called 
\begin_inset Formula $-2LLR$
\end_inset

 (LLR = log of likelihood ratio)
\end_layout

\begin_layout Itemize
Math reminder: 
\end_layout

\begin_deeper
\begin_layout Standard
The log of a ratio is the difference of the logs:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
ln(a/b)=ln(a)-ln(b)
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Hence 
\begin_inset Formula 
\begin{align*}
-2ln(\lambda) & =-2ln\left(\frac{L_{0}}{L_{max}}\right)=-2\{ln(L_{0})-ln(L_{max})\}\\
 & =2ln(L_{max})-2ln(L_{0})\\
 & =2\{ln(L_{max})-ln(L_{0})\}
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize
In order to claim that a difference is 
\begin_inset Quotes eld
\end_inset

statistically significantly different from 0 with probability 0.05
\begin_inset Quotes erd
\end_inset

, you hope that number is bigger than the critical value of the 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{In Case you Can't visualize a Chi-square distribution}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<chi10, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq(0.1, 10, by = 0.01)
\end_layout

\begin_layout Plain Layout

xprob <- dchisq(x, df = 1)
\end_layout

\begin_layout Plain Layout

plot(x, xprob, type = "l")
\end_layout

\begin_layout Plain Layout

xprob2 <- dchisq(x, df = 2)
\end_layout

\begin_layout Plain Layout

lines(x, xprob2, lty = 2, col = 2, lwd = 2)
\end_layout

\begin_layout Plain Layout

xprob3 <- dchisq(x, df = 3)
\end_layout

\begin_layout Plain Layout

lines(x, xprob3, lty = 3, col = 3, lwd = 2)
\end_layout

\begin_layout Plain Layout

xprob4 <- dchisq(x, df = 4)
\end_layout

\begin_layout Plain Layout

lines(x, xprob4, lty = 4, col = 4, lwd = 2)
\end_layout

\begin_layout Plain Layout

legend("topright", legend = c("df = 1", "df = 2", "df = 3", "df = 10"),
 
\end_layout

\begin_layout Plain Layout

       lty = 1:4, col = 1:4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=12cm]{tmpout/t-chi10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Critical values of a Chi-square distribution ($
\backslash
alpha$ 0.05)}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<chi30, echo=FALSE, results=tex>>=
\end_layout

\begin_layout Plain Layout

df <- 1:10
\end_layout

\begin_layout Plain Layout

critical.value <- qchisq(0.05, df, lower.tail = FALSE)
\end_layout

\begin_layout Plain Layout

mytable <- cbind(df, critical.value)
\end_layout

\begin_layout Plain Layout

library(xtable)
\end_layout

\begin_layout Plain Layout

myxtable <- xtable(mytable)
\end_layout

\begin_layout Plain Layout

print(myxtable, type = "latex", use.rownames = FALSE, floating = FALSE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
Roughly speaking, the -2LLR value needs to be larger than the degrees of
 freedom, by a scale of 2 to 4, in order to be 
\begin_inset Quotes eld
\end_inset

statistically significant
\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{LR tests, in practice}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Using SAS, SPSS
\end_layout

\begin_deeper
\begin_layout Itemize
Run one model, save output, print it out.
\end_layout

\begin_layout Itemize
Run another model, save output, print it out
\end_layout

\end_deeper
\begin_layout Itemize
Use a calculator to calculate -2 LLR and look it up in the 
\begin_inset Formula $\chi^{2}$
\end_inset

 table.
\end_layout

\begin_layout Itemize
Only feasible if output includes the numbers we need (which, we find out
 next, is often not true in SEM)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Special Issues in SEM
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The $
\backslash
chi^2$ model test in SEM}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
SEM output usually includes a statistic referred to as 
\begin_inset Quotes eld
\end_inset

model Chi-square
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
the large model is the 
\begin_inset Quotes eld
\end_inset

saturated model
\begin_inset Quotes erd
\end_inset

, one which has the largest possible value of the likelihood (because it
 includes all possible parameters)
\end_layout

\begin_layout Itemize
the smaller model is the likelihood for the user's chosen specification.
 
\end_layout

\end_deeper
\begin_layout Itemize
User hopes that -2LLR is 
\emph on
not statistically significant
\emph default
, as if to say 
\begin_inset Quotes eld
\end_inset

my model explains a sufficient amount of variance because it is close enough
 to the best possible model.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
Often used as a first piece of evidence that the model is 
\begin_inset Quotes eld
\end_inset

good enough
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Problems with model $
\backslash
chi^2$ test}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
The 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset


\begin_inset Quotes erd
\end_inset

 test is only approximately distributed as a 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic.
\end_layout

\begin_deeper
\begin_layout Enumerate
The LLR test assumes the sample size is infinite (but it is generally not).
 
\end_layout

\end_deeper
\begin_layout Enumerate
The model 
\begin_inset Formula $\chi^{2}$
\end_inset

 test may be unreasonably discouraging, even minute differences are 
\begin_inset Quotes eld
\end_inset

statistically significant
\begin_inset Quotes erd
\end_inset

 with larger samples.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Published Indictments of the $
\backslash
chi^2$ test}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
There are publications documenting the inaccuracy of the SEM 
\begin_inset Formula $\chi^{2}$
\end_inset

-based LLR test, even for large samples.
 
\end_layout

\begin_deeper
\begin_layout Standard
Satorra, A., and Bentler, P.
 M.
 (1994).
 “Corrections to test statistics and standard errors in covariance structure
 analysis,” in 
\emph on
Latent Variables Analysis: Applications for Developmental Research
\emph default
, eds A.
 von Eye, and C.
 C.
 Clogg (Thousand Oaks, CA: SAGE Publications), 399–419.
\end_layout

\begin_layout Standard
Satorra, A.
 (2000).
 Scaled and adjusted restricted tests in multi-sample analysis of moment
 structures.
 In Heijmans, R.D.H., Pollock, D.S.G.
 & Satorra, A.
 (eds.), 
\emph on
Innovations in multivariate statistical analysis.

\emph default
 A Festschrift for Heinz Neudecker (pp.233-247).
 London: Kluwer Academic Publishers.
\end_layout

\begin_layout Standard
Satorra, A., & Bentler, P.
 M.
 (2001).
 A scaled difference chi-square test statistic for moment structure analysis.
 
\emph on
Psychometrika
\emph default
, 66(4), 507-514.
\end_layout

\begin_layout Standard
Satorra, A., & Bentler, P.M.
 (2010).
 Ensuring positiveness of the scaled difference chi-square test statistic.
 
\emph on
Psychometrika
\emph default
, 75, 243-248.
 
\end_layout

\end_deeper
\begin_layout Itemize
And, by the developers of Mplus
\end_layout

\begin_deeper
\begin_layout Standard
Asparouhov, T.
 & Muthén, B.
 (2006).
 Robust Chi Square Difference Testing with mean and variance adjusted test
 statistics.
 Mplus Web Notes: No.
 10.
 May 26, 2006.
 
\end_layout

\begin_layout Standard
Asparouhov, T.
 & Muthén, B.
 (2010).
 Computing the strictly positive Satorra-Bentler chi-square test in Mplus.
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://www.statmodel.com/examples/webnotes/SB5.pdf
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Hence, we have competing suggestions, all of which are backed up by simulations
 and theorems, which suggest they have the best way to re-scale and modify
 the 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic
\begin_inset Quotes erd
\end_inset

, and probably also the model standard errors.
\end_layout

\begin_layout Itemize
From now on, we will refer to these things generically as 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistics
\begin_inset Quotes erd
\end_inset

, even though they are, in fact, not 
\begin_inset Formula $\chi^{2}$
\end_inset

 distributed.
 Although some re-scaled values are close to 
\begin_inset Formula $\chi^{2}$
\end_inset

 than others.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What do we know, for sure}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Even if the data is truly drawn from a multivariate-normal data generator,
 the 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic
\begin_inset Quotes erd
\end_inset

 that is typically reported with ML estimates is not accurate
\end_layout

\begin_layout Itemize
As the data deviates from normality, the deviation of the 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic
\begin_inset Quotes erd
\end_inset

 from a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution becomes more pronounced.
\end_layout

\begin_layout Itemize
Some re-scaling of the 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic
\begin_inset Quotes erd
\end_inset

 is called for, and either the Satorra-Bentler suggestions or the Asparouhov
 & Muthen suggestions, are improvements.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Caution about rescaled statistics}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
If the software rescales 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic
\begin_inset Quotes erd
\end_inset

, then the reported value cannot be compared across models.
 
\end_layout

\begin_layout Itemize
It is NOT allowed to subtract them to form a post-hoc LLR test.
 
\end_layout

\begin_layout Itemize
On Unscaled fit statistics, We can improvise 
\begin_inset Formula $2\{ln(L_{1})-ln(L_{2})\}$
\end_inset

 by taking
\begin_inset Formula 
\[
\mathrm{reported\,model\,1\,}\,\chi^{2}:\,2ln(L_{1})-2ln(L_{0})
\]

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
and
\begin_inset Formula 
\[
\mathrm{reported\,model\,2}\,\,:2ln(L_{2})-2ln(L_{0})
\]

\end_inset


\end_layout

\begin_layout Standard
subtract one from the other:
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula 
\[
2ln(L_{1})-2ln(L_{0})-2ln(L_{2})+2ln(L_{0})
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
2ln(L_{1})-\xcancel{2ln(L_{0})}-2ln(L_{2})+\xcancel{2ln(L_{0})}
\]

\end_inset


\end_layout

\begin_layout Itemize
When the scaling has been applied, the 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic
\begin_inset Quotes erd
\end_inset

 is no longer a simple sum, and the usual thing to do is always wrong.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{How did Commercial Software Adapt?}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
MPLUS
\end_layout

\begin_layout Itemize
For models that use a scaled 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic
\begin_inset Quotes erd
\end_inset

 MPlus offers the following procedure.
\end_layout

\begin_deeper
\begin_layout Enumerate
Fit one model.
 Insert a stanza with the command 
\begin_inset Quotes eld
\end_inset

SAVEDATA
\begin_inset Quotes erd
\end_inset

, as in
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

SAVEDATA:
\end_layout

\begin_layout Plain Layout

  DIFFTEST = model1.dif;
\end_layout

\end_inset


\end_layout

\begin_layout Standard
the output file can be any legal file name.
\end_layout

\end_deeper
\begin_layout Enumerate
Then run a second model, and ask for a diff test compared against the saved
 model file
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

ANALYSIS: DIFFTEST IS model1.dif
\end_layout

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Take a Look at a diff file}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is a single column of un-labeled output, with various values, vectors,
 and matrices thrown together.
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "basicstyle={\tiny},tabsize=1"
inline false
status open

\begin_layout Plain Layout

 1.768739314948761E-004
\end_layout

\begin_layout Plain Layout

           1
\end_layout

\begin_layout Plain Layout

          22
\end_layout

\begin_layout Plain Layout

          19
\end_layout

\begin_layout Plain Layout

   1.00000000000000     
\end_layout

\begin_layout Plain Layout

  0.000000000000000E+000
\end_layout

\begin_layout Plain Layout

  0.000000000000000E+000
\end_layout

\begin_layout Plain Layout

  0.000000000000000E+000
\end_layout

\begin_layout Plain Layout

  0.000000000000000E+000
\end_layout

\begin_layout Plain Layout

  0.000000000000000E+000
\end_layout

\begin_layout Plain Layout

...[snip]
\end_layout

\begin_layout Plain Layout

 -1.455231515017422E-002
\end_layout

\begin_layout Plain Layout

 -8.481935382156272E-002
\end_layout

\begin_layout Plain Layout

 -0.158546226444418     
\end_layout

\begin_layout Plain Layout

  2.890432611036050E-002
\end_layout

\begin_layout Plain Layout

  8.653350827758647E-003
\end_layout

\begin_layout Plain Layout

 -4.346341800339478E-002
\end_layout

\begin_layout Plain Layout

 -9.327387467894621E-002
\end_layout

\begin_layout Plain Layout

 -1.992458362913379E-002
\end_layout

\begin_layout Plain Layout

 -9.790624138486069E-002
\end_layout

\begin_layout Plain Layout

 -0.103097018690428     
\end_layout

\begin_layout Plain Layout

 -0.206034705941789     
\end_layout

\begin_layout Plain Layout

 -4.600490626847783E-003
\end_layout

\begin_layout Plain Layout

 -4.661276672608555E-002
\end_layout

\begin_layout Plain Layout

 -6.300500112246536E-002
\end_layout

\begin_layout Plain Layout

 -0.121049791982158     
\end_layout

\begin_layout Plain Layout

  5.383824055426895E-003
\end_layout

\begin_layout Plain Layout

 -3.467974760189810E-002
\end_layout

\begin_layout Plain Layout

   2.94053552225483     
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Bentler and Satorra's counter proposal}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\series bold
EQS
\end_layout

\begin_layout Itemize
Satorra and Bentler created another approximate scaled statistic that can
 be calculated using standard output, pencil, paper, and a calculator.
\end_layout

\begin_layout Itemize
The last version of EQS implemented that version of their test.
\end_layout

\begin_layout Itemize
In 2017, we obtained the newest version of EQS and quickly discovered that
 the raw data was not being imported correctly.
 We reported the bug and stopped using the software.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
What is CRMDA doing about it?
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{How did I bump into this problem?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Mplus is an expensive program, I don't want to pay for it.
 But
\end_layout

\begin_layout Itemize
KU students have told me they must have it! There's a thing called DIFFTEST
 and journal reviewers require it.
 They cannot do without it.
 And the formula is confidential! 
\begin_inset Foot
status open

\begin_layout Plain Layout
Well, wait
\begin_inset Formula $\ldots$
\end_inset

.
 Its partially confidential.
 The DIFFTEST formula is not spelled out with perfect clarity in the Mplus
 guides.
 But there are hints that may be sufficient in the eyes of the Mplus team.
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In Summer 2017, we tried to figure out
\end_layout

\begin_deeper
\begin_layout Enumerate
what the Mplus DIFFTEST is doing, 
\end_layout

\begin_layout Enumerate
if we can implement an equivalent comparison in R, probably with lavaan
 models
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What did we find out?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Project 1.
 Learn what is in the SAVEDATA result file and figure out what's in there,
 and then verify the DIFF Test Results from Mplus.
\end_layout

\begin_layout Itemize
Project 2.
 Generate equivalent test results from a function we would create with R
 code
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Project 1: Mission Accomplished}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
View online: 
\begin_inset CommandInset href
LatexCommand href
name "Replicating the Mplus DIFFTEST Procedure: An R Function to Reproduce Nested Model Comparisons"
target "http://crmda.dept.ku.edu/guides/44.difftest/44.difftest.html"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
Check writeup folder in this workshop folder.
\end_layout

\begin_layout Itemize
That guide explains that our goal is to recover a test statistic 
\begin_inset Formula 
\[
T_{3}=a\cdot T.chisq+b
\]

\end_inset


\end_layout

\begin_layout Itemize
where we need to create 
\begin_inset Formula $a$
\end_inset

 
\begin_inset Formula $b$
\end_inset

 and 
\begin_inset Formula $T.chisq$
\end_inset


\begin_inset Formula 
\[
T.chisq=\{T_{large}-T_{small}\}\cdot N\cdot2
\]

\end_inset


\end_layout

\begin_layout Itemize
and 
\begin_inset Formula $T_{large}$
\end_inset

 and 
\begin_inset Formula $T_{small}$
\end_inset

 are the 
\emph on
unscaled
\emph default
 final fits from the 2 models being compared.
 These unscaled values are not reported in the usual output, they instead
 must be harvested from the *.dif file that was saved for each model.
\end_layout

\begin_layout Itemize
The calculation of 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

 required a lot of guessing about which values in the diff file can be assigned
 to which matrix, but, in the end, the results match.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Project 2: Develop a Free-standing Replication}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Project 1 showed that if we have the required matrices, we can replicate
 the Mplus DIFFTEST.
\end_layout

\begin_layout Itemize
Project 2 would have us generate the same matrices and re-generate matching
 test statistics.
\end_layout

\begin_deeper
\begin_layout Itemize
So far, we have exact replications for
\end_layout

\begin_deeper
\begin_layout Itemize
1 group models
\end_layout

\begin_layout Itemize
2 (or multi) group models with equal sample sizes within groups
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
We do not replicate Mplus results for multi-group models when case numbers
 differ between groups.
 
\end_layout

\begin_deeper
\begin_layout Itemize
At last inspection, it appears the multi-group variance/covariance matrix
 in Mplus is adjusted in a way for which we are unable to account.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Where does all of this leave you?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
If your journal reviewers insist on the Mplus 
\begin_inset Formula $T_{3}$
\end_inset

 scaled chi-square difference test, for the moment it is necessary to use
 Mplus to conduct the test.
\end_layout

\begin_layout Itemize
If your journal reviewers will accept either the Satorra (2000) proposal,
 or the Satorra-Bentler proposals from 2001 or 2010, these can be supplied
 without Mplus.
 They were implemented in the lavaan source code base and they are now documente
d for the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

 method in 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
lavaan
\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
We believe that Satorra (2000) is closest to correct among these suggestions.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{References}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "../../sem"
options "apalike2"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Session}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sess10>>=
\end_layout

\begin_layout Plain Layout

sessionInfo()
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<excludemeopts20, include=F>>=
\end_layout

\begin_layout Plain Layout

## Don't delete this.
 It puts the interactive session options
\end_layout

\begin_layout Plain Layout

## back the way they were.
 If this is compiled within a session
\end_layout

\begin_layout Plain Layout

## it is vital to do this.
\end_layout

\begin_layout Plain Layout

options(opts.orig)
\end_layout

\begin_layout Plain Layout

options(par.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
