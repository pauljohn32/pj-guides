#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble
\usepackage{dcolumn}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{graphicx}

\renewcommand{\doiprefix}{doi:\kern-1pt}
\setlength{\bibsep}{10pt}

% use 'handout' to produce handouts
%\documentclass[handout]{beamer}
\usepackage{wasysym}
\usepackage{pgfpages}
%for bold upright roman in math for matrix algebra
\newcommand{\vn}[1]{\mbox{{\it #1}}}\newcommand{\vb}{\vspace{\baselineskip}}\newcommand{\vh}{\vspace{.5\baselineskip}}\newcommand{\vf}{\vspace{\fill}}\newcommand{\splus}{\textsf{S-PLUS}}\newcommand{\R}{\textsf{R}}


%%paste in guidePreambleSweavel.tex
%%% From beamer slide:
\usepackage{Sweave}
%% 
%% This controls display of code chunks
\usepackage{ae,fancyvrb,relsize,listings}

\providecommand{\Sweavesize}{\normalsize}
\providecommand{\Rsize}{}
\renewcommand{\Rsize}{\normalsize}
\providecommand{\Routsize}{\scriptsize}

\providecommand{\Rcolor}{\color[rgb]{0.1, 0.1, 0.1}}
\providecommand{\Routcolor}{\color[rgb]{0.2, 0.2, 0.2}}
\providecommand{\Rcommentcolor}{\color[rgb]{0.101, 0.43, 0.432}}

\providecommand{\Rbackground}{\color[gray]{0.91}}
\providecommand{\Routbackground}{\color[gray]{0.935}}
% Can specify \color[gray]{1} for white background or just \color{white}

\lstdefinestyle{Rinput}{
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  basicstyle=\Rsize\Rcolor\ttfamily,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%,
  commentstyle=\Rcommentcolor\ttfamily,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1{==}{{=\,=}}2{--}{{-\,-}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},%
  backgroundcolor=\Rbackground,%
  numbers=left,%
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}%

% Other options of interest:
% frame=single,framerule=0.1pt,framesep=1pt,rulecolor=\color{blue},
% numbers=left,numberstyle=\tiny,stepnumber=1,numbersep=7pt,
% keywordstyle={\bf\Rcolor}

\lstdefinestyle{Routput}{fancyvrb=false,
  literate={~}{{$\sim$}}1{R^2}{{$R^{2}$}}2{^}{{$^{\scriptstyle\wedge}$}}1{R-squared}{{$R^{2}$}}2,%
  basicstyle=\Routcolor\Routsize\ttfamily,%
  backgroundcolor=\Routbackground,
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1 {==}{{=\,=}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},
  numbers=left,
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}

\renewenvironment{Schunk}{}{}
\renewenvironment{Sinput}{}{}
\let\Sinput\relax
\let\Scode\relax
\let\Soutput\relax
\lstnewenvironment{Sinput}{\lstset{style=Rinput}}{}
\lstnewenvironment{Scode}{\lstset{style=Rinput}}{}
\lstnewenvironment{Soutput}{\lstset{style=Routput}}{}

\lstset{tabsize=2, breaklines=true, style=Rinput, breakatwhitespace=true}

\fvset{listparameters={\setlength{\topsep}{0em}}}

\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.90}
\usepackage{realboxes}
\providecommand*{\code}[1]{\texttt{#1}}
\renewcommand{\code}[1]{%
\Colorbox{light-gray}{#1}%
}%
%%end paste in guidePreambleSweavel.tex

\usepackage[natbibapa]{apacite}

\definecolor{darkblue}{HTML}{1e2277}

%would be in beamerthemekucrmda%
\mode<presentation>
\definecolor{kublue}{RGB}{0,81,186}
\usefonttheme{professionalfonts}
\useoutertheme{infolines}
\useinnertheme{rounded}
%disable rounded for alert and example boxes%
\setbeamertemplate{blocks}[default]
\usecolortheme{whale}
\usecolortheme{orchid}
\setbeamercolor{structure}{bg=kublue,fg=kublue!90!black}
%\setbeamercolor{structure}{fg=kublue}
\setbeamercolor{frametitle}{bg=kublue}
\setbeamercolor{section in toc}{fg=kublue!40!black}

\setbeamertemplate{frametitle continuation}[from second]
\renewcommand\insertcontinuationtext{...}
\beamertemplatenavigationsymbolsempty
%end of beamerthemekucrmda%

%If you want bigger margins, try this:
\setbeamersize{text margin left=05mm,text margin right=10mm} 
\hypersetup{colorlinks,allcolors=.,urlcolor=darkblue}
%Following seems to have no effect now
%\usepackage{handoutWithNotes}
%\pgfpagesuselayout{3 on 1 with notes}[letterpaper, border shrink=5mm]

\titlegraphic{\includegraphics[width=6cm]{theme/logo}}
\end_preamble
\options aspectratio=1609
\use_default_options false
\begin_modules
logicalmkup
sweave
natbibapa
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref false
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style \use_bibtopic false
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\branch R
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch semboot
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\branch cfalvm
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Branch R
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% tmpout directory must exist first
\end_layout

\begin_layout Plain Layout

<<tmpout, echo=FALSE, include=FALSE, results=hide>>=
\end_layout

\begin_layout Plain Layout

if(!dir.exists("tmpout")) dir.create("tmpout", showWarnings=FALSE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=tmpout/t,split=T,ae=F,height=4.5,width=7}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Roptions, echo=F>>=
\end_layout

\begin_layout Plain Layout

opts.orig <- options()
\end_layout

\begin_layout Plain Layout

options(width=80, prompt = " ", continue = "  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE)
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

par.orig <- par(no.readonly = TRUE) 
\end_layout

\begin_layout Plain Layout

pjmar <- c(4.1, 4.1, 1.5, 2.1)
\end_layout

\begin_layout Plain Layout

par(mar=pjmar, ps=11)
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(mar=pjmar, ps=12, xpd=F)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=F,family="Times",pointsize=12)
\end_layout

\begin_layout Plain Layout

if(!file.exists("tmpout")) dir.create("tmpout", showWarnings=F)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<texcopy, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

library(stationery)
\end_layout

\begin_layout Plain Layout

## If theme directory does not have required logo files, retrieve them.
\end_layout

\begin_layout Plain Layout

logos <- c(logo = "logo.pdf",
\end_layout

\begin_layout Plain Layout

            logomini = "logomini.pdf")
\end_layout

\begin_layout Plain Layout

getFiles(logos, pkg = "crmda")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Title
Count Regression
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Count
\end_layout

\end_inset


\end_layout

\begin_layout Author
Paul E.
 Johnson
\begin_inset Flex InstituteMark
status open

\begin_layout Plain Layout
1
\end_layout

\end_inset


\end_layout

\begin_layout Institute
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
1
\end_layout

\end_inset

Center for Research Methods and Data Analysis
\begin_inset Argument 1
status open

\begin_layout Plain Layout
KU
\end_layout

\end_inset


\end_layout

\begin_layout Date
2018
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
logo{
\backslash
includegraphics[width=5mm]{theme/logomini}}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
The following causes the table of contents to be shown at the beginning
 of every subsection.
 Delete this, if you do not want it.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
AtBeginSubsection[]{
\end_layout

\begin_layout Plain Layout

  
\backslash
frame<beamer>{ 
\end_layout

\begin_layout Plain Layout

    
\backslash
frametitle{Outline}
\end_layout

\begin_layout Plain Layout

    
\backslash
tableofcontents[currentsubsection] 
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Outline}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%following is LyX shortcut 
\backslash
vb for bold upright math for matrices
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\vb}[1]{\bm{\mathrm{#1}}}
\end_inset


\end_layout

\begin_layout Section
Orientation
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Poisson entry point to GLM}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Logistic and Poisson regression are the two most common entry point to generaliz
ed linear models
\end_layout

\begin_layout Itemize
The Poisson model is a discrete probability distribution.
 
\end_layout

\begin_deeper
\begin_layout Itemize
build a model that predicts the expected value of a Poisson distribution
\end_layout

\begin_layout Itemize
odd implication: expected value same as variance
\end_layout

\end_deeper
\begin_layout Itemize
Rapidly advancing software and theory: this was not feasible when I was
 in graduate school, very significant advances 1988-2000.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Standard Playbook}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Try the basic Poisson GLM (estimated by maximum likelihood)
\end_layout

\begin_layout Itemize
Check diagnostics
\end_layout

\begin_layout Itemize
If diagnostics indicate trouble, explore follow-up models that might be
 more likely to have generated the data
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What comes after Poisson?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Negative Binomial model: same expected value, higher variance
\end_layout

\begin_layout Itemize
Quasi-likelihood: same expected value, higher variance
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Rate
\begin_inset Quotes erd
\end_inset

 models (response variable becomes 
\begin_inset Formula $y_{i}/exposure_{i})$
\end_inset


\end_layout

\begin_layout Itemize
Zero-Inflated mixture models
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Hurdle model
\begin_inset Quotes erd
\end_inset

: No count is observed for cases below a threshold
\end_layout

\begin_layout Itemize
Can be separate formula predicting 
\begin_inset Quotes eld
\end_inset

0 or not
\begin_inset Quotes erd
\end_inset

, and then a Poisson or NB model for the observed counts (jargon 
\begin_inset Quotes eld
\end_inset

two-part model
\begin_inset Quotes erd
\end_inset

)
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Math Reminder
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{log and exp}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
My logistic regression notes (
\begin_inset CommandInset href
LatexCommand href
name "LogitProbit-1"
target "http://pj.freefaculty.org/guides/stat/Regression-GLM/LogitProbit/LogitProbit-1-lecture.pdf"
literal "false"

\end_inset

) have graphs of logarithmic (log) and exponential (exp) functions
\end_layout

\begin_layout Itemize
Important to remember natural log and exponential are inverses of each other,
 so if
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
y=e^{x}
\]

\end_inset


\end_layout

\begin_layout Standard
apply natural log on both sides
\begin_inset Formula 
\begin{align*}
ln(y) & =ln(e^{x})\\
 & =x
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
That's by definition of natural log:
\end_layout

\begin_layout Standard
\begin_inset Formula $log_{e}(y)=x$
\end_inset

, means 
\begin_inset Formula $x$
\end_inset

 is the power to which we must raise 
\begin_inset Formula $e$
\end_inset

 to equal 
\begin_inset Formula $y$
\end_inset

 , so
\begin_inset Formula 
\[
y=e^{x}
\]

\end_inset


\end_layout

\begin_layout Itemize
The general idea of an inverse function: one that 
\begin_inset Quotes eld
\end_inset

undoes
\begin_inset Quotes erd
\end_inset

 the other.
 If a function is
\begin_inset Formula 
\[
g(x)
\]

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
and if 
\begin_inset Formula $g^{-1}$
\end_inset

 is an inverse, then
\begin_inset Formula 
\[
g^{-1}(g(x))=x
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Notation: the superscript is inspired by idea that
\begin_inset Formula 
\begin{align*}
\frac{1}{x}\times x & =1\\
x^{-1} & x=1\\
x & =x
\end{align*}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{exponential detail}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Remember this fact?
\begin_inset Formula 
\begin{equation}
2^{3+5}=2^{3}\times2^{5}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
That's true for all exponential formulas, so
\begin_inset Formula 
\begin{equation}
e^{\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}}=e^{\beta_{0}}\times e^{\beta_{1}X1_{i}}\times e^{\beta_{2}X2_{i}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
And if we are saving vertical space, write that as
\begin_inset Formula 
\begin{equation}
exp(\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i})=exp(\beta_{0})\times exp(\beta_{1}X1_{i})\times exp(\beta_{2}X2_{i})
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
What's the big point.
 By using the transformation 
\begin_inset Formula $exp$
\end_inset

, we create interactions 
\begin_inset Quotes eld
\end_inset

automatically
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{exponential detail 2}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Later on, I'm going to need to claim
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
e^{X_{i}\beta}\times\delta_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
can be re-written as:
\begin_inset Formula 
\[
e^{X_{i}\beta+log(\delta_{i})}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Why? Put the previous exponential facts together
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
e^{X_{i}\beta}\times\delta_{i}\\
=e^{X_{i}\beta}\times exp(log(\delta_{i})\\
=e^{X_{i}\beta+log(\delta_{i})}
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize
So, multiplying 
\begin_inset Formula $e^{X_{i}\beta}$
\end_inset

 by a number 
\begin_inset Formula $\delta_{i}$
\end_inset

 is identical to adding 
\begin_inset Formula $log(\delta_{i})$
\end_inset

 in the exponent.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
GLM
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Counts 
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Description
Definition: Observed outcomes are integers 0, 1, 2, 
\begin_inset Formula $\ldots$
\end_inset

.
\end_layout

\begin_layout Description
Expected
\begin_inset space ~
\end_inset

Value: a positive floating point number, the 
\begin_inset Quotes eld
\end_inset

mean
\begin_inset Quotes erd
\end_inset

 of the 
\begin_inset Quotes eld
\end_inset

data generating process
\begin_inset Quotes erd
\end_inset

 (AKA population).
 
\end_layout

\begin_layout Itemize
Think of the data generating process (DGP) like this
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\eta_{i}=X_{i}\beta$
\end_inset

 (your predictors and coefficients)
\end_layout

\begin_layout Enumerate
\begin_inset Formula $transform(\eta_{i})$
\end_inset

 to get an expected value of the outcome
\end_layout

\begin_layout Enumerate
draw a random value from the probability model using input from step 2.
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Generalized Linear Model Approach}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citep
key "mccullagh_nelder_1989"
literal "false"

\end_inset


\end_layout

\begin_layout Description
Linear
\begin_inset space ~
\end_inset

Predictor 
\begin_inset Formula $\eta_{i}=X_{i}\beta=\beta_{0}+\beta_{1}X1_{i}+\beta_{2}X2_{i}\ldots$
\end_inset

.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
LP is a 
\begin_inset Quotes eld
\end_inset

bottleneck
\begin_inset Quotes erd
\end_inset

, or 
\begin_inset Quotes eld
\end_inset

funnel
\begin_inset Quotes erd
\end_inset

: Effects of all predictors and coefficients 
\begin_inset Quotes eld
\end_inset

go through
\begin_inset Quotes erd
\end_inset

 the LP.
 
\end_layout

\begin_layout Description
Expected
\begin_inset space ~
\end_inset

value Our regression models (
\begin_inset Quotes eld
\end_inset

predicts
\begin_inset Quotes erd
\end_inset

?) the expected value of 
\begin_inset Formula $y_{i}$
\end_inset

, commonly referred to as 
\begin_inset Formula $\mu_{i}$
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
I think of this as a transformation of 
\begin_inset Formula $\eta_{i}$
\end_inset

 into the expected value
\begin_inset Formula 
\begin{equation}
E[y|X_{i}]=\mu_{i}=transform(\eta_{i})
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
We require the 
\begin_inset Formula $transform$
\end_inset

 to be an 
\begin_inset Quotes eld
\end_inset

increasing
\begin_inset Quotes erd
\end_inset

 function: as 
\begin_inset Formula $\eta_{i}$
\end_inset

 goes up, then 
\begin_inset Formula $\mu_{i}$
\end_inset

 must go up.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Examples of transformations that work}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Keep in mind 
\begin_inset Formula $\eta_{i}=X_{i}\beta$
\end_inset

, the linear predictor
\end_layout

\begin_layout Standard
Examples of transformations
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mu_{i}=X_{i}\beta=\eta_{i}$
\end_inset

 (linear!)
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mu_{i}=exp(X_{i}\beta)$
\end_inset

 (exponential)
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mu_{i}=\frac{1}{1+e^{-X_{i}\beta}}=\frac{exp(X_{i}\beta)}{1+exp(X_{i}\beta)}$
\end_inset

 (logistic)
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mu_{i}=\Phi(X_{i}\beta)$
\end_inset

 (probit, 
\begin_inset Formula $\Phi$
\end_inset

 is CDF of Normal distribution)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{IMHO, we are asked to think backwards}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
When McCullagh & Nelder invented this, they thought of the transformation
 on the other side of the equation
\begin_inset Formula 
\begin{equation}
g(\mu_{i})=\eta_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
They
\begin_inset space ~
\end_inset

called
\begin_inset space ~
\end_inset


\begin_inset Formula $g(\mu_{i})$
\end_inset


\begin_inset space ~
\end_inset

the
\begin_inset space ~
\end_inset


\emph on
Link
\begin_inset space ~
\end_inset

Function 
\emph default
converts (expected value of 
\begin_inset Formula $y_{i}$
\end_inset

 back onto 
\begin_inset Formula $\eta_{i}$
\end_inset

)
\end_layout

\begin_layout Standard

\series bold
Example
\series default
: In my way of thinking, the substantively meaningful transformation is
 exponential
\begin_inset Formula 
\[
\mu_{i}=exp(\eta_{i})
\]

\end_inset


\end_layout

\begin_layout Standard
But in their way of thinking, it is a 
\begin_inset Quotes eld
\end_inset

log link
\begin_inset Quotes erd
\end_inset

:
\begin_inset Formula 
\[
log(\mu_{i})=\eta_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
Mathematically, they are same.
 
\end_layout

\begin_layout Standard
But the 
\begin_inset Quotes eld
\end_inset

link
\begin_inset Quotes erd
\end_inset

 function always seemed backwards to my brain!
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Description
Inverse
\begin_inset space ~
\end_inset

Link
\begin_inset space ~
\end_inset

Function
\end_layout

\begin_layout Itemize
We can 
\begin_inset Quotes eld
\end_inset

swap
\begin_inset Quotes erd
\end_inset

 between my way and their way because of assumption:
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula $g(u_{i})$
\end_inset

 is increasing (monotonic)
\end_layout

\end_deeper
\begin_layout Itemize
These are equivalent
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
g(\mu_{i})=\eta_{i}\,,\mathrm{and}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mu_{i}=g^{-1}(\eta_{i})
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

inverse link
\begin_inset Quotes erd
\end_inset

 function 
\begin_inset Formula $g^{-1}$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
However, carrying around notation 
\begin_inset Formula $g^{-1}$
\end_inset

 is tedious, so we give that transform some other letter, say 
\begin_inset Formula $h$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $h()$
\end_inset

: The thing I called 
\begin_inset Formula $transform$
\end_inset

 above 
\begin_inset Formula 
\[
\mu_{i}=h(\eta_{i})=h(X_{i}\beta)
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
McCullagh & Nelder provided an estimation algorithm that works for a wide
 variety of models (probability distributions from the exponential family,
 which includes the Normal, Binomial, Poisson, Gamma, and others)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Normal
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
OLS from a GLM point-of-view.
\end_layout

\begin_layout Itemize
The outcome is Normal, but the 
\begin_inset Formula $\mu_{i}$
\end_inset

 parameter is different for every case:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
y_{i}\sim N(\eta_{i},\sigma_{\varepsilon}^{2})
\]

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\eta_{i}=\vb X_{i}\vb{\beta}$
\end_inset

 dials the Normal distribution's expected value up and down.
 
\end_layout

\begin_layout Itemize
Example of the 
\begin_inset Quotes eld
\end_inset

Identity
\begin_inset Quotes erd
\end_inset

 link
\end_layout

\begin_layout Itemize
\begin_inset Formula $\sigma_{\varepsilon}^{2}$
\end_inset

: A variance parameter same for all 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Itemize
Flaws: The Normal distribution will not serve well with count data
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Count data: we require discrete outcomes 0, 1, 2, 
\begin_inset Formula $\ldots$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\eta_{i}$
\end_inset

 may be negative
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
More on Poisson and Neg Binomial
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
My 
\begin_inset Quotes eld
\end_inset

distribution writeups
\begin_inset Quotes erd
\end_inset

 folder has more detailed descriptions and illustrations
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Itemize
Poisson 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/guides/stat/Distributions/DistributionWriteups/Poisson/P
oisson_v1-2.pdf
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Negative Binomial 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/guides/stat/Distributions/DistributionWriteups/NegativeB
inomial/NegativeBinomial.pdf
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Frame

\end_layout

\begin_layout Section
Working Examples
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Building a set for instructional purposes}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Will have data ready for use in R and Stata, with some example code.
 
\end_layout

\begin_layout Itemize
gavote: the 
\begin_inset Quotes eld
\end_inset

undercount
\begin_inset Quotes erd
\end_inset

 (lost ballot) problem in Georgia (from R package faraway)
\end_layout

\begin_layout Itemize
workdays: days missed at work due to mental health concern (from R package
 smdata)
\end_layout

\begin_layout Itemize
goals: soccer goals scored by players in the European league
\end_layout

\begin_layout Itemize
COUNT: extracted from the R package COUNT
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Ex: Georgia vote data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The outcome that I model is 
\begin_inset Quotes eld
\end_inset

wasted ballots
\begin_inset Quotes erd
\end_inset

 in Georgia counties as a function of the urban/rural classification of
 the county, the percent African American, and the type of voting equipment
 that is used.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
tiny}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois50}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Ex: Georgia vote data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois50hist}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Poisson
\end_layout

\begin_layout Subsection
Theory
\end_layout

\begin_layout Frame
\begin_inset Argument 3
status open

\begin_layout Plain Layout
allowframebreaks
\end_layout

\end_inset


\begin_inset Argument 4
status open

\begin_layout Plain Layout
Poisson Distribution
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Poisson has one parameter, commonly called 
\begin_inset Formula $\lambda_{i}$
\end_inset

.
\end_layout

\begin_layout Itemize
The probability mass function (PMF: probability of value 
\begin_inset Formula $y$
\end_inset

 given parameter 
\begin_inset Formula $\lambda$
\end_inset

) is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Pr(y|\lambda)=\frac{exp(-\lambda)\lambda^{y}}{y!},\mathrm{or}
\]

\end_inset


\begin_inset Formula 
\[
\frac{e^{-\lambda}\lambda^{y}}{y!}
\]

\end_inset


\end_layout

\begin_layout Itemize
Does not make sense if 
\begin_inset Formula $\lambda<0.$
\end_inset

 I mean, we require 
\begin_inset Formula $\lambda\geq0$
\end_inset

.
\end_layout

\begin_layout Itemize
We'll need subscript i
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $i$
\end_inset

 to remember this value may differ among observations, 
\begin_inset Formula $i\in\{1,...,N\}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
In regression, we are going to say that each row of 
\begin_inset Formula $y$
\end_inset

 is drawn from a different PMF.
 
\begin_inset Formula $\lambda_{i}$
\end_inset

 is different for each: 
\begin_inset Formula 
\[
Pr(y|\lambda_{i})=\frac{exp(-\lambda_{i})\lambda_{i}^{y_{i}}}{y!}
\]

\end_inset


\end_layout

\begin_layout Itemize
Using this, we can say how likely any value of 
\begin_inset Formula $y$
\end_inset

 might be.
\end_layout

\begin_layout Itemize
In particular, for likelihood analysis, we can say how likely a particular
 observed value 
\begin_inset Formula $y_{i}$
\end_inset

 was for a given 
\begin_inset Formula $\lambda_{i}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Visualize the Poisson Probability Mass Function}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=12cm]{cplots/t-pois01}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Poisson Sample, large mu}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=12cm]{cplots/t-pois02}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Special Poisson Properties}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The Expected Value of the Poisson PMF is equal to its Variance
\end_layout

\begin_layout Itemize
And both are equal to the value of the parameter 
\begin_inset Formula $\lambda_{i}$
\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $E[y_{i}]=\lambda_{i}{}_{i}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $Var[y_{i}]=\lambda_{i}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Beware of my errors: Sometimes, my notes have 
\begin_inset Formula $\mu_{i}$
\end_inset

 in place of 
\begin_inset Formula $\lambda_{i}$
\end_inset

 because the expected value is commonly referred to as 
\begin_inset Formula $\mu_{i}$
\end_inset

 in GLM literature
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Need to Be Careful Modeling 
\begin_inset Formula $\lambda_{i}$
\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
The wrong link function might lead to disaster: 
\begin_inset Formula 
\begin{equation}
\lambda_{i}=\vb X_{i}\vb{\beta}
\end{equation}

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
If 
\begin_inset Formula $\vb X_{i}\vb{\beta}<0$
\end_inset

 , the PMF is undefined!
\end_layout

\end_deeper
\begin_layout Itemize
A transformation 
\begin_inset Formula $h$
\end_inset

 is needed!
\begin_inset Formula 
\begin{equation}
h(\vb X_{i}\vb{\beta})
\end{equation}

\end_inset

 
\end_layout

\begin_layout Itemize
The most common transformation is the exponential function.
\begin_inset Formula 
\[
\lambda_{i}=exp(\eta_{i})=exp(\vb X_{i}\vb{\beta})
\]

\end_inset


\end_layout

\begin_layout Itemize
Implies the log link function, 
\begin_inset Formula $log(\mu_{i})=\eta_{i}$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Noteworthy 
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Theoretically: EV = Var = 
\begin_inset Formula $\lambda_{i}$
\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
That's simple, but is does observed data have this property?
\end_layout

\end_deeper
\begin_layout Enumerate
The shape changes.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
When 
\begin_inset Formula $\lambda_{i}$
\end_inset

 is small, it has lots of 
\begin_inset Formula $0$
\end_inset

's, is very asymmetric
\end_layout

\begin_layout Itemize
As 
\begin_inset Formula $\lambda_{i}$
\end_inset

 grows, approaches a unimodal shape.
\end_layout

\end_deeper
\begin_layout Enumerate
Because large 
\begin_inset Formula $\lambda_{i}\rightarrow$
\end_inset

 a more 
\begin_inset Quotes eld
\end_inset

Normal
\begin_inset Quotes erd
\end_inset

 appearance, some argue in favor of using a GLM with a Normally distributed
 outcome in that case.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Simulated X and Y}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
X1_{i}\sim N(20,5)
\]

\end_inset


\begin_inset Formula 
\[
X2_{i}\sim N(10,3),
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\eta_{i}=0.1+0.75X1_{i}-0.15X2_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Draw observed scores 
\begin_inset Formula 
\begin{equation}
y|\eta\sim Pois(exp(\eta_{i}))
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
You'll see the fit is very accurate for slope coefficients
\end_layout

\begin_layout Standard
Residual deviance is VERY 
\begin_inset Quotes eld
\end_inset

touchy
\begin_inset Quotes erd
\end_inset

 with small changes in range of predictors or coefficients
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Does This Surprise You?}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
9cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois20}
\end_layout

\end_inset


\end_layout

\begin_layout Column
3cm
\end_layout

\begin_layout Standard
Thinking something went wrong? I was.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Histogram of y}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
9cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{cplots/t-pois21}
\end_layout

\end_inset


\end_layout

\begin_layout Column
3cm
\end_layout

\begin_layout Itemize
Discouraged? Don't worry.
\end_layout

\begin_layout Itemize
Estimates next page are almost ridiculously accurate!
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Poisson GLM Fit}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois30}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Quotes eld
\end_inset

Residual deviance
\begin_inset Quotes erd
\end_inset

 is in ballpark of df (discuss overdispersion below)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Just for Curiosity, fit OLS}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois31}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Poisson Graph Code}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois35}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{cplots/t-pois35}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Manipulate plotCurves to get overlay}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois35_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{plotCurves output}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois35_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{From x2's point of view}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois36}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois36}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Fitting
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Maximum Likelihood Analysis
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Replace 
\begin_inset Formula $\lambda_{i}$
\end_inset

 in PMF with 
\begin_inset Formula $exp(\vb X_{i}\vb{\beta})$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Pr(y_{i}|\vb X_{i},\vb{\beta})=\frac{exp(-exp(\vb X_{i}\vb{\beta}))(exp(\vb X_{i}\vb{\beta}))^{y_{i}}}{y_{i}!}
\]

\end_inset


\end_layout

\begin_layout Standard
or it looks slightly less ugly if we write:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Pr(y_{i}|\vb X_{i}\vb{\beta})=\frac{exp(-e^{\vb X_{i}\vb{\beta}})(e^{\vb X_{i}\vb{\beta}})^{y_{i}}}{y_{i}!}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Estimation: ML
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Choose 
\begin_inset Formula $\beta$
\end_inset

 to maximize the Likelihood function:
\begin_inset Formula 
\[
L(\beta;y,X)=Pr(y_{1}|X_{i}\beta)*Pr(y_{2}|X_{i}\beta)*...*Pr(y_{N}|X_{i}\beta)
\]

\end_inset


\end_layout

\begin_layout Itemize
The log likelihood
\begin_inset Formula 
\begin{equation}
lnL=\sum_{i=1}^{N}ln(Pr(y_{i}|\vb X_{i}\vb{\beta}))
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset CommandInset citation
LatexCommand citet
key "mccullagh_nelder_1989"
literal "true"

\end_inset

 demonstrated a method of iterative calculation (IRLS) that will find the
 maximum for all members of the exponential family of distributions.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Subsection
Diagnostics: Overdispersion
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{GLM model diagnostics}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In 2006, I wrote up the most gigantic GLM notes ever....
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/guides/stat/Regression-GLM/GLM1-Overview/GLM1-guide.pdf
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/guides/stat/Regression-GLM/GLM2-SigTests/GLM-2-guide.pdf
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
A primary worry about Poisson regression is 
\begin_inset Quotes eld
\end_inset

overdispersion
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Description
Overdispersion: observed variance of 
\begin_inset Formula $y$
\end_inset

 is greater than anticipated by the Poisson theory
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{GLM model diagnostics}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Poisson regression output includes 
\begin_inset Quotes eld
\end_inset

residual deviance
\begin_inset Quotes erd
\end_inset

.
 A 
\begin_inset Quotes eld
\end_inset

rule of thumb
\begin_inset Quotes erd
\end_inset

 is that if the residual deviance is much greater than the degrees of freedom,
 then the mismatch between the model and the data is unacceptably large
\end_layout

\begin_layout Itemize
Definition: 
\begin_inset Quotes eld
\end_inset

deviance
\begin_inset Quotes erd
\end_inset

: the difference in the quality of fit between 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
a fitted model (your model) and 
\end_layout

\begin_layout Enumerate
the 
\series bold
saturated model
\end_layout

\begin_deeper
\begin_layout Itemize
the best fitting model that could be obtained by making a prediction 
\begin_inset Formula $\mu_{i}$
\end_inset

 for each unique group of predictor values.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Itemize
The saturated model is a very very good model, fits the data as well as
 possible.
\end_layout

\end_deeper
\begin_layout Itemize
The research question: is 
\begin_inset Quotes eld
\end_inset

your model
\begin_inset Quotes erd
\end_inset

 unacceptably far from the saturated model.
\end_layout

\end_deeper
\begin_layout Itemize
The comparison of the likelihoods is written like this:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
scaled\,model\,deviance=-2ln\left[\frac{L(fitted)}{L(saturated)}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
scaled\,model\,deviance=2lnL(saturated\,model)-2lnL(fitted\,model)
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
similar to a likelihood ratio test (makes you expect a 
\begin_inset Formula $\chi^{2}$
\end_inset

 test)
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $y$
\end_inset

 is Normal, then as the sample size grows, this test statistic is increasingly
 similar to a Chi-squared random variable.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Itemize
For other distributions of 
\begin_inset Formula $y$
\end_inset

, or for small samples, the comparison of the scaled model deviance against
 a 
\begin_inset Formula $Chi-squared$
\end_inset

 distribution is approximate
\end_layout

\begin_layout Itemize
If the fitted model residual deviance is grossly different from the degrees
 of freedom, something is wrong.
\end_layout

\begin_deeper
\begin_layout Itemize
Often our first suspect is 
\begin_inset Quotes eld
\end_inset


\series bold
overdispersion
\series default

\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_layout Itemize
Or something else wrong in the variance function
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{More rigorous overdispersion tests}
\end_layout

\end_inset


\end_layout

\begin_layout Quote
A common way to 'discover' over- or underdispersion is to notice that the
 residual deviance is appreciably different from the residual degrees of
 freedom...
 This can be seriously misleading.
 The theory is asymptotic.
 (Venables & Ripley, MASS 4ed, p.
 208)
\end_layout

\begin_layout Quote
Other suggestions in Smithson & Merkle
\end_layout

\begin_deeper
\begin_layout Enumerate
sum of squared Pearson residuals as a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distributed variable
\end_layout

\begin_layout Enumerate
AER package dispersiontest.
\end_layout

\end_deeper
\begin_layout Itemize
However, I wouldn't fuss to much over a formal test.
 If residual deviance is noticeably more than degrees of freedom, then generally
 people expect you to move on to a more sophisticated model.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Another diagnostic suggestion}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the COUNT package, it is suggested to make a table like so
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
observed value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Proportion Observed
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Proportion Predicted
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Difference
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.18
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-0.3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
.05
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Their function 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
poi.obs.pred
\end_layout

\end_inset

 can produce that table for a poisson model.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Stop run examples here}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
STOP.
 Run examples here, probably
\end_layout

\begin_layout Enumerate
Soccer Scores
\end_layout

\begin_layout Enumerate
Sick days
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Interpretation
\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Nonlinearity 
\begin_inset Formula $\mu_{i}=exp(X_{i}\beta)$
\end_inset


\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
3cm
\end_layout

\begin_layout Itemize
Small 
\begin_inset Formula $X\beta$
\end_inset

: no noticeable effect
\end_layout

\begin_layout Itemize
Larger 
\begin_inset Formula $X_{i}\beta$
\end_inset

: more noticeable effect
\end_layout

\begin_layout Column
9cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{cplots/t-exp10}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout ColumnsTopAligned

\end_layout

\begin_layout Standard
The effect of anything depends on everything else.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Interpretation: Think of Predicted Values
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
The expected value of 
\begin_inset Formula $y_{i}$
\end_inset

 depends on 
\begin_inset Formula $\mu_{i}=exp(X_{i}\beta$
\end_inset

).
 
\begin_inset Formula 
\[
E(y_{i}|X_{i})=exp(X_{i}\hat{\beta})
\]

\end_inset


\end_layout

\begin_layout Itemize
If the k'th variable changes, the impact is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial E(y_{i}|X_{i})}{\partial x_{k}}=\hat{\beta}_{k}*E(y_{i}|X_{i})
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\hat{\beta}_{k}*exp(X_{i}\hat{\beta})
\]

\end_inset


\end_layout

\begin_layout Itemize
Scott Long's excellent book 
\emph on
Regression Models for Categorical and Limited Dependent Variables
\emph default
 has many helpful interpretations
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{percentage change interpretation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
I usually get confused on this, lets try to stay close to the book:
\end_layout

\begin_layout Standard
Smithson & Merkle (p.
 117)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lambda_{i}=exp(\beta_{0})exp(\beta_{1}X1_{i})exp(\beta_{2}X2_{i})\ldots
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Quotes eld
\end_inset

Focusing on interpretation of, say, 
\begin_inset Formula $\beta_{1}$
\end_inset

, we want to compare the predicted value of 
\begin_inset Formula $\lambda_{i}$
\end_inset

at 
\begin_inset Formula $X1_{i}$
\end_inset

 and at 
\begin_inset Formula $(X1_{i}+1)$
\end_inset

(with all other 
\begin_inset Formula $Xk$
\end_inset

 held constant).
 The equation can be used to show that the prediction at 
\begin_inset Formula $(X1_{i}+1)$
\end_inset

 equals the prediction at 
\begin_inset Formula $X1_{i}$
\end_inset

 times 
\begin_inset Formula $exp(\beta_{1})$
\end_inset

.
 Thus, 
\begin_inset Formula $exp(\beta_{1})$
\end_inset

 is associated with the percentage change in the predicted value of 
\begin_inset Formula $\lambda$
\end_inset

 associated with every point increase in 
\begin_inset Formula $X1_{i}$
\end_inset

.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Let me see if I can work that out with a 2 predictor model
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lambda1_{i}=exp(\beta_{0})exp(\beta_{1}X1_{i})exp(\beta_{2}X2_{i})\ldots
\]

\end_inset


\begin_inset Formula 
\[
\lambda2_{i}=exp(\beta_{0})exp(\beta_{1}(X1_{i}+1))exp(\beta_{2}X2_{i})
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lambda2_{i}/\lambda1_{i}=\frac{\cancel{exp(\beta_{0})}exp(\beta_{1}(X1_{i}+1))\cancel{exp(\beta_{2}X2_{i})}}{\cancel{exp(\beta_{0})}exp(\beta_{1}X1_{i})\cancel{exp(\beta_{2}X2_{i})}}
\]

\end_inset


\begin_inset Formula 
\[
=e^{\beta_{1}X1_{i}+\beta_{1}}e^{-\beta_{1}X1_{i}}
\]

\end_inset


\begin_inset Formula 
\[
=e^{\beta_{1}}
\]

\end_inset


\end_layout

\begin_layout Standard
So, the 
\begin_inset Quotes eld
\end_inset

proportional increase
\begin_inset Quotes erd
\end_inset

 due to a 1 unit change of the predictor is 
\begin_inset Formula $exp(\beta_{1})$
\end_inset

.
\end_layout

\begin_layout Itemize
However, put 
\begin_inset Formula $\lambda1$
\end_inset

 on RHS and we see 
\begin_inset Formula 
\[
\lambda2_{i}=e^{\beta_{1}}\lambda1_{i}
\]

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
The predicted 
\begin_inset Formula $\lambda2_{i}$
\end_inset

 is proportionally related to 
\begin_inset Formula $e^{\beta_{1}}\lambda1_{i}$
\end_inset

.
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\beta_{1}=1$
\end_inset

, then 
\begin_inset Formula $\lambda2_{i}=\lambda1_{i}$
\end_inset


\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\beta_{1}=0.1$
\end_inset

, then 
\begin_inset Formula $\lambda2_{i}=exp(0.1)\lambda1_{i}=1.1051\lambda1_{i}$
\end_inset

 
\end_layout

\end_deeper
\begin_layout Itemize
A proportional change of 1.1051 is the same as a 10.51 percent change.
\end_layout

\begin_deeper
\begin_layout Itemize
If we want the percent increase, multiply by 100.
\end_layout

\end_deeper
\begin_layout Itemize
Smithson & Merkle mention that if the 
\begin_inset Formula $\beta$
\end_inset

 coefficient is small (
\begin_inset Formula $|\beta|<2)$
\end_inset

, then a rule of thumb applies: 
\begin_inset Formula $100\beta$
\end_inset

 is very close to the decimal part of 
\begin_inset Formula $exp(\beta_{1})\times100$
\end_inset

.
 
\end_layout

\begin_layout Itemize
I've just verified that in R by running this:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<smcheck, fig=T, include=F, height=5, width=5>>=
\end_layout

\begin_layout Plain Layout

beta <- seq(0, 0.2, length=1000)
\end_layout

\begin_layout Plain Layout

betaexp <- exp(beta)
\end_layout

\begin_layout Plain Layout

beta100 <- beta*100
\end_layout

\begin_layout Plain Layout

plot(beta100, betaexp, type=
\begin_inset Quotes erd
\end_inset

l
\begin_inset Quotes erd
\end_inset

,  main = 
\begin_inset Quotes eld
\end_inset

100 * beta is very close to the decimal of betaexp * 100
\begin_inset Quotes erd
\end_inset

, xlab = 
\begin_inset Quotes eld
\end_inset

100 * beta
\begin_inset Quotes erd
\end_inset

, ylab = 
\begin_inset Quotes eld
\end_inset

exp(beta)
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

m1 <- lm(betaexp ~ beta100)
\end_layout

\begin_layout Plain Layout

abline(m1, col=
\begin_inset Quotes erd
\end_inset

red
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

legend(
\begin_inset Quotes eld
\end_inset

topleft
\begin_inset Quotes erd
\end_inset

, legend = c(
\begin_inset Quotes eld
\end_inset

observed
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

OLS fit
\begin_inset Quotes erd
\end_inset

), 
\end_layout

\begin_layout Plain Layout

      lty = c(1, 1), col = c(
\begin_inset Quotes eld
\end_inset

black
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

red
\begin_inset Quotes erd
\end_inset

))  
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout


\backslash
includegraphics[width=5cm]{tmpout/t-smcheck}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The slope of the red line is about 0.011.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Summary Poisson Shortcomings
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate

\series bold
Overdispersion
\series default
: Suppose for a given 
\begin_inset Formula $\vb X_{i}$
\end_inset

 the predicted value is 7 but there are scores ranging from 0 to 60 and
 the variance of observations for that 
\begin_inset Formula $\vb{X_{i}}$
\end_inset

is 20.
 That's the problem that most of the researchers discuss
\end_layout

\begin_layout Enumerate

\series bold
Zero-Inflation
\series default
: Observe more 
\begin_inset Formula $0$
\end_inset

's than expected, given 
\begin_inset Formula $\lambda_{i}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Underdispersion: Less widely discussed
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Example 1: Overdispersion in action}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Julian Faraway's R package 
\begin_inset Quotes eld
\end_inset

faraway
\begin_inset Quotes erd
\end_inset

 includes a data set 
\begin_inset Quotes eld
\end_inset

gavote
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{A Poisson Regression}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois51}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{A Couple of Plots, Because I Can}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois52}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{A Couple of Plots, Because I Can}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois53}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Negative Binomial: A log(gamma) Random Effect
\end_layout

\begin_layout Subsection
Insert a Random Effect
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Insert a Random Effect}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Supplement the linear predictor 
\begin_inset Formula $\vb X_{i}\vb{\beta}$
\end_inset

 with an added noise 
\begin_inset Formula $v_{i}$
\end_inset

.
\end_layout

\begin_layout Itemize
We insert 
\begin_inset Formula $\vb X_{i}\vb{\beta}+v_{i}$
\end_inset

 into the Poisson data generating process where we previously inserted 
\begin_inset Formula $\vb X_{i}\vb{\beta}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
This is additional individual-level randomness:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Two observations with same 
\begin_inset Formula $\vb X_{i}$
\end_inset

 can have different Poisson probabilities because 
\begin_inset Formula $v_{i}$
\end_inset

 differs among individuals.
\end_layout

\end_deeper
\begin_layout Itemize
The terms 
\begin_inset Quotes eld
\end_inset

frailty
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

heterogeneity
\begin_inset Quotes erd
\end_inset

 are used for this individual-level random noise.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Log Link}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
We will keep the assumption of the log link, so 
\begin_inset Formula $\mu_{i}=exp(\vb X_{i}\vb{\beta}+v_{i})$
\end_inset


\end_layout

\begin_layout Itemize
We re-phrase the data generating process from this:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
Pr(y_{i}|\vb X_{i}\vb{\beta})=\frac{exp(-e^{\vb X_{i}\vb{\beta}})(e^{\vb X_{i}\vb{\beta}})^{y_{i}}}{y_{i}!}
\]

\end_inset


\end_layout

\begin_layout Standard
to this:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Pr(y_{i}|\vb X_{i}\vb{\beta})=\frac{exp(-e^{\vb X_{i}\vb{\beta}+v_{i}})(e^{\vb X_{i}\vb{\beta}+v_{i}})^{y_{i}}}{y_{i}!}\label{eq:NB_DGP}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Math Reminders: Is your error additive or multiplicative?}
\end_layout

\end_inset


\end_layout

\begin_layout Description
Remember this is a Mathematical law
\begin_inset Formula 
\begin{equation}
e^{\vb X_{i}\vb{\beta}+v_{i}}=e^{\vb X_{i}\vb{\beta}}\times e^{v_{i}}\label{eq:NB1}
\end{equation}

\end_inset


\end_layout

\begin_layout Description
Let 
\begin_inset Formula $ln(\delta_{i})=v_{i}$
\end_inset

which implies 
\begin_inset Formula $\delta_{i}=e^{v_{i}}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:NB1"

\end_inset

) is the same as
\begin_inset Formula 
\begin{equation}
e^{\vb X_{i}\vb{\beta}}\times\delta_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
or
\begin_inset Formula 
\begin{equation}
e^{\vb X_{i}\vb{\beta}+ln(\delta_{i})}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
One can think of this new randomness as either 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Adding the log of 
\begin_inset Formula $\delta$
\end_inset

 into 
\begin_inset Formula $X_{i}\beta$
\end_inset


\end_layout

\begin_layout Enumerate
Multiplying 
\begin_inset Formula $exp(X_{i}\beta)$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Error term should be neutral!}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In the multiplicative story, 
\begin_inset Formula $e^{\vb X_{i}\vb{\beta}}\times e^{v_{i}}=e^{\vb X_{i}\vb{\beta}}\times\delta_{i}$
\end_inset

, we want
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E[\delta_{i}]=1
\]

\end_inset


\end_layout

\begin_layout Itemize
In the additive story 
\begin_inset Formula $e^{\vb X_{i}\vb{\beta}+ln(\delta{}_{i})}=e^{\vb X_{i}\vb{\beta}+v_{i}}$
\end_inset

 
\begin_inset Formula 
\[
E[ln(\delta_{i})]=E[v_{i}]=0
\]

\end_inset


\end_layout

\begin_layout Itemize
Remember that 
\begin_inset Formula $ln(1)=0$
\end_inset

? These things are consistent!
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

On average
\begin_inset Quotes erd
\end_inset

 the extra error term has 
\begin_inset Quotes eld
\end_inset

no effect
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 3
status open

\begin_layout Plain Layout
allowframebreaks
\end_layout

\end_inset


\begin_inset Argument 4
status open

\begin_layout Plain Layout
Gamma error is a natural candidate
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
We require a random variable 
\begin_inset Formula $\delta_{i}$
\end_inset

 with 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
expected value of 
\begin_inset Formula $1$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\delta_{i}>0$
\end_inset


\begin_inset Formula 
\[
f_{y}(y|shape,exp(X\beta))=\frac{\Gamma(shape+y)}{\Gamma(shape)y!}\bullet\frac{(exp(X\beta)^{y}shape^{shape}}{(exp(X\beta)+shape)^{shape+y}}
\]

\end_inset


\end_layout

\begin_layout Standard
(Venables and Ripley, 4th ed, p.
 206)
\end_layout

\end_deeper
\begin_layout Itemize
We'll use the Gamma distribution.
\end_layout

\begin_layout Itemize
Technical convenience: it is known (in a math stats book) that 
\begin_inset Formula $Poisson(\vb X_{i}\vb{\beta}+log(\delta_{i}))$
\end_inset

 is distributed as a Negative Binomial random variable.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 3
status open

\begin_layout Plain Layout
allowframebreaks
\end_layout

\end_inset


\begin_inset Argument 4
status open

\begin_layout Plain Layout
NB: A Mixture Distribution
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
If the outcome is conditional Poisson (depending on 
\begin_inset Formula $\delta_{i}$
\end_inset

), 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
y_{i}\,|\,\delta_{i}\sim Poisson(exp(X_{i}\beta)*\delta_{i})
\]

\end_inset


\end_layout

\begin_layout Itemize
Then 
\begin_inset Formula $y_{i}$
\end_inset

 follows a Negative Binomial Distribution.
 
\end_layout

\begin_layout Description
Negative
\begin_inset space ~
\end_inset

Binomial: a discrete PMF that has separate expected value and scale parameters
\end_layout

\begin_layout Standard
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/guides/stat/Distributions/DistributionWriteups/NegativeB
inomial/NegativeBinomial.pdf
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Story: it is the number of 
\begin_inset Quotes eld
\end_inset

tails
\begin_inset Quotes erd
\end_inset

 that occur before a 
\begin_inset Quotes eld
\end_inset

heads
\begin_inset Quotes erd
\end_inset

 in a sequence of coin flips, with a possibly biased coin.
 (Think 
\begin_inset Quotes eld
\end_inset

tails
\begin_inset Quotes erd
\end_inset

 = nothing observed yet or no failure yet and 
\begin_inset Quotes eld
\end_inset

heads
\begin_inset Quotes erd
\end_inset

 = something happened, failure observed, etc.)
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 3
status open

\begin_layout Plain Layout
allowframebreaks
\end_layout

\end_inset


\begin_inset Argument 4
status open

\begin_layout Plain Layout
Simpler Version of Gamma
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
A Gamma distribution has two parameters, shape and scale, 
\begin_inset Formula $Gamma(shape,\,scale)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/guides/stat/Distributions/DistributionWriteups/Gamma/Gam
ma-02.pdf
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Here we simplify by assuming 
\begin_inset Formula $scale=1/shape$
\end_inset

, so a two parameter random distribution
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\delta_{i}\sim Gamma(shape,scale)
\]

\end_inset


\end_layout

\begin_layout Standard
becomes a one parameter distribution
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\delta_{i}\sim Gamma(shape,1/shape)
\]

\end_inset


\end_layout

\begin_layout Itemize
Because for Gamma 
\begin_inset Formula $E[\delta_{i}]=shape\cdot scale$
\end_inset

, then this special one-parameter model has 
\begin_inset Formula $E[\delta]=1.0$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Under the restriction between 
\begin_inset Formula $shape$
\end_inset

 and 
\begin_inset Formula $scale,$
\end_inset


\begin_inset Formula 
\[
Var[\delta_{i}]=1/shape
\]

\end_inset


\end_layout

\begin_layout Itemize
So, as the shape parameter gets bigger, the variance of 
\begin_inset Formula $\delta_{i}$
\end_inset

 gets smaller, and eventually vanishes
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Gamma PDF assuming shape*scale=1
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{cplots/t-gamma10}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Gamma PDF assuming shape*scale=1
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{cplots/t-gamma20}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator parbreak
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The density of the additive errors, $ln(
\backslash
delta)$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{cplots/t-gamma30}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The density of the additive errors, $ln(
\backslash
delta)$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{cplots/t-gamma40}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Frame
\begin_inset Argument 4
status open

\begin_layout Plain Layout
Estimating 
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Fitting is an iterative, two-stage process.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
The shape estimate is chosen
\end_layout

\begin_layout Itemize
Then the slope parameters are estimated.
 
\end_layout

\end_deeper
\begin_layout Itemize
Repeat until estimates converge to stable values.
\end_layout

\begin_layout Itemize
The MASS package for R provides a procedure 
\begin_inset Quotes eld
\end_inset

glm.nb
\begin_inset Quotes erd
\end_inset

 which will do maximum likelihood to estimate the b's and the shape parameter.
 (In Venables & Ripley, p.
 207, the 
\begin_inset Quotes eld
\end_inset

shape
\begin_inset Quotes erd
\end_inset

 parameter is called 
\begin_inset Formula $\theta$
\end_inset

).
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Neg.
 Binomial $
\backslash
Longleftrightarrow$ Poisson}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Neg Binomial has the same expected value as the Poisson:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
E(y_{i})=exp(X_{i}\beta)
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
But more variance
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
Var(y_{i})=exp(X\beta)+exp(X\beta){}^{2}/shape
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
If 
\begin_inset Formula $shape\rightarrow\infty$
\end_inset

, then the variance of 
\begin_inset Formula $y_{i}$
\end_inset

 tends to 
\begin_inset Formula $exp(X_{i}\beta)$
\end_inset

, same as Poisson.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Overdispersion
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Do we really need to bother with this?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
If the data is produced by a 
\begin_inset Quotes eld
\end_inset

mixed model
\begin_inset Quotes erd
\end_inset

 of the NB type, a Poisson regression model's estimates 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
are inefficient and 
\end_layout

\begin_layout Itemize
have bad standard errors (hypo tests are wrong).
\end_layout

\end_deeper
\begin_layout Itemize
Some authors will keep the parameter estimates, but use 
\begin_inset Quotes eld
\end_inset

robust
\begin_inset Quotes erd
\end_inset

 standard errors (to avoid introducing another parameter for the mixture
 variance).
\end_layout

\begin_layout Itemize
The counter-argument is that we should generally begin with the NB model.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks,containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{An informative LR test}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Fit both NB and Poisson, then try to decide if the NB is a significant improveme
nt
\end_layout

\begin_layout Itemize
The Poisson model is 
\begin_inset Quotes eld
\end_inset

nested
\begin_inset Quotes erd
\end_inset

 inside the NB model, but 
\begin_inset Formula $shape\rightarrow\infty$
\end_inset

 to lead to equivalence.
 
\end_layout

\begin_layout Itemize
This is a 
\begin_inset Quotes eld
\end_inset

nonstandard
\begin_inset Quotes erd
\end_inset

 hypothesis test because null hypo is on boundary of parameter space.
\end_layout

\begin_layout Itemize
Achim Zeileis suggests a likelihood ratio test with the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
lrtest
\end_layout

\end_inset

 in the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
lmtest
\end_layout

\end_inset

 package 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://stats.stackexchange.com/questions/127505/compare-poisson-and-negative-binom
ial-regression-with-lr-test
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Long p.
 237 discusses other tests.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Example 1: Continued}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois55}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Compare output side-by-side}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois57}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Plots not too much different}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois56}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Plots not too much different}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{cplots/t-pois57}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Compare output side-by-side}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois57}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Hypo test}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{cplots/t-pois59}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
GLMM
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Start at the Beginning, Again}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Poisson is 
\begin_inset Quotes eld
\end_inset

underdispersed
\begin_inset Quotes erd
\end_inset

 compared to the data
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Pr(y_{i}|\vb X_{i}\vb{\beta})=\frac{exp(-e^{\vb X_{i}\vb{\beta}})(e^{\vb X_{i}\vb{\beta}})^{y_{i}}}{y_{i}!}
\]

\end_inset


\end_layout

\begin_layout Itemize
Insert an additive error 
\begin_inset Formula $v_{i}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Pr(y_{i}|\vb X_{i}\vb{\beta})=\frac{exp(-e^{\vb X_{i}\vb{\beta}+v_{i}})(e^{\vb X_{i}\vb{\beta}+v_{i}})^{y_{i}}}{y_{i}!}\label{eq:NB_DGP-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Now we'll say that's Normally distributed, 
\begin_inset Formula $v_{i}\sim N(0,\sigma_{v}^{2})$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Zero inflated models
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Too-Many-Zeroes Problem}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Poisson Count models allow for 
\begin_inset Quotes eld
\end_inset

a lot of 0's
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
NB model allows even more 0's.
\end_layout

\begin_layout Itemize
Suppose the data has still more 0's.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Process Explanations}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
How many packs of cigarettes did you buy this month?
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
many respondents say 0, they don't want cancer (thanks for asking)
\end_layout

\begin_layout Itemize
Some will say 1, 2, 
\begin_inset Formula $\ldots$
\end_inset

, 10, or 40
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Two-Part Model}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

zero-inflated
\begin_inset Quotes erd
\end_inset

 Poisson or Negative Binomial models are tailored to that kind of story.
\end_layout

\begin_layout Itemize
The count that will be eventually observed is related to 
\begin_inset Formula $exp(X_{i}\beta)$
\end_inset

.
\end_layout

\begin_layout Itemize
However, the observed count will be 0 unless 
\begin_inset Formula $X_{i}\beta$
\end_inset

 is above a threshold.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Call that 
\begin_inset Quotes eld
\end_inset

stage 1
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
Modeled by any dichotomous regression model, such as logit or probit.
\end_layout

\end_deeper
\begin_layout Itemize
Then a Poisson or Negative Binomial model is used to predict the count that
 is observed.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Two Part Models}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
This is a 
\begin_inset Quotes eld
\end_inset

mixture model
\begin_inset Quotes erd
\end_inset

, supposing there are two types of cases.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Probability 
\begin_inset Formula $\psi_{i}$
\end_inset

: this is a case that will have count = 0
\end_layout

\begin_layout Itemize
Probability 
\begin_inset Formula $(1-\psi_{i})$
\end_inset

: this is a case that will have count determined by a draw from a Poisson
 or Negative Binomial process.
 
\end_layout

\end_deeper
\begin_layout Itemize
Details.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Is the linear predictor in your logit model the same formula that is used
 in your count model?
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Should the predictors be the same ones that are used in the Poisson or NB
 regression? 
\end_layout

\begin_layout Itemize
Should the coefficients be the same?
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
From a data-generating point of view, some mystery remains
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
If a non-zero count is observed, then we know for sure the case exceeded
 the hurdle
\end_layout

\begin_layout Itemize
But if a 0 is observed, then we are unsure which category that row belongs
 with.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
The stage 1 random draw may pass cases that will still have counted values
 of 0.
\end_layout

\end_deeper
\begin_layout Itemize
Hence, there are 2 processes through which we might observe 
\begin_inset Formula $y_{i}=0$
\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Stage 1 gives 0
\end_layout

\begin_layout Enumerate
Stage 1 Poisson draw gives 0.
 
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
Jargon alert: a 
\begin_inset Quotes eld
\end_inset

hurdle model
\begin_inset Quotes erd
\end_inset

 (as in the R package pscl) is one where stage 1 determines whether count
 is greater than 0, which is a different logic.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{ZIP model: Preparing for likelihood analysis}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
the probability of observing a 0 is 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
P(y_{i}=0|X_{i})=\psi_{i}+(1-\psi_{i})*exp(-exp(X_{i}\beta))
\]

\end_inset


\end_layout

\begin_layout Standard
(Write out the poisson for y=0 to understand the last term).
\end_layout

\end_deeper
\begin_layout Standard
2.
 The probability of a non-zero outcome is same as the Poisson or Neg Binomial
 model, multiplied by 
\begin_inset Formula $(1-\psi_{i}):$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
P(y_{i}|X_{i})=(1-\psi_{i})*Poisson(X_{i}\beta)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Make up some test cases, explore}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In R, the best package for exploring this is "pscl" (Simon Jackman et al)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
zeroinfl is estimator
\end_layout

\begin_layout Itemize
Compare to pscl::hurdle
\end_layout

\begin_layout Itemize
vuong test is a non-nested test for the statistical significance of the
 difference between a zero-inflated model and its counterpart.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Rate models
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{I'll have a rate handout}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I made a report to a client on Poisson models for rates, I'll copy that.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Additional Readings
\end_layout

\begin_layout Standard
The bible of count data is 
\begin_inset CommandInset citation
LatexCommand citet
key "cameron_regression_1998,cameron_regression_2013"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
I first appreciated the details by reading 
\begin_inset CommandInset citation
LatexCommand citet
key "long_regression_1997"
literal "true"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand citet
key "king_statistical_1988"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "mlm"
options "apalike2"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Session}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sess10>>=
\end_layout

\begin_layout Plain Layout

sessionInfo()
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<opts20, include=F>>=
\end_layout

\begin_layout Plain Layout

## Don't delete this.
 It puts the interactive session options
\end_layout

\begin_layout Plain Layout

## back the way they were.
 If this is compiled within a session
\end_layout

\begin_layout Plain Layout

## it is vital to do this.
\end_layout

\begin_layout Plain Layout

options(opts.orig)
\end_layout

\begin_layout Plain Layout

options(par.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
