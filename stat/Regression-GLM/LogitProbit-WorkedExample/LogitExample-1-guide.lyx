#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass extarticle
\begin_preamble
% Following comment is required. Do not delete it.
%\usepackage{Sweave}

\usepackage[includehead,includefoot]{geometry}
\geometry{
lmargin=1in,
rmargin=1in,
tmargin=0.75in,
bmargin=1.0in,
headheight=0pt,
headsep=0pt,
marginparwidth=0pt,
footskip=1.5\baselineskip,
}

\usepackage{booktabs}
\usepackage{dcolumn}

\input{theme/guidePreambleHeader.tex}
\input{theme/preambleFooter.tex}
\input{theme/guidePreambleSweavel.tex}
\end_preamble
\use_default_options false
\begin_modules
logicalmkup
sweave
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize letterpaper
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date true
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\noindent
\begin_inset ERT
status open

\begin_layout Plain Layout

%% Fill in values of the arguments here, 
\end_layout

\begin_layout Plain Layout

%% If blanks are needed, must insert value " ~ "
\end_layout

\begin_layout Plain Layout

%% If comma needed inside value, wrap in {}.
\end_layout

\begin_layout Plain Layout

%% Delete secondauthor and thirdauthor if not needed
\end_layout

\begin_layout Plain Layout


\backslash
guidesetup{%
\end_layout

\begin_layout Plain Layout

  author={
\end_layout

\begin_layout Plain Layout

    lastname=Johnson, 
\end_layout

\begin_layout Plain Layout

    firstname=Paul, 
\end_layout

\begin_layout Plain Layout

    affiliation=CRMDA,
\end_layout

\begin_layout Plain Layout

    email=pauljohn@ku.edu},
\end_layout

\begin_layout Plain Layout

  url={https://crmda.ku.edu/guides},
\end_layout

\begin_layout Plain Layout

  keywords={single-authoring, just one},
\end_layout

\begin_layout Plain Layout

  title={Logit example with 2002 ANES data},
\end_layout

\begin_layout Plain Layout

  leftlogo={theme/logoleft.pdf},
\end_layout

\begin_layout Plain Layout

  rightlogo={theme/logo-vert.pdf},
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout


\backslash
guidehdr
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% tmpout directory must exist first
\end_layout

\begin_layout Plain Layout

<<tmpout, echo=FALSE, include=FALSE, results=hide>>=
\end_layout

\begin_layout Plain Layout

if(!dir.exists("tmpout")) dir.create("tmpout", showWarnings=FALSE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=tmpout/t, split=TRUE, ae=FALSE, height=4.5, width=7}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Roptions, echo=FALSE, include=FALSE, results=hide>>=
\end_layout

\begin_layout Plain Layout

opts.orig <- options()
\end_layout

\begin_layout Plain Layout

options(width=90, prompt=" ", continue="  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE) 
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(ps=10)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=FALSE,family="Times",pointsize=10)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%The listings class used here allows within-document style
\end_layout

\begin_layout Plain Layout

%changes.
 R input boxes are governed by 
\end_layout

\begin_layout Plain Layout

% "Rsize", "Rbackground" and "Rcolor", while R output boxes depend on
\end_layout

\begin_layout Plain Layout

% "Routsize", "Routbackground", and "Routcolor".
 Colors
\end_layout

\begin_layout Plain Layout

% can be specified in many ways, as shown here
\end_layout

\begin_layout Plain Layout

%
\backslash
def
\backslash
Rsize{
\backslash
huge
\backslash
ttfamily}
\end_layout

\begin_layout Plain Layout

%
\backslash
def
\backslash
Routsize{
\backslash
huge}
\end_layout

\begin_layout Plain Layout

%
\backslash
def
\backslash
Rbackground{
\backslash
color[gray]{0.90}}
\end_layout

\begin_layout Plain Layout

%
\backslash
def
\backslash
Routbackground{
\backslash
color[gray]{0.40}}
\end_layout

\begin_layout Plain Layout

%
\backslash
def
\backslash
Rcolor{
\backslash
color[gray]{0.60}
\end_layout

\begin_layout Plain Layout

%
\backslash
def
\backslash
Routcolor{
\backslash
color[rgb]{0.9, 0.1, 0.1}]}
\end_layout

\begin_layout Plain Layout

%
\backslash
def
\backslash
Rcommentcolor{
\backslash
color{green}}
\end_layout

\end_inset


\end_layout

\begin_layout Abstract
\noindent
Some variables from the American National Election Study of 2002 are used
 to demonstrate logistic regression in R.
 The same old SAS export file that we created 2003 still works, all these
 years later.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Section
Get that ANES 2002 dataset
\end_layout

\begin_layout Standard
\noindent
In 2003, some students and I used SAS to pull variables from the American
 National Election Study.
 That effort was immortalized in a post on the KU server, then called lark.
 When lark closed, I copied that material onto my personal web server, 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/DataSets/ANES/2002
\end_layout

\end_inset

.
 The result of the importation was a SAS export file, which I called 
\begin_inset Quotes eld
\end_inset

PJTEST.sasxport
\begin_inset Quotes erd
\end_inset

 because I did not think it would work.
 The code (shown below) will download that file and rename it more confidently,
 
\begin_inset Quotes eld
\end_inset

anes2002.sasxport.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
The data import process today might be handled differently, but this one
 is still to be cherished because of its special place in time.
 That was the semester when I quit teaching stats with SAS and asked the
 students to use R (
\begin_inset CommandInset citation
LatexCommand citet
key "RCore"
literal "false"

\end_inset

).
\end_layout

\begin_layout Standard
There is a SAS export dataset that is the primary source material for this
 exercise.
 
\end_layout

\begin_layout Standard
There is one very important thing to explain about this data.
 The variable labels were lost, we have just the numeric values for them.
 Hence, to create factors in R, we have to do a little work.
 
\end_layout

\begin_layout Standard
Now, in 2018, I'd be telling everybody 
\begin_inset Quotes eld
\end_inset

don't bother with that, use the variable key in the kutils package.
\begin_inset Quotes erd
\end_inset

 But I realize that's an unfamiliar thing to most people, so I'll do the
 recoding the old fashioned way here.
\end_layout

\begin_layout Subsection
Check the Codebook
\end_layout

\begin_layout Standard
The full variable list of the original survey is online:
\end_layout

\begin_layout Standard
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/DataSets/ANES/2002/RELEASE/nes02var.txt
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The data set itself is retrieved in R code below.
\end_layout

\begin_layout Standard
Some of the highlights in the codebook are as follows.
\end_layout

\begin_layout Standard

\series bold
V023131
\series default
 Y3x.
 Summary: R Education 
\end_layout

\begin_layout Standard
What is the highest grade of school or year of college you completed? 
\end_layout

\begin_layout Standard
1.
 8 grades or less and no diploma or equivalency 
\end_layout

\begin_layout Standard
2.
 9-11 grades, no further schooling 
\end_layout

\begin_layout Standard
3.
 High school diploma or equivalency test 
\end_layout

\begin_layout Standard
4.
 More than 12 years of schooling, no higher degree 
\end_layout

\begin_layout Standard
5.
 Junior or community college level degrees (AA degrees) 
\end_layout

\begin_layout Standard
6.
 BA level degrees; 17+ years, no advanced degree 
\end_layout

\begin_layout Standard
7.
 Advanced degree, including LLB
\end_layout

\begin_layout Standard
9.
 Refused 
\end_layout

\begin_layout Standard
0.
 NA in Y3, Y3a or Y3b
\end_layout

\begin_layout Standard
V023131 Frequency ——————- 
\end_layout

\begin_layout Standard
0 2 
\end_layout

\begin_layout Standard
1 36 
\end_layout

\begin_layout Standard
2 70 
\end_layout

\begin_layout Standard
3 399 
\end_layout

\begin_layout Standard
4 313 
\end_layout

\begin_layout Standard
5 155 
\end_layout

\begin_layout Standard
6 347 
\end_layout

\begin_layout Standard
7 178 
\end_layout

\begin_layout Standard
9 11
\end_layout

\begin_layout Standard
===============================
\end_layout

\begin_layout Standard

\series bold
V023111
\series default
 Q1a.
 Who did R vote for in 2000 Pres Election 
\end_layout

\begin_layout Standard
Which one did you vote for? 
\end_layout

\begin_layout Standard
1.
 Al Gore 
\end_layout

\begin_layout Standard
3.
 George W.
 Bush 
\end_layout

\begin_layout Standard
5.
 Ralph Nader 
\end_layout

\begin_layout Standard
7.
 Other {SPECIFY}
\end_layout

\begin_layout Standard
8.
 Dont know 
\end_layout

\begin_layout Standard
9.
 Refused 0.
 NA
\end_layout

\begin_layout Standard
INAP.
 Fresh Cross-Section respondent; 5,8,9 in Q1
\end_layout

\begin_layout Standard
V023111 Frequency ——————- .
 
\end_layout

\begin_layout Standard
526 0 1 1 431 3 502 5 32 7 8 8 1 9 10
\end_layout

\begin_layout Standard
============================== 
\end_layout

\begin_layout Standard

\series bold
V023036
\series default
 J1.
 R Consider Self Dem/Rep/Ind Numeric Missing eq 0, ge 8
\end_layout

\begin_layout Standard
J1.
\end_layout

\begin_layout Standard
Generally speaking, do you usually think of yourself as a REPUBLICAN, a
 DEMOCRAT, an INDEPENDENT, or what? —————————————
\end_layout

\begin_layout Standard
1.
 Democrat 
\end_layout

\begin_layout Standard
2.
 Republican 
\end_layout

\begin_layout Standard
3.
 Independent 
\end_layout

\begin_layout Standard
4.
 Other Party {VOL} {SPECIFY} 
\end_layout

\begin_layout Standard
5.
 No Preference {VOL}
\end_layout

\begin_layout Standard
8.
 Don't know 
\end_layout

\begin_layout Standard
9.
 Refused 0.
 NA
\end_layout

\begin_layout Standard
V023036 Frequency ——————- 
\end_layout

\begin_layout Standard
0 13 
\end_layout

\begin_layout Standard
1 502 
\end_layout

\begin_layout Standard
2 474 
\end_layout

\begin_layout Standard
3 429 
\end_layout

\begin_layout Standard
4 27 
\end_layout

\begin_layout Standard
5 59 
\end_layout

\begin_layout Standard
8 5 
\end_layout

\begin_layout Standard
9 2
\end_layout

\begin_layout Standard
============================== 
\end_layout

\begin_layout Standard

\series bold
V023022
\series default
 R 7Pt Scale Lib-Con Self-Placement 
\end_layout

\begin_layout Standard
We hear a lot of talk these days about liberals and conservatives.
 When it comes to politics, do you usually think of yourself as EXTREMELY
 LIBERAL, LIBERAL, SLIGHTLY LIBERAL, MODERATE OR MIDDLE OF THE ROAD, SLIGHTLY
 CONSERVATIVE, CONSERVATIVE, EXTREMELY CONSERVATIVE, or haven't you thought
 much about this? ————————————————————–————
\end_layout

\begin_layout Standard
01.
 Extremely Liberal 
\end_layout

\begin_layout Standard
02.
 Liberal 
\end_layout

\begin_layout Standard
03.
 Slightly Liberal 
\end_layout

\begin_layout Standard
04.
 Moderate; Middle of the Road 
\end_layout

\begin_layout Standard
05.
 Slightly Conservative 
\end_layout

\begin_layout Standard
06.
 Conservative 
\end_layout

\begin_layout Standard
07.
 Extremely Conservative
\end_layout

\begin_layout Standard
08.
 Don't know 
\end_layout

\begin_layout Standard
09.
 Refused 
\end_layout

\begin_layout Standard
90.
 Haven't thought much [Do Not Probe] 
\end_layout

\begin_layout Standard
00.
 NA
\end_layout

\begin_layout Standard
V023022 Frequency ——————- 
\end_layout

\begin_layout Standard
0 11 
\end_layout

\begin_layout Standard
1 23 
\end_layout

\begin_layout Standard
2 181 
\end_layout

\begin_layout Standard
3 135 
\end_layout

\begin_layout Standard
4 340 
\end_layout

\begin_layout Standard
5 186 
\end_layout

\begin_layout Standard
6 315 
\end_layout

\begin_layout Standard
7 65 
\end_layout

\begin_layout Standard
8 8 
\end_layout

\begin_layout Standard
9 3 
\end_layout

\begin_layout Standard
90 244
\end_layout

\begin_layout Standard
============================== 
\end_layout

\begin_layout Standard

\series bold
V023027
\series default
 H1.
 US Economy Better/Worse in Last Yr
\end_layout

\begin_layout Standard
Now thinking about the economy in the country as a whole, would you say
 that over the past year the nation's economy has gotten BETTER, STAYED
 ABOUT THE SAME, or gotten WORSE? ———
\end_layout

\begin_layout Standard
1.
 Better 
\end_layout

\begin_layout Standard
3.
 Same 
\end_layout

\begin_layout Standard
5.
 Worse
\end_layout

\begin_layout Standard
8.
 Don't know 
\end_layout

\begin_layout Standard
9.
 Refused 
\end_layout

\begin_layout Standard
0.
 NA
\end_layout

\begin_layout Standard
V023027 Frequency ——————- 
\end_layout

\begin_layout Standard
0 6 
\end_layout

\begin_layout Standard
1 69 
\end_layout

\begin_layout Standard
3 321 
\end_layout

\begin_layout Standard
5 1112 
\end_layout

\begin_layout Standard
8 3
\end_layout

\begin_layout Standard
===================================
\end_layout

\begin_layout Standard

\series bold
V023010
\series default
: Where on that thermometer would you rate George W.
 Bush? (on a scale from 0 to 100) 
\end_layout

\begin_layout Standard
====================
\end_layout

\begin_layout Subsection
Use foreign::read.xport to import the data
\end_layout

\begin_layout Standard
R's package 
\begin_inset Quotes eld
\end_inset

foreign
\begin_inset Quotes erd
\end_inset

 has a number of procedures to import data from other packages.
 Happily, this data imports correctly.
\end_layout

\begin_layout Standard
First, I'll retrieve a copy of the file from the web server.
 I'll rename it 
\begin_inset Quotes eld
\end_inset

anes2002.sasxport
\begin_inset Quotes erd
\end_inset

.
 To keep this simple, I'll just drop it in the current working directory.
 (In real projects, I'd put it in a separate folder.)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<2a>>=
\end_layout

\begin_layout Plain Layout

url <- 
\begin_inset Quotes eld
\end_inset

http://pj.freefaculty.org/DataSets/ANES/2002/PJTEST.sasxport
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Plain Layout

fn <- 
\begin_inset Quotes eld
\end_inset

anes2002.sasxport
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Plain Layout

if(!file.exists(fn)){
\end_layout

\begin_layout Plain Layout

    download.file(url, mode=
\begin_inset Quotes eld
\end_inset

wb
\begin_inset Quotes erd
\end_inset

, destfile=
\begin_inset Quotes erd
\end_inset

anes2002.sasxport
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The SAS export file is easy to import
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

library(foreign) 
\end_layout

\begin_layout Plain Layout

nes2002 <- read.xport(fn)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I've got 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(nes2002)[1]}
\end_layout

\end_inset

 rows and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(nes2002)[2]}
\end_layout

\end_inset

 columns.
 
\end_layout

\begin_layout Standard
Unfortunately, all of the variable labels were lost in the process, I have
 only the numeric scores.
 I found that out by using the str() function:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

str(nes2002)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Recodes
\end_layout

\begin_layout Standard
I've got a few challenges.
 For categorical variables, it is best to use R factors, rather than integers
 to record the information.
 This would have been easier if I had made a variable key, I'm sorry I did
 not.
 But I'll make an informal variable table to help trace this through.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Variable Coding Table (not a real variable key, but similar)
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="15" columns="6">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="1.5in">
<column alignment="center" valignment="top" width="1.5in">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
name_old
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
name_new
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
class_new
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
value_new
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023111
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bushvotef
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

Gore
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Bush
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023111
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bushvote
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0=Gore,1=Bush
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023036
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
partyid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

D
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

R
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

I
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023036
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
repub
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1=
\begin_inset Quotes erd
\end_inset

R
\begin_inset Quotes erd
\end_inset

,0=
\begin_inset Quotes erd
\end_inset

D
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

I
\begin_inset Quotes erd
\end_inset

,or
\begin_inset Quotes erd
\end_inset

NA
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023036
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
democ
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1=
\begin_inset Quotes erd
\end_inset

D
\begin_inset Quotes erd
\end_inset

,0=
\begin_inset Quotes erd
\end_inset

R
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

I
\begin_inset Quotes erd
\end_inset

,or
\begin_inset Quotes erd
\end_inset

NA
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023022
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ideolf
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

L
\begin_inset Quotes erd
\end_inset

,...,
\begin_inset Quotes erd
\end_inset

EC
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023022
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ideolo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ordered
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

L
\begin_inset Quotes erd
\end_inset

,...,
\begin_inset Quotes erd
\end_inset

EC
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023022
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ideoln
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1-7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023010
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023010
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
numeric
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bush Thermometer, unchanged
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023027
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
useconn
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
integer
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023027
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
usecono
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ordered
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1=
\begin_inset Quotes erd
\end_inset

Better
\begin_inset Quotes erd
\end_inset

, 3=
\begin_inset Quotes erd
\end_inset

Same
\begin_inset Quotes erd
\end_inset

,5=
\begin_inset Quotes erd
\end_inset

Worse
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023131
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
educn
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
numeric
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1-7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023131
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
educf
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
factor
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

elem.
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Some HS
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

HS
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Some coll.
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

AA
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

BA
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Grad
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
unordered coding
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
V023131
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
educo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ordered
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
same
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ordinal coding
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Create 
\begin_inset Quotes eld
\end_inset

bushvote
\begin_inset Quotes erd
\end_inset

, a binary variable for Gore vs Bush, and all of the other candidates are
 treated as missing.
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rec10,echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$bushvotef <- factor(nes2002$V023111, levels = c(1, 3), labels =
 c(
\begin_inset Quotes eld
\end_inset

Gore
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Bush
\begin_inset Quotes erd
\end_inset

))
\end_layout

\begin_layout Plain Layout

table(nes2002$bushvote, nes2002$V023111, exclude = NULL)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rec15, echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$bushvote <- ifelse(nes2002$bushvotef == 
\begin_inset Quotes eld
\end_inset

Bush
\begin_inset Quotes erd
\end_inset

, 1, 0)
\end_layout

\begin_layout Plain Layout

table(nes2002$bushvote, nes2002$V023111)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
For political party, it looks like I featured the simple 3 category variable,
 V023036, not the 7 point 
\begin_inset Quotes eld
\end_inset

strength of identification
\begin_inset Quotes erd
\end_inset

 scale that you see in some projects.
 First I'll assign labels for the 3 most widely used party labels.
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rec20,echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$partyid <- factor(nes2002$V023036, levels = c(3,1, 2), labels =
 c(
\begin_inset Quotes eld
\end_inset

I
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

D
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

R
\begin_inset Quotes erd
\end_inset

))
\end_layout

\begin_layout Plain Layout

table(nes2002$partyid, nes2002$V023036, exclude = NULL)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the analysis below, I have some illustrations using democrat and republican
 dummy variables.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rec30,echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$democ <- ifelse(nes2002$partyid == 
\begin_inset Quotes eld
\end_inset

D
\begin_inset Quotes erd
\end_inset

, 1, 0)
\end_layout

\begin_layout Plain Layout

table(nes2002$democ, nes2002$partyid, exclude = NULL)
\end_layout

\begin_layout Plain Layout

nes2002$repub <-ifelse(nes2002$partyid == 
\begin_inset Quotes eld
\end_inset

R
\begin_inset Quotes erd
\end_inset

, 1, 0)
\end_layout

\begin_layout Plain Layout

table(nes2002$repub, nes2002$partyid, exclude = NULL, dnn = list(
\begin_inset Quotes eld
\end_inset

repub
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

partyid
\begin_inset Quotes erd
\end_inset

))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
As I look at that now, I have some misgivings about it because of the way
 missing values are handled.
 Can you see why I might worry? 
\end_layout

\begin_layout Standard
(Concern is that when we say democ = 0, we might mean everybody who is not
 a democrat, EVEN including missing values on party.
 In this current coding, we don't have that, we have missings on democ unless
 party is D, R, or I.
\end_layout

\begin_layout Standard
The most I think about that, the more I think I ought to fix it.
 So here's a fix:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rec31,echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$democ <- 0
\end_layout

\begin_layout Plain Layout

nes2002$democ[!is.na(nes2002$partyid) & nes2002$partyid == 
\begin_inset Quotes eld
\end_inset

D
\begin_inset Quotes erd
\end_inset

] <- 1
\end_layout

\begin_layout Plain Layout

table(nes2002$democ, nes2002$partyid, exclude = NULL)
\end_layout

\begin_layout Plain Layout

nes2002$repub <- 0
\end_layout

\begin_layout Plain Layout

nes2002$repub[!is.na(nes2002$partyid) & nes2002$partyid == 
\begin_inset Quotes eld
\end_inset

R
\begin_inset Quotes erd
\end_inset

] <- 1
\end_layout

\begin_layout Plain Layout

table(nes2002$repub, nes2002$partyid, exclude = NULL, dnn = list(
\begin_inset Quotes eld
\end_inset

repub
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

partyid
\begin_inset Quotes erd
\end_inset

))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The important thing about this 
\begin_inset Quotes eld
\end_inset

fix
\begin_inset Quotes erd
\end_inset

 is that we mean to say that democ is 1 if a person is a democrat, and they
 are 0 no matter what otherwise.
 They are 0 even if they did not answer the party identification question.
 This is aggressive coding, I think.
 It is the way we always used to do it in SAS, however.
\end_layout

\end_deeper
\begin_layout Enumerate
Fix Ideology.
 Some authors treat ideology as a numeric variable, as if 1 through 7 are
 numerically meaningful scores.
 Some authors say 
\begin_inset Quotes eld
\end_inset

that's a categorical variable, don't do that.
\begin_inset Quotes erd
\end_inset

 We can try both ways.
 Hence we have 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideolf
\end_layout

\end_inset

 and 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideoln
\end_layout

\end_inset

.
 The variable 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideolo
\end_layout

\end_inset

 is an ordinal factor.
 Ordinal factors are treated in an interestingly different way in the regression
 model (will demonstrate).
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rec50,echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$ideolf <- factor(nes2002$V023022, levels = 1:7, labels = c(
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

L
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

M
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SC
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

C
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

EC
\begin_inset Quotes erd
\end_inset

))
\end_layout

\begin_layout Plain Layout

table(
\begin_inset Quotes eld
\end_inset

ideology factor
\begin_inset Quotes erd
\end_inset

 = nes2002$ideolf, 
\begin_inset Quotes eld
\end_inset

original ideology
\begin_inset Quotes erd
\end_inset

 = nes2002$V023022, exclude = NULL)
\end_layout

\begin_layout Plain Layout

nes2002$ideolo <- factor(nes2002$V023022, levels = 1:7, labels = c(
\begin_inset Quotes eld
\end_inset

EL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

L
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

M
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SC
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

C
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

EC
\begin_inset Quotes erd
\end_inset

), ordered = TRUE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I will also make a numeric version by converting the factor back to numeric
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rec52,echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$ideoln <- as.numeric(nes2002$ideolf) # converts to 1 thru 7
\end_layout

\begin_layout Plain Layout

table(nes2002$ideolf, nes2002$ideoln, dnn = list(
\begin_inset Quotes eld
\end_inset

factor version
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

ideology: numeric version
\begin_inset Quotes erd
\end_inset

), exclude = NULL)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the discussion below, I compare an ideology variable coded 1-2-3-4-5-6-7
 against one that is coded with labels.
\end_layout

\end_deeper
\begin_layout Enumerate
Education
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

## Categorical, unordered
\end_layout

\begin_layout Plain Layout

nes2002$educf <- factor(nes2002$V023131, levels = 1:7, 
\end_layout

\begin_layout Plain Layout

        labels = c(
\begin_inset Quotes eld
\end_inset

Elem.
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Some HS
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

HS
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Some coll.
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

AA
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

BA
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Grad
\begin_inset Quotes erd
\end_inset

))
\end_layout

\begin_layout Plain Layout

## Ordered categories
\end_layout

\begin_layout Plain Layout

nes2002$educo <- factor(nes2002$V023131, levels = 1:7, 
\end_layout

\begin_layout Plain Layout

        labels = c(
\begin_inset Quotes eld
\end_inset

Elem.
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Some HS
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

HS
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Some coll.
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

AA
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

BA
\begin_inset Quotes erd
\end_inset

,
\begin_inset Quotes erd
\end_inset

Grad
\begin_inset Quotes erd
\end_inset

),
\end_layout

\begin_layout Plain Layout

        ordered = TRUE)
\end_layout

\begin_layout Plain Layout

## Numeric
\end_layout

\begin_layout Plain Layout

nes2002$educn <- nes2002$V023131
\end_layout

\begin_layout Plain Layout

table(
\begin_inset Quotes eld
\end_inset

Education(ordered)
\begin_inset Quotes erd
\end_inset

 = nes2002$educo, 
\end_layout

\begin_layout Plain Layout

      
\begin_inset Quotes eld
\end_inset

Education (orig)
\begin_inset Quotes erd
\end_inset

 = nes2002$V023131, exclude = NULL)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
US Economy
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

nes2002$usecono <- factor(nes2002$V023027, levels = c(1, 3, 5),  
\end_layout

\begin_layout Plain Layout

        labels = c(
\begin_inset Quotes eld
\end_inset

Better
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Same
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Worse
\begin_inset Quotes erd
\end_inset

),
\end_layout

\begin_layout Plain Layout

        ordered = TRUE)
\end_layout

\begin_layout Plain Layout

nes2002$useconn <- nes2002$V023027
\end_layout

\begin_layout Plain Layout

table(
\begin_inset Quotes eld
\end_inset

US Econ(ordered)
\begin_inset Quotes erd
\end_inset

 = nes2002$usecono, 
\end_layout

\begin_layout Plain Layout

      
\begin_inset Quotes eld
\end_inset

US Econ (orig)
\begin_inset Quotes erd
\end_inset

 = nes2002$V023027, exclude = NULL)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Section
Ideology and the vote
\end_layout

\begin_layout Standard
I decided to 
\begin_inset Quotes eld
\end_inset

be stupid
\begin_inset Quotes erd
\end_inset

 and simply treat Ideology as a 7 point numerical variable (even though
 it is actually an ordered factor).
\end_layout

\begin_layout Subsection*
Plot The Vote's Dependence on Ideology
\end_layout

\begin_layout Standard
Consider the very uninformative plot in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "cap:scatter1"

\end_inset

.
 That's really quite pathetic.
 The visual impact is not quite so depressing in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "cap:jittered1"

\end_inset

, which uses 
\begin_inset Quotes eld
\end_inset

jittered
\begin_inset Quotes erd
\end_inset

 values to display overlapped points.
 That figure includes the predicted values from the OLS regression (discussed
 next).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Scatterplot showing impact of ideology on vote choice in 2000
\begin_inset CommandInset label
LatexCommand label
name "cap:scatter1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<3b,fig=T,echo=T,height=5>>=
\end_layout

\begin_layout Plain Layout

plot(nes2002$ideoln, nes2002$bushvote, ylim=c(0,1), xlab="Ideology (numeric)",
 ylab="Vote (Bush=1, Gore=0)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Ordinary Least Squares
\end_layout

\begin_layout Standard
The ordinary least squares result is obtained with the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
lm
\end_layout

\end_inset

 (short for 
\begin_inset Quotes eld
\end_inset

linear model
\begin_inset Quotes erd
\end_inset

) function in R.
 The fitted model is saved as an object that we call ols1.
 The summary results are obtained by applying the summary function to the
 result.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<3c,echo=T>>=
\end_layout

\begin_layout Plain Layout

ols1 <- lm(bushvote ~ ideoln, data=nes2002) 
\end_layout

\begin_layout Plain Layout

summary(ols1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Do jittered values reveal more information?
\begin_inset CommandInset label
LatexCommand label
name "cap:jittered1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<3d,fig=T,echo=T>>=
\end_layout

\begin_layout Plain Layout

with(nes2002, plot(jitter(ideoln), jitter(bushvote), ylim=c(-0.2, 1.2), 
\end_layout

\begin_layout Plain Layout

   xlab="Ideology (numeric)", ylab="Vote (Bush=1,Gore=0)"))
\end_layout

\begin_layout Plain Layout

nd <- data.frame(ideoln = 1:7)
\end_layout

\begin_layout Plain Layout

nd$fit <- predict(ols1, newdata = nd)
\end_layout

\begin_layout Plain Layout

lines(nd$ideoln, nd$fit)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Logistic estimation with glm
\end_layout

\begin_layout Standard
The R team prefers that we think of the logit model as a Generalized Linear
 Model (GLM).
 We are supposed to think of the outcomes as draws from a Binomial distribution
 (coin flips) with probability equal to the following formula:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
P(Y_{i}=1)=\frac{1}{1+e^{-(\beta_{0}+\beta_{1}X_{i})}}
\]

\end_inset


\end_layout

\begin_layout Standard
Imagine searching through the possible combinations of 
\begin_inset Formula $\hat{\beta}_{0}$
\end_inset

 and 
\begin_inset Formula $\hat{\beta}_{1}$
\end_inset

.
 For each combination, we can calculate 
\begin_inset Formula $\hat{p}_{i}$
\end_inset

, an estimate of the probability that the 
\begin_inset Formula $i$
\end_inset

'th observation will be 1.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{p}_{i}=\frac{1}{1+e^{-(\hat{\beta}_{0}+\hat{\beta}_{1}X_{i})}}
\]

\end_inset

The estimator will tune 
\begin_inset Formula $\hat{\beta}_{0}$
\end_inset

 and 
\begin_inset Formula $\hat{\beta}_{1}$
\end_inset

 up and down, trying to make the observed data as likely as possible.
\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

raw
\begin_inset Quotes erd
\end_inset

 output from R is as follows.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<3e,echo=T>>=
\end_layout

\begin_layout Plain Layout

bushideoglm1 <- glm(bushvote ~ ideoln, family=binomial, data=nes2002) 
\end_layout

\begin_layout Plain Layout

summary(bushideoglm1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Presentable Tables
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<3e2,echo=F,results=hide>>=
\end_layout

\begin_layout Plain Layout

library(memisc)
\end_layout

\begin_layout Plain Layout

library(rockchalk)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The first package I know of that incorporated a high-quality LaTeX table
 was 
\begin_inset Quotes eld
\end_inset

memisc
\begin_inset Quotes erd
\end_inset

, authored by Martin Elff.
 The regression table has some interesting features.
 The LaTeX rendering from the use of the memisc package is displayed in
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:memisc1"
plural "false"
caps "false"
noprefix "false"

\end_inset

:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Logistic Regression Table (memisc)
\begin_inset CommandInset label
LatexCommand label
name "tab:memisc1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\noindent
\begin_inset ERT
status open

\begin_layout Plain Layout

<<3f, echo=T, results=tex>>=
\end_layout

\begin_layout Plain Layout

toLatex(mtable(bushideoglm1))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The strength of this is the profuse listing of summary statistics.
 That is also the weakness.
\end_layout

\begin_layout Standard
I don't want student papers to include a profusion of summary statistics
 that they don't understand.
 That's why rockchalk::outreg's output, which is displayed in the bottom
 part of Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:outreg1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
In outreg, there is a parameter to specify variable names.
 I will accumulate the new names here in a vector named vl, and then put
 it to use when necessary.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<vl>>=
\end_layout

\begin_layout Plain Layout

vl = c(
\begin_inset Quotes eld
\end_inset

ideoln
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Ideology
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

ideolf
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Ideology
\begin_inset Quotes erd
\end_inset

, 
\end_layout

\begin_layout Plain Layout

       
\begin_inset Quotes eld
\end_inset

ideolo
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Ideology
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

repub
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Repub.
\begin_inset Quotes erd
\end_inset

, 
\end_layout

\begin_layout Plain Layout

       
\begin_inset Quotes eld
\end_inset

democ
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Democ.
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

V023010
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Bush Therm
\begin_inset Quotes erd
\end_inset

,
\end_layout

\begin_layout Plain Layout

       
\begin_inset Quotes eld
\end_inset

useconn
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

US economy
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

usecono
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

US economy
\begin_inset Quotes erd
\end_inset

,
\end_layout

\begin_layout Plain Layout

       
\begin_inset Quotes eld
\end_inset

educn
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Education
\begin_inset Quotes erd
\end_inset

, educo = 
\begin_inset Quotes eld
\end_inset

Education
\begin_inset Quotes erd
\end_inset

, educf = 
\begin_inset Quotes eld
\end_inset

Education
\begin_inset Quotes erd
\end_inset

,
\end_layout

\begin_layout Plain Layout

       
\begin_inset Quotes eld
\end_inset

partyidD
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Party Dem.
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

partyidR
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

Party Rep.
\begin_inset Quotes erd
\end_inset

,
\end_layout

\begin_layout Plain Layout

       
\begin_inset Quotes eld
\end_inset

ideolo^4
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

ideolo.4
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

ideolo^5
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

ideolo.5
\begin_inset Quotes erd
\end_inset

,
\end_layout

\begin_layout Plain Layout

       
\begin_inset Quotes eld
\end_inset

ideolo^6
\begin_inset Quotes erd
\end_inset

 = 
\begin_inset Quotes eld
\end_inset

ideolo.6
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Logistic Regression Table(outreg)
\begin_inset CommandInset label
LatexCommand label
name "tab:outreg1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<3g, echo=T, results=tex>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

outreg(bushideoglm1, tight=F, varLab = vl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
How to interpret the slope estimates.
\end_layout

\begin_layout Standard
Most of our emphasis is on the estimates of the 
\begin_inset Formula $\beta$
\end_inset

's.
 The strategy is to calculate predictions and compare across cases.
 By doing this, we find out the answer to the question, 
\begin_inset Quotes eld
\end_inset

does the predictor effect the chances that the outcome will be 1?
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Standard
The probability is defined in this two step procedure.
\end_layout

\begin_layout Standard
1.
 Calculate the Linear Predictor
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\eta}_{i}=\hat{\beta}_{0}+\hat{\beta}_{1}x_{i}+more\,\hat{\beta}\cdot x's
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
2.
 
\begin_inset Quotes eld
\end_inset

Bend
\begin_inset Quotes erd
\end_inset

 the Linear Predictor into a Probability curve
\begin_inset Formula 
\begin{equation}
\hat{p}_{i}=Prob(Y_{i}=1|\hat{\eta}_{i})=\frac{1}{1+e^{-\hat{\eta}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The intercept and the predictor variables all 
\begin_inset Quotes eld
\end_inset

blend together
\begin_inset Quotes erd
\end_inset

 in the linear predictor to control the chances that the outcome will be
 1.
 
\end_layout

\begin_layout Standard
The best way to understand the 
\begin_inset Formula $\beta$
\end_inset

's is to calculate 
\begin_inset Formula $\hat{p}_{i}$
\end_inset

 for 
\begin_inset Quotes eld
\end_inset

interesting
\begin_inset Quotes erd
\end_inset

 values of the input variables.
\end_layout

\begin_layout Standard
Please remember this very important thing:
\end_layout

\begin_layout Quote
To calculate a predicted value, one must include values for all input variables
 and all parameters.
\end_layout

\begin_layout Standard
That means the 
\begin_inset Quotes eld
\end_inset

effect of x
\begin_inset Quotes erd
\end_inset

 does really depend on the values of all of the other input variables.
\end_layout

\begin_layout Standard
The usual approach is to set all of the variables at their 
\begin_inset Quotes eld
\end_inset

means
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

modes
\begin_inset Quotes erd
\end_inset

 and then adjust the values of a particular input to findout how the predicted
 probability changes.
 In the rockchalk package, I set the categorical variables at their modes,
 unless the user directs otherwise.
\end_layout

\begin_layout Subsection
Use the predict function
\end_layout

\begin_layout Standard
In the past, I have calculated predicted values 
\begin_inset Quotes eld
\end_inset

manually
\begin_inset Quotes erd
\end_inset

 by taking the estimated coefficients and using them in the logistic equation.
 R offers a function 
\begin_inset Quotes eld
\end_inset

predict
\begin_inset Quotes erd
\end_inset

 to handle that for us.
 This is a fundamental skill that all R users should try to master.
\end_layout

\begin_layout Standard
In this case, since ideology takes on values from 1 to 7, we need only calculate
 7 predictions.
 To obtain predicted values from the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
glm
\end_layout

\end_inset

 output, one uses the following approach.
 First, a 
\begin_inset Quotes eld
\end_inset

newdata
\begin_inset Quotes erd
\end_inset

 object, called 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
nd
\end_layout

\end_inset

, is created.
 Second, the model is given to the predict method, along with the newdata
 object:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<52,echo=T>>=
\end_layout

\begin_layout Plain Layout

nd <- data.frame(ideoln = 1:7)
\end_layout

\begin_layout Plain Layout

pp3 <-predict(bushideoglm1, newdata=nd, type="response", se.fit=T)
\end_layout

\begin_layout Plain Layout

pp3
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Unlike models fitted with 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
lm
\end_layout

\end_inset

, the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predict
\end_layout

\end_inset

 function for 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
glm
\end_layout

\end_inset

 models does not create either a confidence or prediction interval.
 The calculation of the confidence intervals for those predictions is still
 a controversial topic.
 There are at least 20 suggested methods, and I only know how to do the
 calculations for the simplest one.
 The approach I take is the familiar 
\begin_inset Quotes eld
\end_inset

plus or minus 2 standard errors
\begin_inset Quotes erd
\end_inset

 approach, dubbed the Wald confidence interval.
 The interval is calculated in the un-transformed 
\begin_inset Quotes eld
\end_inset

log odds
\begin_inset Quotes erd
\end_inset

 scale as 
\begin_inset Formula $(\hat{\eta}_{i}-1.96se.fit(\hat{\eta}_{i}),\hat{\eta}_{i}+1.96se.fit(\hat{\eta}_{i}))$
\end_inset

.
 Those values are mapped onto the scale of the predicted probabilities in
 the usual way, 
\begin_inset Formula $1/(1+exp(-\eta_{i})$
\end_inset

.
 Example output is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:LogitWConfInt"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Fitted Values and Confidence Interval of Logistic Regression
\begin_inset CommandInset label
LatexCommand label
name "fig:LogitWConfInt"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig=TRUE,echo=TRUE>>=
\end_layout

\begin_layout Plain Layout

plot(bushvote ~ ideoln, data=nes2002, ylim=c(0,1), xlab="Ideology(numeric)",
 ylab="Vote (Bush=1, Gore=0)", main="Predicted Probabilities from Logistic
 Regression")
\end_layout

\begin_layout Plain Layout

pp3 <- predict(bushideoglm1, newdata=nd, se.fit=T)
\end_layout

\begin_layout Plain Layout

pp3$upr <- pp3$fit + 1.96*pp3$se.fit
\end_layout

\begin_layout Plain Layout

pp3$lwr <- pp3$fit - 1.96*pp3$se.fit
\end_layout

\begin_layout Plain Layout

pp3logistic <- lapply(pp3, plogis)
\end_layout

\begin_layout Plain Layout

pp3logistic
\end_layout

\begin_layout Plain Layout

lines(1:7, pp3logistic$fit)
\end_layout

\begin_layout Plain Layout

lines(1:7, pp3logistic$lwr, lty=4)
\end_layout

\begin_layout Plain Layout

lines(1:7, pp3logistic$upr, lty=4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
rockchalk to make that automatic? Dependable enough
\end_layout

\begin_layout Standard
Because some students have trouble putting together the sequence of calculations
, the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
rockchalk
\end_layout

\end_inset

 package has functions that are intended to do this work.
 These are described in the vignette 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
rockchalk
\end_layout

\end_inset

, but here's the high level overview.
 
\end_layout

\begin_layout Standard
The 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predictOMatic
\end_layout

\end_inset

 function is supposed to look at the regression, find the predictors, get
 
\begin_inset Quotes eld
\end_inset

interesting
\begin_inset Quotes erd
\end_inset

 example values, and then calculate the predictions (possibly with a confidence
 interval).
 It turns out that deciding what is 
\begin_inset Quotes eld
\end_inset

interesting
\begin_inset Quotes erd
\end_inset

 is subjective, so the predVals parameter has a 
\emph on
whole lot
\emph default
 of options.
 At the current time, the options are difficult to understand and it is
 necessary to study the help page and the examples to truly grasp the power
 and beauty of this fully operational death star.
 Here I take the easy road by simply listing the values for the one predictor.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<pm10>>=
\end_layout

\begin_layout Plain Layout

predictOMatic(bushideoglm1, predVals = list(ideoln=1:7), interval=
\begin_inset Quotes erd
\end_inset

confidence
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I think it is useful to run 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predictOMatic
\end_layout

\end_inset

, especially if an output table of predicted probabilities is needed.
 These can be used to create a predicted value plot.
\end_layout

\begin_layout Standard
On the other hand, it is not necessary for the user to run 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predictOMatic
\end_layout

\end_inset

 to get a nice looking plot.
 The 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
plotCurves
\end_layout

\end_inset

 function will run 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predictOMatic
\end_layout

\end_inset

 in the background and draw a plot.
 An example of 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
plotCurves
\end_layout

\end_inset

 is found in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:plotCurves-ideoln"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<pm20,fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(bushideoglm1, plotx=ideoln, interval=
\begin_inset Quotes erd
\end_inset

confidence
\begin_inset Quotes erd
\end_inset

, ylim = c(0, 1.2))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
plotCurves demonstration with ideology
\begin_inset CommandInset label
LatexCommand label
name "fig:plotCurves-ideoln"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predictOMatic
\end_layout

\end_inset

 might fail, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
plotCurves
\end_layout

\end_inset

 might fail.
 These fail when the regression model being estimated has some unusual character
istic, something I did not plan for.
\end_layout

\begin_layout Standard
In which case I'd fall back to the two step procedure.
 
\end_layout

\begin_layout Enumerate
make a 
\begin_inset Quotes eld
\end_inset

newdata
\begin_inset Quotes erd
\end_inset

 data frame that has one row for each hypothetical case for which I want
 to make a prediction, and
\end_layout

\begin_layout Enumerate
run predict (as shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:LogitWConfInt"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and then fiddle around with the fit and se.fit values to manufacture the
 confidence intervals.
\end_layout

\begin_layout Standard
Because making the newdata object can be frustrating, I created a function
 called 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
newdata
\end_layout

\end_inset

 in 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
rockchalk
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
Put party into the logistic regression
\end_layout

\begin_layout Standard
In 2003, I include this section only because I thought Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "cap:DandR"

\end_inset

 was really neat.
 I believe this shows that the effect of ideology is easier to spot if you
 contrast Democrats and Republicans.
 Now, in 2018, I have a better way to estimate the model and make the plot.
 
\end_layout

\begin_layout Standard
But I think it is somewhat unfair to students if I give you the awesome
 result we have at the current time without admitting that I blundered about
 while I was finding the better way.
 So I'll include the old demonstration, then the new way.
 
\end_layout

\begin_layout Subsection*
The 2003 way I included party id in the model
\end_layout

\begin_layout Standard
The party variable was recoded into two 
\begin_inset Quotes eld
\end_inset

dummy
\begin_inset Quotes erd
\end_inset

 variables, 
\begin_inset Quotes eld
\end_inset

repub
\begin_inset Quotes erd
\end_inset

 id 1 for people who are in the Republican party, 0 for others, and 
\begin_inset Quotes eld
\end_inset

democ
\begin_inset Quotes erd
\end_inset

, represents membership in the Democratic party.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=TRUE>>=
\end_layout

\begin_layout Plain Layout

#start adding variables 
\end_layout

\begin_layout Plain Layout

bushideoglm2 <- glm(bushvote ~ ideoln + repub + democ, family=binomial,
 data=nes2002) 
\end_layout

\begin_layout Plain Layout

summary(bushideoglm2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To estimate the impact of ideology for Democrats and Republicans, I went
 through an inconvenient process of making up 3 separate new data objects,
 and pulling predictions for each one.
 Today, I'd make one newdata object here, but I have to live with the silliness
 of the past here:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<622,echo=T>>=
\end_layout

\begin_layout Plain Layout

lnth <- length(nes2002$ideoln) 
\end_layout

\begin_layout Plain Layout

newdfD1 <-data.frame(ideoln=seq(1,7), repub=0, democ=1)
\end_layout

\begin_layout Plain Layout

newdfD1
\end_layout

\begin_layout Plain Layout

predvalsD1 <- predict(bushideoglm2, newdata=newdfD1, type="response")
\end_layout

\begin_layout Plain Layout

newdfR1 <-data.frame(ideoln=seq(1,7), repub=1, democ=0)
\end_layout

\begin_layout Plain Layout

newdfR1
\end_layout

\begin_layout Plain Layout

predvalsR1 <- predict(bushideoglm2, newdata=newdfR1, type="response")
\end_layout

\begin_layout Plain Layout

newdfI1 <-data.frame(ideoln=seq(1,7), repub=0, democ=0)
\end_layout

\begin_layout Plain Layout

predvalsI1 <- predict(bushideoglm2, newdata=newdfI1, type="response")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Democrats and Republicans
\begin_inset CommandInset label
LatexCommand label
name "cap:DandR"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<623,fig=T,echo=T>>=
\end_layout

\begin_layout Plain Layout

plot(seq(1,7), predvalsD1, type="n", ylim=c(0,1), xlim=c(0,8), xlab="ideoln:
 ideology", ylab="Vote (Bush=1, Gore=0)") 
\end_layout

\begin_layout Plain Layout

text(seq(1,7), predvalsR1, labels=rep("r",7))
\end_layout

\begin_layout Plain Layout

text(seq(1,7), predvalsD1, labels=rep("d",7))
\end_layout

\begin_layout Plain Layout

text(seq(1,7), predvalsI1, labels=rep("i",7))
\end_layout

\begin_layout Plain Layout

lines(seq(1,7), predvalsR1, type=
\begin_inset Quotes erd
\end_inset

c
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(seq(1,7), predvalsD1, type=
\begin_inset Quotes erd
\end_inset

c
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(seq(1,7), predvalsI1, type=
\begin_inset Quotes erd
\end_inset

c
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Making a better party & ideology model
\end_layout

\begin_layout Standard
There was no reason to use the dummies 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
repub
\end_layout

\end_inset

 and 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
democ
\end_layout

\end_inset

.
 I have a factor variable 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
partyid
\end_layout

\end_inset

 and I might as well use it.
 The additive model is:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ideol200, echo=TRUE>>=
\end_layout

\begin_layout Plain Layout

bushideoglm3 <- glm(bushvote ~ ideoln + partyid, family=binomial, data=nes2002)
 
\end_layout

\begin_layout Plain Layout

summary(bushideoglm3)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The jury might be undecided if this model is actually better.
 Here is the main problem.
 The missing values in 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
partyid
\end_layout

\end_inset

 cause some cases to be lost.
 The 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ideol210>>=
\end_layout

\begin_layout Plain Layout

predictOMatic(bushideoglm3, predVals = list(ideoln=1:7, partyid = c(
\begin_inset Quotes eld
\end_inset

I
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

D
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

R
\begin_inset Quotes erd
\end_inset

)))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
plotCurves for ideology with moderator party identification
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ideol220, fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(bushideoglm3, plotx=ideoln, modx=partyid, ylim = c(0, 1.3),
\end_layout

\begin_layout Plain Layout

            xlab = 
\begin_inset Quotes eld
\end_inset

Ideology(numeric)
\begin_inset Quotes erd
\end_inset

, ylab = 
\begin_inset Quotes eld
\end_inset

Vote(Bush=1, Gore=0)
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Should it be treated as an interaction model?
\end_layout

\begin_layout Standard
We assumed party id was an additive element, but perhaps it is interactive.
 
\end_layout

\begin_layout Standard
There was no reason to use the dummies repub and democ.
 I have a factor variable partyid and I might as well use it.
 The additive model is:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ideol240, echo=TRUE>>=
\end_layout

\begin_layout Plain Layout

bushideoglm4 <- glm(bushvote ~ ideoln * partyid, family=binomial, data=nes2002)
 
\end_layout

\begin_layout Plain Layout

summary(bushideoglm4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement p
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
plotCurves for ideology with interaction
\begin_inset CommandInset label
LatexCommand label
name "fig:ideologyinteraction1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ideol250, fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(bushideoglm4, plotx=ideoln, modx=partyid, ylim = c(0, 1.3), xlab
 = 
\begin_inset Quotes eld
\end_inset

Ideology(numeric)
\begin_inset Quotes erd
\end_inset

, ylab = 
\begin_inset Quotes eld
\end_inset

Vote(Bush=1, Gore=0)
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Interactions for free: Problem of the S curve translation
\end_layout

\begin_layout Standard
One problem I have not emphasized much in class is that all glm have an
 inherent 
\begin_inset Quotes eld
\end_inset

interaction
\begin_inset Quotes erd
\end_inset

 effect, even if we don't estimate models with interaction terms.
 Even if you don't run 
\begin_inset Formula $y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x1_{i}x2_{i}$
\end_inset

, many generalized models behave 
\emph on
as if
\emph default
 you did that.
 
\end_layout

\begin_layout Standard
In logistic regression, that's easy to see because the S-shaped curve bends
 everything.
 Party ID is important, so much so that it appears that ideology has not
 much effect on Republicans or Democrats in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ideologyinteraction1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In order to 
\begin_inset Quotes eld
\end_inset

see
\begin_inset Quotes erd
\end_inset

 the interaction, apart from the S-shaped transformation, we can inspect
 the model in the space of the linear predictor.
 
\end_layout

\begin_layout Standard
The 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predictOMatic
\end_layout

\end_inset

 output includes predictions of the 
\begin_inset Formula $\eta_{i}$
\end_inset

 variable, the linear predictor.
 The default 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predictOMatic
\end_layout

\end_inset

 output included the transformed values, 
\begin_inset Formula $(\frac{1}{1+e^{-X\beta}})$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ideol260>>=
\end_layout

\begin_layout Plain Layout

predictOMatic(bushideoglm3, predVals = list(ideoln=1:7, partyid = c(
\begin_inset Quotes eld
\end_inset

I
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

D
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

R
\begin_inset Quotes erd
\end_inset

)), type = 
\begin_inset Quotes eld
\end_inset

link
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:plotLPspace"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\begin_inset Float figure
placement p
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
plotCurves in the linear predictor space to better inspect interactions
\begin_inset CommandInset label
LatexCommand label
name "fig:plotLPspace"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ideol300, fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(bushideoglm4, plotx=ideoln, modx=partyid,
\end_layout

\begin_layout Plain Layout

            xlab=
\begin_inset Quotes eld
\end_inset

Ideology(numeric)
\begin_inset Quotes erd
\end_inset

, ylab=
\begin_inset Quotes eld
\end_inset

Linear predictor: XB
\begin_inset Quotes erd
\end_inset

,
\end_layout

\begin_layout Plain Layout

            type=
\begin_inset Quotes eld
\end_inset

link
\begin_inset Quotes erd
\end_inset

, plotPoints=FALSE, ylim = c(-4,4))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
The Bush Thermometer variable is interesting.
 
\end_layout

\begin_layout Standard
This is introduced because it is 
\emph on
as close to a numeric variable as we can get
\emph default
 in this data.
 I believe it is actually an ordinal variable masquerading as a number,
 but we'll treat it as a number, just for practice.
\end_layout

\begin_layout Standard
The variable in question is
\end_layout

\begin_layout Itemize
V023010: Where on that thermometer would you rate George W.
 Bush? (on a scale from 0 to 100) 
\end_layout

\begin_layout Standard
That one does not need to be recoded.
 Its histogram is displayed in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:HistBushTherm"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Histogram of the Bush feeling thermometer
\begin_inset CommandInset label
LatexCommand label
name "fig:HistBushTherm"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<bushtherm, fig=T>>=
\end_layout

\begin_layout Plain Layout

hist(nes2002$V023010, prob=T, xlab = 
\begin_inset Quotes eld
\end_inset

Bush Feeling Thermometer
\begin_inset Quotes erd
\end_inset

, breaks = seq(0, 100, by = 5), main=
\begin_inset Quotes eld
\end_inset


\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The OLS estimates for the model including only the Bush feeling thermometer
 are as follows:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<olsthermoreg,echo=T>>=
\end_layout

\begin_layout Plain Layout

olsthermo1 <- lm(bushvote ~ V023010, data=nes2002) 
\end_layout

\begin_layout Plain Layout

summary(olsthermo1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results from logistic estimates from glm are as follows (see Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "cap:LogisticAndOLSglmthermo1"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<6122,echo=T>>=
\end_layout

\begin_layout Plain Layout

glmthermo1 <- glm(bushvote ~ V023010, data=nes2002, family=binomial) 
\end_layout

\begin_layout Plain Layout

summary(glmthermo1) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
A presentable table for these models is provided in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:ThermoOutreg"
plural "false"
caps "false"
noprefix "false"

\end_inset

, which also includes the probit model for comparison.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<6122,echo=F>>=
\end_layout

\begin_layout Plain Layout

glmthermo2 <- glm(bushvote ~ V023010, data=nes2002, family=binomial(link=probit)
)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Bush Thermometer Models
\begin_inset CommandInset label
LatexCommand label
name "tab:ThermoOutreg"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<6123, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(
\begin_inset Quotes eld
\end_inset

OLS
\begin_inset Quotes erd
\end_inset

 = olsthermo1, 
\begin_inset Quotes eld
\end_inset

Logistic
\begin_inset Quotes erd
\end_inset

 = glmthermo1, 
\begin_inset Quotes eld
\end_inset

Probit
\begin_inset Quotes erd
\end_inset

 = glmthermo2), tight=FALSE, varLab = vl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "cap:LogisticAndOLSglmthermo1"

\end_inset

 illustrates how, in 2003, I plotted the relationship between the respondent's
 
\begin_inset Quotes eld
\end_inset

thermometer scale score
\begin_inset Quotes erd
\end_inset

 for Pres Bush and the vote.
 The OLS and Logistic regression lines are superimposed on the plot.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Thermometer model: Logistic and OLS Predicted Probabilities
\begin_inset CommandInset label
LatexCommand label
name "cap:LogisticAndOLSglmthermo1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<6124,fig=T>>=
\end_layout

\begin_layout Plain Layout

nd <- data.frame(V023010 =seq(0,100))
\end_layout

\begin_layout Plain Layout

nd$glmpred1 <- predict(glmthermo1, newdata=nd, type="response")
\end_layout

\begin_layout Plain Layout

nd$olspred1 <- predict(olsthermo1, newdata=nd)
\end_layout

\begin_layout Plain Layout

plot(nes2002$V023010, nes2002$bushvote, ylim=c(-0.2,1.2), xlim=c(0,100), xlab="Bus
h Thermometer", ylab="Predicted Probability of Bush Vote")
\end_layout

\begin_layout Plain Layout

lines(glmpred1 ~ V023010, data = nd, lty = 1)
\end_layout

\begin_layout Plain Layout

lines(olspred1 ~ V023010, data = nd, lty = 2)
\end_layout

\begin_layout Plain Layout

legend(
\begin_inset Quotes eld
\end_inset

left
\begin_inset Quotes erd
\end_inset

, legend = c(
\begin_inset Quotes eld
\end_inset

OLS
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Logistic
\begin_inset Quotes erd
\end_inset

), lty = c(2,1))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
The 
\begin_inset Quotes eld
\end_inset

Full Model
\begin_inset Quotes erd
\end_inset

??
\end_layout

\begin_layout Standard
We have more predictors available.
 We might as well use them.
 I'll leave party as a categorical predictor, but for the moment we leave
 the rest as if they were reasonably treated as numeric.
 The full model includes the Bush thermometer variable (V0234010), ideology
 (V023027), the 2 party variables,  education (V023131), and the state of
 the economy (V023027).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<66,echo=T>>=
\end_layout

\begin_layout Plain Layout

bushlogit5 <- glm(bushvote ~ V023010 + ideoln + partyid + useconn + educn
 , data=nes2002, family=binomial(link=logit), model=TRUE)
\end_layout

\begin_layout Plain Layout

summary(bushlogit5)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Outreg summarizes that as:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<glm5outreg, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(
\begin_inset Quotes eld
\end_inset

Full Model
\begin_inset Quotes erd
\end_inset

 = bushlogit5), tight=F, varLab = vl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is often useful to place the full and partial models side by side.
 An example would be
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<glm5outreg2, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(
\begin_inset Quotes eld
\end_inset

Full Model
\begin_inset Quotes erd
\end_inset

=bushlogit5, 
\begin_inset Quotes eld
\end_inset

Ideology Only
\begin_inset Quotes erd
\end_inset

=bushideoglm1,
\end_layout

\begin_layout Plain Layout

\begin_inset Quotes eld
\end_inset

Ideol.
 Party Dummies
\begin_inset Quotes erd
\end_inset

 = bushideoglm2, 
\begin_inset Quotes eld
\end_inset

Ideol.
 w/party id
\begin_inset Quotes erd
\end_inset

 = bushideoglm3, 
\begin_inset Quotes erd
\end_inset

Interaction
\begin_inset Quotes erd
\end_inset

 = bushideoglm4), 
\end_layout

\begin_layout Plain Layout

tight=T, varLab = vl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note: I changed to the tight format in order to save horizontal space.
\end_layout

\begin_layout Subsection*
Nested model test
\end_layout

\begin_layout Standard
The parameter model=TRUE requests glm to keep a copy of the data set that
 was used.
 Because we keep a copy of the data set, it is easy to do an ANOVA style
 nested model test.
\end_layout

\begin_layout Standard
Suppose we wonder if it is 
\begin_inset Quotes eld
\end_inset

save
\begin_inset Quotes erd
\end_inset

 to remove the dummies for party membership and the US economy variable
 from the full model.
 (I don't mean we should do that, but somebody might wonder 
\emph on
what if
\emph default
.) 
\end_layout

\begin_layout Standard
Fit the 
\begin_inset Quotes eld
\end_inset

smaller
\begin_inset Quotes erd
\end_inset

 model that restricts the omitted variables (useecon and partyid) by assuming
 their coefficients are equal to 0.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<bush5b1>>=
\end_layout

\begin_layout Plain Layout

bushlogit5b <- glm(bushvote ~ V023010 + ideoln + educn, 
\end_layout

\begin_layout Plain Layout

data=model.frame(bushlogit5), family=binomial(link=logit), model=TRUE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The likelihood ratio test is performed by the R anova method for generalized
 linear models.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<bush5b2>>=
\end_layout

\begin_layout Plain Layout

anova(bushlogit5, bushlogit5b, test = 
\begin_inset Quotes eld
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The result says the 2 models are statistically significantly different,
 so it is not save to remove both of those variables.
\end_layout

\begin_layout Section
What about using ordinal variables as numeric predictors?
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
This is the Ian Ostrander memorial section
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This is an age-old controversy.
 Is a 7 point Likert scale actually a numeric variable, or is it just a
 categorical ordering? 
\end_layout

\begin_layout Standard
My strategy here is to avoid the general philosophical debate and convert
 the debate to more practical terms.
 My answer is this: test whether the categorical values are meaningfully
 different in their impact on the prediction, and then find out if the impact
 of the categories is actually 
\begin_inset Quotes eld
\end_inset

linear
\begin_inset Quotes erd
\end_inset

.
 If it is, then treat the predictor as a number.
 Otherwise, treat it as categories.
 
\end_layout

\begin_layout Subsection
Education
\end_layout

\begin_layout Standard
Why bother? Well, the full model seems to say that education's coefficient
 in the Bush vs Gore decision is not meaningfully different from 0.
 That may be a mistake, however, because we have used the 7 category data
 as if it were a meaningful numeric scale.
 Perhaps instead of a linear 1-2-3 effect, the impact of adjusting education
 across the 7 categories is something like 0.5, 0.8, 0.8, 1.0, 1.0, 1.0? If the
 effect of education happens in discrete lumps, then we may need to combine
 the people who finished some college with the people who finished with
 a 2 year Associate's degree, for example.
 Or perhaps we should combine college graduates and post-graduate degree
 holders? (Joke: How much smarter do you need to get before you see Al Gore
 was right?).
\end_layout

\begin_layout Standard
The method here is as follows.
 Wit the same 
\begin_inset Quotes eld
\end_inset

big model
\begin_inset Quotes erd
\end_inset

 but replace the numeric education variable with the unordered categorical
 variable, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
educf
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsubsection*
ANOVA test to find out if any of the education levels matter
\end_layout

\begin_layout Standard
The full model is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
Pr(y_{i}=1)=\frac{1}{1+e^{-\eta_{i}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where
\begin_inset Formula 
\begin{align}
\eta_{i} & =\beta_{0}+\beta_{1}BushTherm+\beta_{2}Ideology+\beta_{3}Democ.+\beta_{4}Repub.+\beta_{5}USecon+\\
 & \beta_{6}educ2_{i}+\beta_{7}educ3_{i}+\beta_{8}educ4_{i}+\beta_{9}educ5_{i}+\beta_{10}educ6_{i}+\beta_{11}educ7_{i}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
When we estimate education as unordered factor variable, we are introducing
 a series of 
\begin_inset Quotes eld
\end_inset

dummy variables
\begin_inset Quotes erd
\end_inset

.
 The lowest level of education, the elementary-school cases, are in the
 intercept, and the following are estimated as contrasts against that low
 level.
 We can get estimates for each of the 6 different levels (could suppress
 intercept to see explicit lowest category).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<811,echo=T>>=
\end_layout

\begin_layout Plain Layout

bushlogit6 <- glm(bushvote ~ V023010 + ideoln + partyid + useconn  + educf,
 data=nes2002, family=binomial(link=logit), model=TRUE)
\end_layout

\begin_layout Plain Layout

summary(bushlogit6)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
What does this show? Should we conclude that education plays a role, or
 not? A couple of categories 
\begin_inset Quotes eld
\end_inset

seem to matter
\begin_inset Quotes erd
\end_inset

, but what is the bottom line?
\end_layout

\begin_layout Subsubsection*
ANOVA test deletion of variables in a nested model
\end_layout

\begin_layout Standard
If we state the null hypothesis that 
\begin_inset Quotes eld
\end_inset

all education coefficients are 0
\begin_inset Quotes erd
\end_inset

 and let the alternative be 
\begin_inset Quotes eld
\end_inset

at least one of the education coefficients is not 0,
\begin_inset Quotes erd
\end_inset

 then we should conduct a Likelihood Ratio test comparing the two models.
 The built-in function 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
drop1
\end_layout

\end_inset

 will do all of the work:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<812,echo=T>>=
\end_layout

\begin_layout Plain Layout

drop1(bushlogit6, test="Chisq")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that the '
\begin_inset Flex Code
status open

\begin_layout Plain Layout
drop1
\end_layout

\end_inset

' groups together all of the levels of the factor variable and it addresses
 the question 
\begin_inset Quotes eld
\end_inset

does this variable make a difference 
\emph on
at all
\emph default
.
\begin_inset Quotes erd
\end_inset

 In other words, it is conducting the Likelihood Ratio test that you really
 want if you are deciding whether education plays a role in predicting voting.
 This test says that at least some of the categories are different from
 0 in their effect.
\end_layout

\begin_layout Standard
The 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
drop1
\end_layout

\end_inset

 is identical to the test we would conduct by hand, if we fitted a smaller
 model by omitting one predictor at a time and running 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
anova()
\end_layout

\end_inset

.
 The anova function performs the likelihood ratio test because we specified
 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
test=
\begin_inset Quotes erd
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

).
\end_layout

\begin_layout Subsubsection*
Is the education effect linear?
\end_layout

\begin_layout Standard
If the effect of education were linear, then the plot of the predicted values
 would appear as evenly spaced steps.
 That does not seem to be the case in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Termplot.educ"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Termplot display of Education 
\begin_inset Quotes eld
\end_inset

step
\begin_inset Quotes erd
\end_inset

 effects
\begin_inset CommandInset label
LatexCommand label
name "fig:Termplot.educ"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<821,echo=T,fig=T>>=
\end_layout

\begin_layout Plain Layout

termplot(bushlogit6, terms="educf")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The anova test on the categorical predictor 
\begin_inset Quotes eld
\end_inset


\begin_inset Flex Code
status open

\begin_layout Plain Layout
educf
\end_layout

\end_inset


\begin_inset Quotes erd
\end_inset

 indicates that 
\begin_inset Quotes eld
\end_inset

education matters.
\begin_inset Quotes erd
\end_inset

 Now we want to know if the effect is a linear step sequence of even steps.
 The graph makes me expect that the linear model is wrong.
 One quick hint is to compare the 
\begin_inset Quotes eld
\end_inset

residual deviance
\begin_inset Quotes erd
\end_inset

 values of the two models.
 What do you see? 
\end_layout

\begin_layout Standard
We can formally test that conclusion, however.
 Conduct a likelihood ratio test, comparing the 
\begin_inset Quotes eld
\end_inset

full
\begin_inset Quotes erd
\end_inset

 model that uses the factor coding of education with the 
\begin_inset Quotes eld
\end_inset

reduced
\begin_inset Quotes erd
\end_inset

 model which assumes that the different levels have the same effects.
 Note how ironic it is that the restricted model in this comparison is the
 one I called the full model in a previous section.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<glm6anova, echo=T>>=
\end_layout

\begin_layout Plain Layout

anova(bushlogit5, bushlogit6, test="Chisq")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Followup: compressing categories
\end_layout

\begin_layout Standard
In the Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Termplot.educ"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we might have evidence for the idea that categories 5, 6, and 7 have the
 same effect.
 We can construct a new predictor that puts those together.
 In rockchalk I put in a special purpose function for this called combineLevels,
 but the general purpose plyr::mapvalues function would also do the job.
 (If you say, 
\begin_inset Quotes eld
\end_inset

This looks like a fool's errand,
\begin_inset Quotes erd
\end_inset

 I agree, but lets work out the example.) 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<840,echo=T>>=
\end_layout

\begin_layout Plain Layout

nes2002$educf2 <- combineLevels(nes2002$educf, levs=c(5,6,7),  
\begin_inset Quotes eld
\end_inset

Higher Ed
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

table(
\begin_inset Quotes eld
\end_inset

educ: reduced
\begin_inset Quotes erd
\end_inset

 = nes2002$educf2, 
\begin_inset Quotes eld
\end_inset

educ: 7 categories
\begin_inset Quotes erd
\end_inset

 = nes2002$educf, exclude = NULL)
\end_layout

\begin_layout Plain Layout

bushlogit6c <- glm(bushvote ~ V023010 + ideoln + partyid + educf2 + useconn,
 data=nes2002, family=binomial(link=logit))
\end_layout

\begin_layout Plain Layout

summary(bushlogit6c)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The null hypothesis is that we prefer to keep the restriction so that the
 last 3 levels of education have the same effect, while the alternative
 is that we need to keep the larger model which estimates separate coefficients.
 We then test that simplified categorical model against the previous fit
 that included the original factor variable.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<850>>=
\end_layout

\begin_layout Plain Layout

anova(bushlogit6c, bushlogit6, test=
\begin_inset Quotes erd
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Well, the conclusion is that the model that uses the simpler set of categories
 for the education variable is not noticeably worse than the one that estimates
 separate coefficient for each category.
\end_layout

\begin_layout Standard
Where does this leave us with the education variable, however.
 It appears we might want to squish more levels together.
 Or perhaps we should look up and realize that education, no matter how
 we code it, is not very tightly linked to how people voted in 2000.
 
\end_layout

\begin_layout Standard
Enjoy this drop1 output, which seems to say that this 4-level education
 variable has coefficients that differ from 0.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

drop1(bushlogit6c, test=
\begin_inset Quotes erd
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Ideology
\end_layout

\begin_layout Standard
I found myself wondering if the ideology variable should also be given the
 
\begin_inset Quotes eld
\end_inset

factor
\begin_inset Quotes erd
\end_inset

 consideration.
 Planning for this phase, I created 2 versions of the categorical variable.
 One is an ordinary unordered factor, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideof
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
The other variable, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideolo
\end_layout

\end_inset

, is an ordered factor.
 When R regression routines find a predictor that is an ordered factor,
 they change the contrast codes to use orthogonal polynomials.
\end_layout

\begin_layout Subsubsection*
Treatment contrasts
\end_layout

\begin_layout Standard
The full model re-fit with the categorical unordered variable, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideolf
\end_layout

\end_inset

, provides 
\begin_inset Quotes eld
\end_inset

dummy
\begin_inset Quotes erd
\end_inset

 variable estimates for the highest 6 levels of ideology.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<822,echo=T>>=
\end_layout

\begin_layout Plain Layout

bushideolrm7f <- glm(bushvote ~ V023010 + ideolf + partyid + educn + useconn,
 data=nes2002, family=binomial(link=logit))
\end_layout

\begin_layout Plain Layout

summary(bushideolrm7f)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
A formal test that compares the 
\begin_inset Quotes eld
\end_inset

factor coding
\begin_inset Quotes erd
\end_inset

 against the 
\begin_inset Quotes eld
\end_inset

linear coding
\begin_inset Quotes erd
\end_inset

 is as follows:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=T>>=
\end_layout

\begin_layout Plain Layout

anova(bushlogit5, bushideolrm7f, test="Chisq")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The result difference in the predictive power of the two models is not statistic
ally significant, so we probably ought to go ahead and use the 
\begin_inset Quotes eld
\end_inset

linear coding
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
Would you stop with that conclusion? I think you probably should.
 You'd wonder why the lowest level of ideology appears to have such a strange
 spike.
 Look back at the descriptive table for the ideology variable.
 Notice that there are 12 respondents, only 12, who have the lowest score,
 which is 1.
 The anova test indicates that the aberrant estimate for that group is not
 
\begin_inset Quotes eld
\end_inset

statistically out of line,
\begin_inset Quotes erd
\end_inset

 at least not far enough out of line to make us think we need to worry about
 treating ideology as a factor.
\end_layout

\begin_layout Subsubsection*
orthopoly contrasts
\end_layout

\begin_layout Standard
The fit of the model that uses the ordinal variable, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideolo
\end_layout

\end_inset

, is superficially different.
 Instead of fitting the intercept as a baseline group and then adding 6
 dummy variables, the orthogonal polynomial contrasts create predictor columns
 that are, by definition, uncorrelated with each other (hence, 
\begin_inset Quotes eld
\end_inset

orthogonal
\begin_inset Quotes erd
\end_inset

).
 I made some notes a while ago about orthogonal polynomial contrasts (look
 in 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pj.freefaculty.org/R/WorkingExamples
\end_layout

\end_inset

 for a file named 
\begin_inset Quotes eld
\end_inset

regression-orderedFactors...
\begin_inset Quotes erd
\end_inset

).
\end_layout

\begin_layout Standard
These contrasts appear to be grossly different in interpretation, but the
 difference is only skin deep.
 The ordinal model triggers the usage of 
\begin_inset Quotes eld
\end_inset

orthopoly
\begin_inset Quotes erd
\end_inset

 contrasts, an alternative way of creating the comparisons that are used.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<822o,echo=T>>=
\end_layout

\begin_layout Plain Layout

bushideolrm7o <- glm(bushvote ~ V023010 + ideolo + partyid + educn + useconn,
 data=nes2002, family=binomial(link=logit))
\end_layout

\begin_layout Plain Layout

summary(bushideolrm7o)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
It 
\emph on
looks
\emph default
 different, but if you look at the models side-by-side, there are hints
 that they are actually interchangeable:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(
\begin_inset Quotes eld
\end_inset

ideolf
\begin_inset Quotes erd
\end_inset

=bushideolrm7f, 
\begin_inset Quotes eld
\end_inset

ideolo
\begin_inset Quotes erd
\end_inset

=bushideolrm7o), tight = F, varLab = vl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note the likelihood ratio test with the ordinal version of the factor leads
 to the exact same conclusion that we reached when we tested with the previous
 model: 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=T>>=
\end_layout

\begin_layout Plain Layout

anova(bushlogit5, bushideolrm7o, test="Chisq")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The hypothesis test is the same, whether we use 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideolo
\end_layout

\end_inset

 or 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
ideolf
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
You might wonder, 
\begin_inset Quotes eld
\end_inset

what is an orthogonal polynomial
\begin_inset Quotes erd
\end_inset

.
 Here is a hint:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

x <- 1:7
\end_layout

\begin_layout Plain Layout

xf <- factor(x)
\end_layout

\begin_layout Plain Layout

contrasts(xf)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
When the regression routine finds a variable coded like xf, it creates 6
 columns of 
\begin_inset Quotes eld
\end_inset

dummy variables
\begin_inset Quotes erd
\end_inset

 as we see here.
 If an observed score on the factor is 1, all of the dummies are 0's, meaning
 the case is 
\begin_inset Quotes eld
\end_inset

in the intercept.
\begin_inset Quotes erd
\end_inset

 If x is 2 then the values of the dummy variables are pulled from row 2,
 
\begin_inset Formula $(1,0,0,0,0,0)$
\end_inset

.
 If 
\begin_inset Formula $x$
\end_inset

 happens to be a 5, then 
\begin_inset Formula $(0,0,0,1,0,0)$
\end_inset

 is the dummy variable vector.
 Hopefully, that's what you expect.
\end_layout

\begin_layout Standard
In comparison, these are the predictor rows that are substituted for the
 observed values of the ordered factor:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

xo <- factor(x, ordered = TRUE)
\end_layout

\begin_layout Plain Layout

contrasts(xo)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
These are quite different in appearance, but they may help diagnose nonlinear
 trends in some models.
 Unfortunately, in this case, they all say 
\begin_inset Quotes eld
\end_inset

we can't detect anything.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Subsubsection*
Note the interesting quirk about ideology
\end_layout

\begin_layout Standard
In the model that uses ideology as a numeric predictor, we find the coefficient
 is statistically significantly different from 0.
 However, when we take it as a categorical variable, then we are not able
 to say with much confidence that any two categories are different from
 each other.
 That might make us think we should drop the ideology variable, but the
 likelihood ratio test (drop1) indicates that ideology coefficients are
 probably not all equal to 0.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

drop1(bushideolrm7f, test = 
\begin_inset Quotes eld
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
That, in a nutshell, is the justification for the nested model hypothesis
 test procedure.
 None of the separate categories of ideology seem to matter, but the null
 hypothesis that all of the ideology of parameters are all equal to 0 is
 rejected.
 This result is somewhat unusual in my experience.
 Usually, at least one of the dummy variables is statistically significant.
\end_layout

\begin_layout Subsection
Can we save the 
\begin_inset Quotes eld
\end_inset

US economy
\begin_inset Quotes erd
\end_inset

 variable?
\end_layout

\begin_layout Standard
The answer will be no, it seems.
 
\end_layout

\begin_layout Standard
The numeric coding says there is not a detectable linear relationship for
 the US economy variable, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
useconn
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
I hate to admit the economy does not matter.
 Maybe the effect is not linear! Lets take the 
\begin_inset Quotes eld
\end_inset

full
\begin_inset Quotes erd
\end_inset

 model and replace the numeric US economy variable by a categorical 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
usecono
\end_layout

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<usecon10,echo=T>>=
\end_layout

\begin_layout Plain Layout

bushlogit8 <- glm(bushvote ~ V023010 + ideoln + partyid + usecono + educn,
 data=nes2002, family=binomial(link=logit), model=TRUE)
\end_layout

\begin_layout Plain Layout

summary(bushlogit8)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I think we found out in the previous section that we can't read the orthogonal
 contrast estimates from the table.
 We have to rely on formal hypothesis tests (or, possibly, give in to temptation
 and create an ordinary factor variable useconf that will use the treatment
 contrasts we have come to enjoy so much).
\end_layout

\begin_layout Standard
The 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
drop1
\end_layout

\end_inset

 function will check all of the variables, but we are really only interested
 in 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
usecono
\end_layout

\end_inset

, of course
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

drop1(bushlogit8, test = 
\begin_inset Quotes eld
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
I suppose we could check to make sure that test is doing the 
\begin_inset Quotes eld
\end_inset

right thing
\begin_inset Quotes erd
\end_inset

.
 To check that estimate, we need to fit the same model, but omit usecono,
 and then compare with a likelihood-ratio test.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

bushlogit8r <- glm(bushvote ~ V023010 + ideoln + partyid + educn, data=model.fram
e(bushlogit8), family=binomial(link=logit))
\end_layout

\begin_layout Plain Layout

anova(bushlogit8r, bushlogit8, test = 
\begin_inset Quotes eld
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Fortunately for us, the result is equivalent to the value reported in 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
drop1
\end_layout

\end_inset

.
 However, it is still a little disappointing that the economy does not matter.
\end_layout

\begin_layout Standard
Finally, it might be that the model fitted with the categorical version
 is somehow better than the linear coding used in the 
\begin_inset Quotes eld
\end_inset

full
\begin_inset Quotes erd
\end_inset

 model.
 But alas, it is not so.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<usecon20>>=
\end_layout

\begin_layout Plain Layout

anova(bushlogit5, bushlogit8, test = 
\begin_inset Quotes eld
\end_inset

Chisq
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Section
Compare Logit and Probit links
\end_layout

\begin_layout Subsection
Estimating a Probit model: glm with binomial(probit)
\end_layout

\begin_layout Standard
With R's glm, the distinction between logit and probit is found in the 
\begin_inset Quotes eld
\end_inset

link
\begin_inset Quotes erd
\end_inset

 function, the transformation that is applied to the left hand side to go
 from 
\begin_inset Quotes eld
\end_inset

probability
\begin_inset Quotes erd
\end_inset

 into the scale of the linear predictor.
 The Logistic model was estimated with the command
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{Sinput}
\end_layout

\begin_layout Plain Layout

bushideoglm1 <- glm(bushvote~ideoln, family=binomial, data=nes2002) 
\end_layout

\begin_layout Plain Layout


\backslash
end{Sinput}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To fit a probit model, one in which the random error is normal, we make
 only one small change in the command.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=T>>=
\end_layout

\begin_layout Plain Layout

bushideoProbit1 <- glm(bushvote~ideoln, family=binomial(link=probit), data=nes20
02) 
\end_layout

\begin_layout Plain Layout

summary(bushideoProbit1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout LyX-Code

\end_layout

\begin_layout Subsection
OLS, Logit and Probit Side by Side
\end_layout

\begin_layout Subsubsection*
Ideology fits side by side.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(ols1, bushideoglm1, bushideoProbit1), tight=T, showAIC=T, modelLabel
s=c("OLS","Logit","Probit"), varLab = vl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
The Full Model fitted with all three methods
\end_layout

\begin_layout Standard
Compare the OLS, Logit, and Probit fits in the full model.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<99,echo=T>>=
\end_layout

\begin_layout Plain Layout

bushprobit5 <- glm(bushvote ~ V023010 + ideoln + partyid + educn + useconn,
 data=nes2002, family=binomial(link=probit), model=T)
\end_layout

\begin_layout Plain Layout

summary(bushprobit5)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<100,echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

bushols5 <- lm(bushvote ~ V023010 + ideoln + partyid + educn + useconn,
 data=nes2002)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Outreg summarizes that as:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<101, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(bushols5, bushlogit5, bushprobit5), tight=T, showAIC=T, modelLabels=
c("OLS","Logit","Probit"), varLab = vl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The ratio of the logit to the probit estimates depends on the assumed value
 of standard deviation of the error term (as that term arises in the CDF
 interpretation of the logit and probit models).
 That standard deviation cannot be estimated, it has to be set by the user
 to some arbitrary value, and all of the coefficients adjust in response.
 I extracted the estimated coefficients from the 2 models and then calculated
 the ratio of the logit to the probit estimates.
 I expected that the ratios would be almost exactly the same, and that made
 me suspect I had done something incorrectly.
 But I don't see the mistake.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<110>>=
\end_layout

\begin_layout Plain Layout

logitcoef <- coef(bushlogit5)
\end_layout

\begin_layout Plain Layout

probitcoef <- coef(bushprobit5)
\end_layout

\begin_layout Plain Layout

cbind(logitcoef, probitcoef, ratio=logitcoef/probitcoef)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Lets compare the ratio of b/se(b) and the p values to see what the differences
 might be:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<120>>=
\end_layout

\begin_layout Plain Layout

options(digits=3)
\end_layout

\begin_layout Plain Layout

logitsummary <- summary(bushlogit5)
\end_layout

\begin_layout Plain Layout

probitsummary <- summary(bushprobit5)
\end_layout

\begin_layout Plain Layout

zcompare <- cbind(logitsummary$coefficients[, c(3,4)], probitsummary$coefficient
s[, c(3,4)])
\end_layout

\begin_layout Plain Layout

zcompare <- as.data.frame(zcompare)
\end_layout

\begin_layout Plain Layout

colnames(zcompare) <- c("logit-z","logit-p", "probit-z", "probit-p")
\end_layout

\begin_layout Plain Layout

zcompare$ratioz <- zcompare[ ,1] / zcompare[ ,3]
\end_layout

\begin_layout Plain Layout

zcompare
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In practice, I have never fitted a model for dichotomous data for which
 I felt that the choice of the logit or probit link made a substantial differenc
e.
 The differences here in the estimated ratios of 
\begin_inset Formula $\hat{\beta}/se(\hat{\beta})$
\end_inset

 are not trivial, but they also are not so great as to make us change our
 conclusions.
 
\end_layout

\begin_layout Standard
Finally, lets get the predicted values from the models and plot them against
 each other.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<130, fig=T, height=6, width=6>>=
\end_layout

\begin_layout Plain Layout

logitpred <- predict(bushlogit5, type="response")
\end_layout

\begin_layout Plain Layout

probitpred <- predict(bushprobit5, type="response")
\end_layout

\begin_layout Plain Layout

plot(logitpred, probitpred, xlab="Predicted Probabilities from Logit Model",
 ylab="Predicted Probabilties from Probit Model", main="Scatterplot of Predictio
ns from Logit and Probit")
\end_layout

\begin_layout Plain Layout

pmod1 <- lm(probitpred ~ logitpred)
\end_layout

\begin_layout Plain Layout

summary(pmod1)
\end_layout

\begin_layout Plain Layout

abline(pmod1, col="red", lwd=2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend=c("OLS regression"), col="red", lwd=2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Section
ROC
\end_layout

\begin_layout Standard
In the notes on logit models, there is a brief section on the ROC curve
 approach to measuring the quality of the predictions from the model.
 We want the model to predict 0 when the truth is 0 (True Negative) and
 we want a prediction of 1 if the observed score is 1 (True Positive).
 
\end_layout

\begin_layout Standard
Take the predicted probabilities from the model, 
\begin_inset Formula $\hat{p}_{i}$
\end_inset

, and calculate predictions for a cutoff point, 
\begin_inset Formula $\tau$
\end_inset

.
 Suppose for 3 cases, 
\begin_inset Formula $\hat{p}=(0.3,0.6,0.8)$
\end_inset

.
 In the usual way of thinking about logit models, the prediction dividing
 point is 0.5 and the model would predict 
\begin_inset Formula $(0,1,1)$
\end_inset

.
 Now we change that story by supposing that the divider 
\begin_inset Formula $\tau$
\end_inset

 might be very high, say 0.9, in which the model predicts 
\begin_inset Formula $(0,0,0)$
\end_inset

.
 However, as we dial the divider down, the predictions change, first at
 
\begin_inset Formula $\tau=0.8,$
\end_inset

 we predict 
\begin_inset Formula $(0,0,1)$
\end_inset

, and the predictions stay the same until the divider hits 
\begin_inset Formula $0.6,$
\end_inset

when the prediction changes to 
\begin_inset Formula $(0,1,1),$
\end_inset

and then when the divider falls to 
\begin_inset Formula $0.3,$
\end_inset

 then the predictions are 
\begin_inset Formula $(1,1,1)$
\end_inset

.
 
\end_layout

\begin_layout Standard
I'll write the prediction for a case as a function of the cutoff value:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{y}_{i}(\tau)=\begin{cases}
1\, & \hat{p}_{i}\geq\tau\\
0 & else
\end{cases}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For a vector of predictions, we can calculate the percentages predicted
 correctly, the true positive rate (TPR), the true negative rate (TNR),
 the false positive rate (FPR) and the false negative rate (FNR).
 
\end_layout

\begin_layout Standard
Generally, we experience a tradeoff between specificity, the ability to
 correctly predict 0's, and sensitivity, the ability to predict 1's.
 A model that predicts all 0's has fantastic specificity, but poor sensitivity,
 while a model that predicts all 1's is sensitive, but not selective.
 If this were a medical diagnostic test, for example, we might be forced
 into a situation of using a test that is either too 
\begin_inset Quotes eld
\end_inset

jumpy
\begin_inset Quotes erd
\end_inset

 (we tell many people they have cancer, but in fact they do not) or too
 insensitive (we don't tell people they have cancer when we ought to).
\end_layout

\begin_layout Standard
A common graph for this process is the ROC curve.
 We vary 
\begin_inset Formula $\tau$
\end_inset

 from 
\begin_inset Formula $1$
\end_inset

 to 
\begin_inset Formula $0$
\end_inset

 (predictions begin as all 0's, and end up at all 1's).
 The ROC curve in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ROC5"
plural "false"
caps "false"
noprefix "false"

\end_inset

 explores the nature of possible predictions by plotting the change as 
\begin_inset Formula $\tau$
\end_inset

 changes from 1 to 0.
 Start at the bottom left, where the model predicts 0 for every case.
 The horizontal value, specificity, is 1.0, meaning that there are no 
\begin_inset Quotes eld
\end_inset

false positives
\begin_inset Quotes erd
\end_inset

, and sensitivity is 0, meaning that none of the true positives were predicted
 correctly.
 This point at the bottom left happens when we make the model predict 0
 for every row in the data.
 As we move the cutpoint into the range of predicted probabilities, the
 predictions change for some cases from 0 to 1.
 
\end_layout

\begin_layout Standard
Hopefully, the cases for which we change the prediction to 1 are correct,
 meaning our TNR is not dropping off too fast, but the TPR is increasing
 rapidly.
 A model that fits the data very accurately will have an ROC curve like
 the one in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ROC5"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 When the value of 
\begin_inset Formula $\tau$
\end_inset

 reaches 0.5, we hope that the curve will be in the top left section of the
 graph.
 The TNR is near 1, meaning if we predict 0, that's what is observed.
 We want sensitivity, the TPR, to climb toward 1, so that when we predict
 a 1, we observe a 1.
 When we are half way along the transition (
\begin_inset Formula $\tau$
\end_inset

 has moved from 
\begin_inset Formula $1.0$
\end_inset

 to 
\begin_inset Formula $0.5$
\end_inset

), the predictions might start getting worse.
 
\end_layout

\begin_layout Standard
If a predictive model is not well suited to the data, the ROC curve will
 follow the diagonal line in the graph.
 This means, basically, that when the model predictions change from 0 to
 1, they are not making the predictions more accurate.
 
\end_layout

\begin_layout Standard
The AUC value, the 
\begin_inset Quotes eld
\end_inset

area under the curve,
\begin_inset Quotes erd
\end_inset

 is often thought of as a summary of how well the model fits with the data.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<roc10>>=
\end_layout

\begin_layout Plain Layout

library(pROC)
\end_layout

\begin_layout Plain Layout

bl5roc <- roc(model.frame(bushlogit5)$bushvote, logitpred)
\end_layout

\begin_layout Plain Layout

bl5roc
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
ROC Diagram for full model
\begin_inset CommandInset label
LatexCommand label
name "fig:ROC5"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<roc20, fig=T>>=
\end_layout

\begin_layout Plain Layout

plot(bl5roc, print.auc = TRUE, xlab = 
\begin_inset Quotes eld
\end_inset

specificity = TNR = 1 - FPR
\begin_inset Quotes eld
\end_inset

, ylab = 
\begin_inset Quotes eld
\end_inset

Sensitivity = TPR = 1 - FNR
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "theme/R"
options "bibtotoc,apalike2"

\end_inset


\end_layout

\begin_layout Section*
Replication Information
\begin_inset CommandInset label
LatexCommand label
name "sec:Session-Info"

\end_inset


\end_layout

\begin_layout Standard
Please leave this next code chunk if you are producing a guide document.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<session, echo=F>>=
\end_layout

\begin_layout Plain Layout

sessionInfo()
\end_layout

\begin_layout Plain Layout

if(!is.null(warnings())){
\end_layout

\begin_layout Plain Layout

    print("Warnings:")
\end_layout

\begin_layout Plain Layout

    warnings()}
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<opts20, include=F>>=
\end_layout

\begin_layout Plain Layout

## Don't delete this.
 It puts the interactive session options
\end_layout

\begin_layout Plain Layout

## back the way they were.
 If this is compiled within a session
\end_layout

\begin_layout Plain Layout

## it is vital to do this.
\end_layout

\begin_layout Plain Layout

options(opts.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_body
\end_document
