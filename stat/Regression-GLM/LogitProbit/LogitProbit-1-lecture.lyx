#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble
\usepackage{dcolumn}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{graphicx}
%\newcommand\makebeamertitle{\frame{\maketitle}}%
\renewcommand{\doiprefix}{doi:\kern-1pt}
\setlength{\bibsep}{10pt}

% use 'handout' to produce handouts
%\documentclass[handout]{beamer}
\usepackage{wasysym}
\usepackage{pgfpages}
%for bold upright roman in math for matrix algebra
\newcommand{\vn}[1]{\mbox{{\it #1}}}\newcommand{\vb}{\vspace{\baselineskip}}\newcommand{\vh}{\vspace{.5\baselineskip}}\newcommand{\vf}{\vspace{\fill}}\newcommand{\splus}{\textsf{S-PLUS}}\newcommand{\R}{\textsf{R}}


%%paste in guidePreambleSweavel.tex
%%% From beamer slide:
\usepackage{Sweave}
%% 
%% This controls display of code chunks
\usepackage{ae,fancyvrb,relsize,listings}

\providecommand{\Sweavesize}{\normalsize}
\providecommand{\Rsize}{}
\renewcommand{\Rsize}{\normalsize}
\providecommand{\Routsize}{\scriptsize}

\providecommand{\Rcolor}{\color[rgb]{0.1, 0.1, 0.1}}
\providecommand{\Routcolor}{\color[rgb]{0.2, 0.2, 0.2}}
\providecommand{\Rcommentcolor}{\color[rgb]{0.101, 0.43, 0.432}}

\providecommand{\Rbackground}{\color[gray]{0.91}}
\providecommand{\Routbackground}{\color[gray]{0.935}}
% Can specify \color[gray]{1} for white background or just \color{white}

\lstdefinestyle{Rinput}{
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  basicstyle=\Rsize\Rcolor\ttfamily,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%,
  commentstyle=\Rcommentcolor\ttfamily,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1{==}{{=\,=}}2{--}{{-\,-}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},%
  backgroundcolor=\Rbackground,%
  numbers=left,%
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}%

% Other options of interest:
% frame=single,framerule=0.1pt,framesep=1pt,rulecolor=\color{blue},
% numbers=left,numberstyle=\tiny,stepnumber=1,numbersep=7pt,
% keywordstyle={\bf\Rcolor}

\lstdefinestyle{Routput}{fancyvrb=false,
  literate={~}{{$\sim$}}1{R^2}{{$R^{2}$}}2{^}{{$^{\scriptstyle\wedge}$}}1{R-squared}{{$R^{2}$}}2,%
  basicstyle=\Routcolor\Routsize\ttfamily,%
  backgroundcolor=\Routbackground,
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1 {==}{{=\,=}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},
  numbers=left,
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}

\renewenvironment{Schunk}{}{}
\renewenvironment{Sinput}{}{}
\let\Sinput\relax
\let\Scode\relax
\let\Soutput\relax
\lstnewenvironment{Sinput}{\lstset{style=Rinput}}{}
\lstnewenvironment{Scode}{\lstset{style=Rinput}}{}
\lstnewenvironment{Soutput}{\lstset{style=Routput}}{}

\lstset{tabsize=2, breaklines=true, style=Rinput, breakatwhitespace=true}

\fvset{listparameters={\setlength{\topsep}{0em}}}

\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.90}
\usepackage{realboxes}
\providecommand*{\code}[1]{\texttt{#1}}
\renewcommand{\code}[1]{%
\Colorbox{light-gray}{#1}%
}%
%%end paste in guidePreambleSweavel.tex

\usepackage[natbibapa]{apacite}

\definecolor{darkblue}{HTML}{1e2277}

%would be in beamerthemekucrmda%
\mode<presentation>
\definecolor{kublue}{RGB}{0,81,186}
\usefonttheme{professionalfonts}
\useoutertheme{infolines}
\useinnertheme{rounded}
%disable rounded for alert and example boxes%
\setbeamertemplate{blocks}[default]
\usecolortheme{whale}
\usecolortheme{orchid}
\setbeamercolor{structure}{bg=kublue,fg=kublue!90!black}
%\setbeamercolor{structure}{fg=kublue}
\setbeamercolor{frametitle}{bg=kublue}
\setbeamercolor{section in toc}{fg=kublue!40!black}

\setbeamertemplate{frametitle continuation}[from second]
\renewcommand\insertcontinuationtext{...}
\beamertemplatenavigationsymbolsempty
%end of beamerthemekucrmda%

%If you want bigger margins, try this:
\setbeamersize{text margin left=05mm,text margin right=10mm} 
\hypersetup{colorlinks,allcolors=.,urlcolor=darkblue}
%Following seems to have no effect now
%\usepackage{handoutWithNotes}
%\pgfpagesuselayout{3 on 1 with notes}[letterpaper, border shrink=5mm]

\titlegraphic{\includegraphics[width=6cm]{theme/logo}}
\end_preamble
\options aspectratio=1609
\use_default_options false
\begin_modules
logicalmkup
sweave
natbibapa
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref false
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\branch R
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch semboot
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\branch cfalvm
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Branch R
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% tmpout directory must exist first
\end_layout

\begin_layout Plain Layout

<<tmpout, echo=FALSE, include=FALSE, results=hide>>=
\end_layout

\begin_layout Plain Layout

if(!dir.exists("tmpout")) dir.create("tmpout", showWarnings=FALSE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=tmpout/t,split=T,ae=F,height=4.5,width=7,concordance=FALS
E}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Roptions, echo=F>>=
\end_layout

\begin_layout Plain Layout

opts.orig <- options()
\end_layout

\begin_layout Plain Layout

options(width=100, prompt = " ", continue = "  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE)
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

par.orig <- par(no.readonly = TRUE) 
\end_layout

\begin_layout Plain Layout

pjmar <- c(4.1, 4.1, 1.5, 2.1)
\end_layout

\begin_layout Plain Layout

par(mar=pjmar, ps=11)
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(mar=pjmar, ps=12, xpd=F)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=F,family="Times",pointsize=12)
\end_layout

\begin_layout Plain Layout

if(!file.exists("tmpout")) dir.create("tmpout", showWarnings=F)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\end_inset


\end_layout

\begin_layout Title
Regression with binary outputs
\begin_inset Argument 1
status open

\begin_layout Plain Layout
logit
\end_layout

\end_inset


\end_layout

\begin_layout Subtitle
Logit and Probit
\end_layout

\begin_layout Author
Paul Johnson
\begin_inset Flex InstituteMark
status open

\begin_layout Plain Layout
1
\end_layout

\end_inset


\end_layout

\begin_layout Institute
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
1
\end_layout

\end_inset

CRMDA, University of Kansas 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
CRMDA
\end_layout

\end_inset


\end_layout

\begin_layout Date
2020
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
logo{
\backslash
includegraphics[width=5mm]{theme/logomini}}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
The following causes the table of contents to be shown at the beginning
 of every subsection.
 Delete this, if you do not want it.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
mode<presentation>{
\end_layout

\begin_layout Plain Layout


\backslash
AtBeginSection[] 
\end_layout

\begin_layout Plain Layout

   { 
\end_layout

\begin_layout Plain Layout

    
\backslash
begin{frame}[allowframebreaks]{Outline} 
\end_layout

\begin_layout Plain Layout

    
\backslash
tableofcontents[currentsection] 
\end_layout

\begin_layout Plain Layout

    
\backslash
end{frame} 
\end_layout

\begin_layout Plain Layout

   } 
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Outline}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%following is LyX shortcut 
\backslash
vb for bold upright math for matrices
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\vb}[1]{\bm{\mathrm{#1}}}
\end_inset


\end_layout

\begin_layout Section*
Introduction
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Overview}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Dependent variable is categorical.
 
\end_layout

\begin_deeper
\begin_layout Itemize
For discussion, we refer to 
\begin_inset Formula $Y_{i}\in\{0,1\}$
\end_inset


\end_layout

\begin_layout Itemize
But the numbers have no substantive meaning.
 They are just labels, could write 
\begin_inset Formula ${No,Yes}$
\end_inset

 or 
\begin_inset Formula ${Fail,Pass}$
\end_inset


\end_layout

\begin_layout Itemize
Temptation to treat the labels 
\begin_inset Formula $\{0,1\}$
\end_inset

 as numbers
\end_layout

\end_deeper
\begin_layout Itemize
Estimated by Maximum Likelihood
\end_layout

\begin_deeper
\begin_layout Description
ML idea: Choose estimates to make the observed outcomes most likely
\end_layout

\begin_layout Itemize
proposed by Ronald Fisher 1905-1922
\end_layout

\end_deeper
\begin_layout Itemize
Alternative models we consider–logit and probit–are members of the 
\begin_inset Quotes eld
\end_inset

family
\begin_inset Quotes erd
\end_inset

 of models in the Generalized Linear Model 
\begin_inset CommandInset citation
LatexCommand citep
key "mccullagh_nelder_1989"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Terminology
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Terminology}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
This is a terminology section, possibly a refresher
\end_layout

\begin_layout Itemize
We need to be comfortable with 
\begin_inset Formula $\mathrm{log}$
\end_inset

, 
\begin_inset Formula $\mathrm{exp}$
\end_inset

, PDF and CDF in order to make progress in what follows
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Terminology: log and exp
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{log}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\mathrm{log}_{b}(x)$
\end_inset

 answers question 
\begin_inset Quotes eld
\end_inset

to what power must 
\begin_inset Formula $b$
\end_inset

 be raised in order to equal 
\begin_inset Formula $x$
\end_inset

?
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
Facts
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathrm{log_{b}}(1)=0$
\end_inset

, no matter what 
\begin_inset Formula $b$
\end_inset

 is
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathrm{log}_{b}(x)$
\end_inset

 is undefined if 
\begin_inset Formula $x\leq0$
\end_inset

 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $e$
\end_inset

 is Euler's constant.
 It is the most widely used value of 
\begin_inset Formula $b$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Enumerate
the slope of 
\begin_inset Formula $\mathrm{log}_{e}(x)$
\end_inset

 has slope 
\begin_inset Formula $1/x$
\end_inset


\end_layout

\begin_layout Enumerate
called the 
\begin_inset Quotes eld
\end_inset

natural log
\begin_inset Quotes erd
\end_inset

, often written 
\begin_inset Formula $\mathrm{ln}(x)$
\end_inset


\end_layout

\begin_layout Enumerate
if I omit 
\begin_inset Formula $b$
\end_inset

, assume it is 
\begin_inset Formula $e$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Handy facts: 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathrm{log}(x/y)=\mathrm{log}(x)-\mathrm{log}(y)$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathrm{log}(x\cdot y)=\mathrm{log}(x)+\mathrm{log}(y)$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathrm{log}(x^{k})=k\cdot\mathrm{log}(x)$
\end_inset


\end_layout

\end_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logplot, fig=T,include=F,echo=F,results=hide, height=4, width=4>>=
\end_layout

\begin_layout Plain Layout

x <- seq(0.001, 10, length=10000)
\end_layout

\begin_layout Plain Layout

xlog <- log(x)
\end_layout

\begin_layout Plain Layout

plot(x, xlog, type = "l", ylab="natural log of x", main = "logarithm")
\end_layout

\begin_layout Plain Layout

abline(h=0, type = 4, col="gray70")
\end_layout

\begin_layout Plain Layout

abline(v=1, type = 4, col="gray70")
\end_layout

\begin_layout Plain Layout

mtext("1", 1, at = 1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{tmpout/t-logplot}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout ColumnsTopAligned

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{exponential function}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\mathrm{exp(x)}$
\end_inset

 means 
\begin_inset Formula $e^{x}$
\end_inset

.
 Why 
\begin_inset Formula $\text{exp}(x)$
\end_inset

? Typesetters prefer to avoid superscripts.
\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
Handy facts:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathrm{exp}(x)$
\end_inset

 is
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathrm{exp}(0)=1$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathrm{exp}(x)>0$
\end_inset

, its always positive, 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathrm{exp}(x+y)=\mathrm{exp}(x)*\mathrm{exp}(y)$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathrm{exp}(-x)=\frac{1}{\mathrm{exp}(x)}$
\end_inset

 
\end_layout

\begin_deeper
\begin_layout Enumerate
general fact about exponents: 
\begin_inset Formula $x^{-k}=\frac{1}{x^{k}}$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathrm{exp}$
\end_inset

 and 
\begin_inset Formula $\mathrm{log}$
\end_inset

 are inverses of each other
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $x=\mathrm{exp}(\mathrm{log}(x))$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $x=\mathrm{log}(\mathrm{exp}(x))$
\end_inset


\end_layout

\end_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<expplot, fig=T,include=F,echo=F,results=hide, height=4, width=4>>=
\end_layout

\begin_layout Plain Layout

x <- seq(-4, 4, length=10000)
\end_layout

\begin_layout Plain Layout

xexp <- exp(x)
\end_layout

\begin_layout Plain Layout

xmexp <- exp(-x)
\end_layout

\begin_layout Plain Layout

plot(x, xexp, type = "l", ylab="y", main = "exponential of x and -x")
\end_layout

\begin_layout Plain Layout

lines(x, xmexp, lty = 2, col = "gray60")
\end_layout

\begin_layout Plain Layout

lines(x = c(0,0), y = c(0, 40), lty = 3, col="gray70")
\end_layout

\begin_layout Plain Layout

legend("top", legend = c("exp(x)", "exp(-x)"), lty = c(1, 2), col = c(1,
 "gray40"))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{tmpout/t-expplot}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard

\series bold
Vital: 
\series default
b/c 
\begin_inset Formula $\mathrm{exp}$
\end_inset

 is always positive and exists for all 
\begin_inset Formula $+/-$
\end_inset

 inputs, it is often used to transform input into a positive value.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Terminology: CDF Primer
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{A Probability Density Function (PDF)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf10, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon), ylab="Probab
ility Density", main="") 
\end_layout

\begin_layout Plain Layout

##legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

##                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Single peaked, symmetric probability density")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The random variable 
\begin_inset Formula $\varepsilon\in(-\infty,\infty)$
\end_inset

 has PDF 
\begin_inset Formula $f(\varepsilon)$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Example: The Logistic Distribution}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf20, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- -1.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(-1.3, 0.025, pos = 4, "Above 'cut point' of -1.5")
\end_layout

\begin_layout Plain Layout

text(-2.4, 0.075, pos = 2, "Below 'cut point'")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{tmpout/t-logpdf20}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Can calculate area under curve after setting dividing point
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Use the areas to represent chance $y=0$ or $y=1$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf30, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon), ylab="Probab
ility Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- -1.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(-1, 0.025, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

text(-2.4, 0.075, pos = 2, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf30}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Increase the cut point, change the probabilities}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf40, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- 0.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(1, 0.025, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

text(-1.25, 0.025, pos = 2, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf40}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Increase the cut point}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf50, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- 2
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(2.05, 0.015, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

text(-1.5, 0.015, pos = 2, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf50}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Easy to swap 0 and 1 }
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf55, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- -2
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(xcut + 0.5, 0.015, pos = 4, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

text(xcut-1, 0.05, pos = 2, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8.5cm]{tmpout/t-logpdf55}
\end_layout

\end_inset


\end_layout

\begin_layout Column
4cm
\end_layout

\begin_layout Itemize
The PDF of 
\begin_inset Formula $\varepsilon$
\end_inset

 is symmetric, can swap the sides in the graph
\end_layout

\begin_deeper
\begin_layout Itemize
i.e., change divider from 2 to -2, then area below becomes area above.
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The area on the left is Cumulative Probability}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
About the dividing point.
 Lets don't worry too much about notation, just call it 
\begin_inset Formula $\tau$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

tau
\begin_inset Quotes erd
\end_inset

).
\end_layout

\begin_layout Itemize
Nature's data generating process to create 
\begin_inset Formula $y_{i}\in\{0,1\}$
\end_inset

 (our statistical model!)
\end_layout

\begin_deeper
\begin_layout Itemize
Draw a random 
\begin_inset Formula $\varepsilon$
\end_inset

, then let 
\begin_inset Formula $\varepsilon\leq\tau$
\end_inset

 decide if 
\begin_inset Formula $y_{i}$
\end_inset

 as 
\begin_inset Quotes eld
\end_inset

low
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

high
\begin_inset Quotes erd
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
The 
\series bold
Cumulative Distribution Function
\series default
 is customary term for that area.
\end_layout

\begin_deeper
\begin_layout Itemize
CDF is the chance of an outcome smaller than 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\begin_layout Itemize
Customary also to refer to it by the capital letter 
\begin_inset Formula $F(\tau)$
\end_inset

 if the PDF was 
\begin_inset Formula $f(\varepsilon)$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Mathematically, the probability that 
\begin_inset Formula $y=0$
\end_inset

 is an integral
\begin_inset Formula 
\[
F(\tau)=\int_{-\infty}^{\tau}f(\varepsilon)d\varepsilon
\]

\end_inset


\end_layout

\begin_layout Itemize
Mathematically, the probability that 
\begin_inset Formula $y=1$
\end_inset

 is area on the high side.
 
\begin_inset Formula 
\[
1-F(\tau)=\int_{\tau}^{\infty}f(\varepsilon)d\varepsilon
\]

\end_inset


\end_layout

\begin_layout Itemize
This is confusing, I know, but for a dividing point 
\begin_inset Formula $k$
\end_inset

.
\begin_inset Formula 
\begin{equation}
1-F(-k)=F(k)\label{eq:1-F(-k)=F(k)}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Because software programs differ in the 
\begin_inset Quotes eld
\end_inset

choice of sides
\begin_inset Quotes erd
\end_inset

 for 
\begin_inset Formula $y_{i}=0$
\end_inset

, we see different signs reported for regression models (SAS is opposite
 of Stata, for example)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Clearly, 
\end_layout

\begin_deeper
\begin_layout Itemize
if 
\begin_inset Formula $\tau\rightarrow-\infty$
\end_inset

, then 
\begin_inset Formula $F(\tau)\rightarrow0$
\end_inset


\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\tau\rightarrow\infty,$
\end_inset

 then 
\begin_inset Formula $F(\tau)\rightarrow1$
\end_inset


\end_layout

\begin_layout Itemize
Between those extremes, the graph of the CDF is 
\end_layout

\begin_deeper
\begin_layout Itemize
always increasing (or flat, but we usually have increasing)
\end_layout

\begin_layout Itemize
S-shaped
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Compare PDF and CDF}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf60, fig=T, include=F, width=8, height=3.5>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]),
\end_layout

\begin_layout Plain Layout

      ylab="Probability Density", main="") 
\end_layout

\begin_layout Plain Layout

xcut <- 2
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(2.05, 0.015, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

plogisatxcut <- plogis(xcut, 0, 1, log=FALSE)
\end_layout

\begin_layout Plain Layout

text(2, 0.015, pos = 2, paste("Pr(y = 0) = ", formatC(plogisatxcut)))
\end_layout

\begin_layout Plain Layout

mtext(expression(tau), 1, at = xcut)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf70, fig=T, include=F, width=8, height=3>>=
\end_layout

\begin_layout Plain Layout

par.orig <- par(no.readonly=TRUE)
\end_layout

\begin_layout Plain Layout

par(mar = c(4.1, 4.1, 2.1, 2.1))
\end_layout

\begin_layout Plain Layout

cumlogis <- plogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, cumlogis, type="l", ylim=c(0,1), xlab=expression(tau),
\end_layout

\begin_layout Plain Layout

      ylab="Cumulative Probability", main="") 
\end_layout

\begin_layout Plain Layout

abline(v=xcut, lty = 4, col = "gray80")
\end_layout

\begin_layout Plain Layout

par(par.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-logpdf60}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-logpdf70}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Looking Forward}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Will build a predictive model that sets the dividing line each case.
 
\end_layout

\begin_layout Itemize
All Logistic programs will give technically consistent results, but may
 have different signs on 
\begin_inset Formula $\beta$
\end_inset

 because there is 
\begin_inset Quotes eld
\end_inset

artistic license
\begin_inset Quotes erd
\end_inset

 in putting 
\begin_inset Formula $y=0$
\end_inset

 or 
\begin_inset Formula $y=1$
\end_inset

 on the left side of the graph.
\end_layout

\begin_layout Itemize

\emph on
I'm getting it wrong on a regular basis, so you are not alone.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Terminology: Linear Predictor 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Linear Predictor}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Linear Predictor
\series default
 is the right hand side of a regression, 
\emph on
BUT
\emph default
 with no error term
\begin_inset Formula 
\begin{equation}
\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Shorthand 
\begin_inset Formula $X_{i}\beta$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $X_{i}$
\end_inset

 is a 
\begin_inset Quotes eld
\end_inset

row
\begin_inset Quotes erd
\end_inset

 of predictor values, usually with 
\begin_inset Formula $1$
\end_inset

 in the first position
\end_layout

\begin_layout Itemize
\begin_inset Formula $\beta$
\end_inset

 is a column vector of coefficients
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
[1,x1_{i},x2_{i},x3_{i}]\left[\begin{array}{c}
\beta_{0}\\
\beta_{1}\\
\beta_{2}\\
\beta_{3}
\end{array}\right]=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
That's called an 
\begin_inset Quotes eld
\end_inset


\series bold
inner product
\series default

\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset


\series bold
dot product
\series default

\begin_inset Quotes erd
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
An OLS regression
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+\varepsilon_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
would be
\begin_inset Formula 
\[
y_{i}=X_{i}\beta+\varepsilon_{i}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Often use the Greek 
\begin_inset Formula $\eta_{i}$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

eta
\begin_inset Quotes erd
\end_inset

) for the linear predictor, so
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
y_{i}=\eta_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
The expected value of 
\begin_inset Formula $y_{i}$
\end_inset

 in ordinary regression equals the linear predictor
\begin_inset Formula 
\begin{align*}
E[y_{i}|X_{i}] & =E[\eta_{i}+\varepsilon_{i}]\\
 & =E[\eta_{i}]+E[\varepsilon_{i}]\\
 & =\eta_{i}+0=X_{i}\beta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Itemize
Matrix notation (transpose nonsense)
\end_layout

\begin_deeper
\begin_layout Itemize
Sometimes notation enforces the 
\begin_inset Quotes eld
\end_inset

all vectors are columns rule
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
Thus it is necessary to say 
\begin_inset Formula $X_{i}$
\end_inset

 is a column:
\end_layout

\begin_deeper
\begin_layout Plain Layout
\begin_inset Formula 
\[
X_{i}=\left[\begin{array}{c}
1\\
x1_{i}\\
x2_{i}\\
x3_{i}
\end{array}\right]
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
A 
\series bold
transpose
\series default
 is same thing on its side
\begin_inset Formula 
\[
X_{i}^{T}=[1,x1_{i},x2_{i},x3_{i}]
\]

\end_inset


\end_layout

\begin_deeper
\begin_layout Plain Layout
So others might write 
\begin_inset Formula $X_{i}^{T}\beta$
\end_inset


\end_layout

\end_deeper
\end_deeper
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Terminology: Generalized Linear Model
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{GLM}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
McCullagh & Nelder (
\begin_inset CommandInset citation
LatexCommand citeyear
key "mccullagh_nelder_1989"
literal "true"

\end_inset

) worked out a framework called generalized linear models (GLM)
\end_layout

\begin_layout Itemize
The Logit & Probit models are examples
\end_layout

\begin_layout Itemize
There are 2 twists on the usual regression that we need to watch for.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Generalized Linear Model, step 1}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Rewrite OLS in this way.
 
\end_layout

\begin_layout Itemize
Regression
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
y_{i}=X_{i}\beta+\varepsilon_{i},\,\,\varepsilon_{i}\sim N(0,\sigma_{\varepsilon}^{2})
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Because error is Normal, and 
\begin_inset Formula $E[\varepsilon_{i}]=0,$
\end_inset

 the conditional distribution of 
\begin_inset Formula $y_{i}$
\end_inset

 is normal with mean 
\begin_inset Formula $\eta_{i}$
\end_inset

 and variance 
\begin_inset Formula $\sigma_{\varepsilon}^{2}$
\end_inset

: 
\begin_inset Formula 
\[
y_{i}\sim N(\eta_{i},\sigma_{\varepsilon}^{2})
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Generalization step 1
\series default
: Put other distributions in place of the Normal.
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $y_{i}\sim SomeOtherDistribution(\eta_{i})\,\,\{\mathrm{may\,have\,more\,parameters}\}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
In the categorical model, we will use a Binomial distribution, a random
 draw from {0,1}.
\end_layout

\begin_layout Itemize
Clarify Binomial versus Bernoulli
\end_layout

\begin_deeper
\begin_layout Itemize
Binomial answers 
\begin_inset Quotes eld
\end_inset

how many positives out of X draws with probability 
\begin_inset Formula $p_{i}$
\end_inset


\begin_inset Quotes erd
\end_inset

, 
\begin_inset Formula $Bin(X,p_{i})$
\end_inset


\end_layout

\begin_layout Itemize
Bernoulli is 
\begin_inset Quotes eld
\end_inset

take 1 draw with probability 
\begin_inset Formula $p_{i}$
\end_inset


\begin_inset Quotes erd
\end_inset

, give back 0 or 1
\end_layout

\begin_layout Itemize
Binomial with 
\begin_inset Formula $X=1$
\end_inset

 is same as Bernoulli.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Generalized Linear Model, step 2}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Transform 
\begin_inset Formula $\eta_{i}$
\end_inset

 before putting it into the probability distribution.
 
\end_layout

\begin_layout Itemize
We'll demonstrate it with the 
\begin_inset Quotes eld
\end_inset

S-shaped
\begin_inset Quotes erd
\end_inset

 curve below
\end_layout

\begin_layout Itemize
Choice of transform is often for practical/computational reasons, but we
 wish there were substantive reasons.
\end_layout

\begin_deeper
\begin_layout Itemize
example, suppose a probability distribution requires positive input for
 a mean parameter.
 
\end_layout

\begin_layout Itemize
Because 
\begin_inset Formula $X_{i}\beta$
\end_inset

 can be negative, we are often told to transform that as 
\begin_inset Formula $\mathrm{exp}(X_{i}\beta)$
\end_inset


\end_layout

\begin_layout Itemize
Exponentiating creates positive values, but can we tell a meaningful story
 to justify that decision?
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Using OLS With Categorical DV
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{OLS versus Logit}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Ordinary Least Squares is popular
\end_layout

\begin_deeper
\begin_layout Itemize
researchers frequently treated the {0,1} data as numbers
\end_layout

\end_deeper
\begin_layout Itemize
Logit (or other 
\begin_inset Quotes eld
\end_inset

categorical regression models
\begin_inset Quotes erd
\end_inset

) grew rapidly in popularity in the late 1970s.
\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

big data
\begin_inset Quotes erd
\end_inset

 (
\begin_inset Quotes eld
\end_inset

data mining
\begin_inset Quotes erd
\end_inset

) field has put new life into the linear model, mainly because it is easy
 to calculate and most often results are similar to other, more elaborate
 models
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The Boundary Problem
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{$y_i$ is dichotomous}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Suppose 
\begin_inset Formula $y_{i}$
\end_inset

 is coded 0 and 1, representing answers to a Yes or No question.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

set.seed(44444)
\end_layout

\begin_layout Plain Layout

x <- 25:75
\end_layout

\begin_layout Plain Layout

p= 1/(1+exp(2-0.05*x))
\end_layout

\begin_layout Plain Layout

y <- rbinom(length(x), size=1, prob=p)
\end_layout

\begin_layout Plain Layout

dat1 <- data.frame(x = x, y = y)
\end_layout

\begin_layout Plain Layout

dat1 <- dat1[order(dat1$x, y), ]
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<a, echo=F, fig=T,include=F>>=
\end_layout

\begin_layout Plain Layout

plot(x, y, ylim=c(-.2,1.2), xlab="One Predictor X", ylab="dichotomous output",
 type="n")
\end_layout

\begin_layout Plain Layout

points(x,y,pch=16,cex=0.85)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-a}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Fit OLS: interpret the line}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<b,fig=T, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

m1 <- lm(y~x, data = dat1)
\end_layout

\begin_layout Plain Layout

plot(y~x, dat1, xlab="One Predictor X", ylab="dichotomous output")
\end_layout

\begin_layout Plain Layout

abline(m1)
\end_layout

\begin_layout Plain Layout

text(60, 0.5, expression(hat(y[i])==hat(beta)[0] + hat(beta)[1]*X[i]))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-b}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

x2 <- seq(0,150,length=200)
\end_layout

\begin_layout Plain Layout

expbx2 <- exp((-1)*(-10+.145*x2))
\end_layout

\begin_layout Plain Layout

ProbY1 <- 1/(1+expbx2)
\end_layout

\begin_layout Plain Layout

y2 <- rbinom(n=200, size=1, prob=ProbY1)
\end_layout

\begin_layout Plain Layout

dat2 <- data.frame(x2 = x2, y2 = y2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

modl2 <- lm(y2~x2, data = dat2)
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<c, fig=TRUE, echo=FALSE, include=F>>=
\end_layout

\begin_layout Plain Layout

plot(y2 ~ x2, dat2, ylim=c(-0.3,1.5),type="n", xlab="One Predictor X",
\end_layout

\begin_layout Plain Layout

       ylab="dichotomous output")
\end_layout

\begin_layout Plain Layout

points(x2, y2,cex=1)
\end_layout

\begin_layout Plain Layout

abline(modl2);
\end_layout

\begin_layout Plain Layout

lines(c(0,150),c(0,0),lty=c(2)); lines(c(0,150),c(1,1),lty=c(2))
\end_layout

\begin_layout Plain Layout

text(100, 0.5, expression(hat(y[i])==hat(beta)[0] + hat(beta)[1]*X[i]))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Problem: OLS predicts out of range}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
A straight line will eventually go above 1 and below 0.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{tmpout/t-c}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
That means 
\begin_inset Formula $\hat{y}$
\end_inset

 can't represent probabilities? (I'm asking, not telling)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Might try 'truncation' of the predicted values}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset ERT
status open

\begin_layout Plain Layout

<<olskink, fig=F, echo=F, include=F>>=
\end_layout

\begin_layout Plain Layout

plot(x2, y2, ylim=c(-0.3,1.5),type="n", xlab="One Predictor X", ylab="dichotomous
 output")
\end_layout

\begin_layout Plain Layout

points(x2,y2,cex=0.8, col="gray70")
\end_layout

\begin_layout Plain Layout

lines(c(0,150),c(0,0),lty=c(2), col="gray60") 
\end_layout

\begin_layout Plain Layout

lines(c(0,150),c(1,1),lty=c(2), col="gray60")
\end_layout

\begin_layout Plain Layout

eta <- coef(modl2)[1] + coef(modl2)[2] * x2
\end_layout

\begin_layout Plain Layout

etakink <- ifelse(eta < 0, 0, ifelse(eta > 1, 1, eta)) 
\end_layout

\begin_layout Plain Layout

lines(x2, etakink)
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To prevent the OLS model from going out of bounds, one approach is to insert
 
\begin_inset Quotes eld
\end_inset

kinks
\begin_inset Quotes erd
\end_inset

 in the fitted line.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-olskink}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
But I've never seen anybody carry through on that in a serious way.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Shortcomings
\end_layout

\begin_layout Enumerate
Theoretically unappealing.
 Effect of 
\begin_inset Formula $X$
\end_inset

 is 0, then 
\begin_inset Formula $\beta_{1}$
\end_inset

, then 0 again? Really?
\end_layout

\begin_layout Enumerate
Difficult to interpret 
\begin_inset Formula $\hat{y}_{i}=0$
\end_inset

.
 Something is actually impossible? 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\hat{y}_{i}=1$
\end_inset

? Something is certain to happen.
 Suppose observed 
\begin_inset Formula $y_{i}=0.$
\end_inset

 Does that mean whole model is 
\begin_inset Quotes eld
\end_inset

impossible
\begin_inset Quotes erd
\end_inset

?
\end_layout

\begin_layout Enumerate
How to estimate the 
\begin_inset Quotes eld
\end_inset

kink
\begin_inset Quotes erd
\end_inset

 points coherently?
\end_layout

\begin_layout Standard
Maybe data is such that predictions will stay in bounds.
 Whew.
 Lucky!
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Error is not normally distributed
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Linear Probability Model}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Linear probability model says
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
y_{i}=X_{i}\beta+\varepsilon_{i}\label{ols1}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
The predicted value 
\begin_inset Formula $\hat{y}_{i}=X_{i}\hat{\beta}$
\end_inset

 is interpreted as a probability estimate
\end_layout

\begin_layout Itemize
Problem: The error term 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 can't be normally distributed.
 (Explain next slide)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Error term must be one of 2 values for any particular observation}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<lpmpred, fig=T, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

m1 <- lm(y~x, data = dat1)
\end_layout

\begin_layout Plain Layout

plot(x,y, xlab="One Predictor X", ylab="dichotomous output")
\end_layout

\begin_layout Plain Layout

dat1$yhat <- predict(m1)
\end_layout

\begin_layout Plain Layout

abline(m1)
\end_layout

\begin_layout Plain Layout

text(70, 0.5, expression(hat(y)==hat(beta)[0] + hat(beta)[1]*X))
\end_layout

\begin_layout Plain Layout

K <- 10 # the chosen case
\end_layout

\begin_layout Plain Layout

arrows(dat1[K, "x"], 0.05 + dat1[K, "yhat"], dat1[K, "x"], .95, length = 0.1)
 
\end_layout

\begin_layout Plain Layout

arrows(dat1[K, "x"], -0.05 + dat1[K, "yhat"], dat1[K, "x"], 0.05, length =
 0.1)
\end_layout

\begin_layout Plain Layout

text( dat1[K, "x"], 0.1 + dat1[K, "yhat"], 
\end_layout

\begin_layout Plain Layout

                  expression(e[up]==1-X[i]*hat(beta)), pos = 4)
\end_layout

\begin_layout Plain Layout

text(dat1[K, "x"], -0.2 + dat1[K, "yhat"], 
\end_layout

\begin_layout Plain Layout

                  expression(e[down]==-X[i]*hat(beta)), pos = 4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Itemize
error term is defined as difference between 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $X_{i}\beta$
\end_inset

, and
\end_layout

\begin_layout Itemize
the observed value, 1 or 0.
\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 must be either
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $1-X_{i}\beta$
\end_inset

 if 
\begin_inset Formula $y_{i}=1$
\end_inset

, or
\end_layout

\begin_layout Itemize
\begin_inset Formula $-X_{i}\beta$
\end_inset

 if 
\begin_inset Formula $y_{i}=0$
\end_inset


\end_layout

\end_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{tmpout/t-lpmpred}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Itemize
Repeat, error term can have only 2 values.
 It goes Up (
\begin_inset Formula $1-X_{i}\beta)$
\end_inset

 or Down (
\begin_inset Formula $-X_{i}\beta$
\end_inset

).
 
\end_layout

\begin_layout Itemize
That can't be Normal!
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Heteroskedasticity
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{You insist that $E[
\backslash
varepsilon_i]=0$, then find $Var(
\backslash
varepsilon)$}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $P_{i}$
\end_inset

 be the probability of a 1 for case 
\begin_inset Formula $i$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
Then probability that 
\begin_inset Formula $y_{i}=0$
\end_inset

 is 
\begin_inset Formula $(1-P_{i})$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
The expected value of error term:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
E[\varepsilon_{i}] & = & P_{i}(1-P_{i})+(1-P_{i})(-P_{i})\nonumber \\
 & = & P_{i}-P_{i}^{2}-P_{i}+P_{i}^{2}=0
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
Recall, 
\begin_inset Formula $E[]$
\end_inset

 is sum of probabilities times outcomes.
 
\end_layout

\begin_deeper
\begin_layout Itemize
The probabilities are 
\begin_inset Formula $P_{i}$
\end_inset

 and 
\begin_inset Formula $(1-P_{i})$
\end_inset

.
\end_layout

\begin_layout Itemize
The outcomes are 
\begin_inset Formula $(1-P_{i})$
\end_inset

 and 
\begin_inset Formula $(-P_{i})$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{That Implies Heteroskedasticity}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Heteroskedasticity is not fatal, we'd need to do 
\begin_inset Quotes eld
\end_inset

weighted least squares
\begin_inset Quotes erd
\end_inset

 to address it.
 But only would bother if I could convince myself he 
\begin_inset Quotes eld
\end_inset

mean model
\begin_inset Quotes erd
\end_inset

 is reasonable
\end_layout

\begin_layout Itemize
The variance of the error term is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
Var(\varepsilon_{i})=E([\varepsilon_{i}-E[\varepsilon_{i}])^{2}]\\
=E[\varepsilon_{i}^{2}]\,\,\{\mathrm{because\,E[\varepsilon_{i}]=0}\}\\
=P_{i}(1-P_{i})^{2}+(1-P_{i})(-P_{i})^{2}\\
=P_{i}(1-P_{i})
\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
The error variance is biggest when 
\begin_inset Formula $P_{i}=0.5,$
\end_inset

 smaller (tending toward 0) as 
\begin_inset Formula $P_{i}\rightarrow0$
\end_inset

 or 
\begin_inset Formula $P_{i}\rightarrow1$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Weighted Least Squares might be used, parameter estimates will have lower
 variance and the standard errors more accurate.
\end_layout

\begin_deeper
\begin_layout Itemize
Assumes we believe the linear model for probabilities
\end_layout

\begin_layout Itemize
We ignore the boundary problem.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
S-Shaped Curves
\begin_inset CommandInset label
LatexCommand label
name "sec:logit1"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Smooth Curve for Probability}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Theory: probability that 
\begin_inset Formula $y_{i}=1$
\end_inset

 changes 
\begin_inset Quotes eld
\end_inset

smoothly
\begin_inset Quotes erd
\end_inset

 in response to changes in 
\begin_inset Formula $X_{i}\beta$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Monotonic relationship implies an S-shaped curve.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s1_1, include=F, fig=TRUE,height=4,width=6, echo=F>>=
\end_layout

\begin_layout Plain Layout

xrange <- seq(50, 150, length = 200)
\end_layout

\begin_layout Plain Layout

beta0 <- -10
\end_layout

\begin_layout Plain Layout

beta1 <- .1
\end_layout

\begin_layout Plain Layout

pry <- function(x, k0, k1){
\end_layout

\begin_layout Plain Layout

   exp(k0 + k1 * x)/(1 + exp(k0 + k1 * x))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

ProbY1 <- pry(xrange, beta0, beta1)
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l", xlab=expression(X*beta), ylab='Probability(y=1)')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s1_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The True Probability for each value of $X_i
\backslash
beta$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s3_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

x <- sort(rnorm(20, m = 100, s = 20))
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l", xlab=expression(X*beta), 
\end_layout

\begin_layout Plain Layout

       ylab='Probability(y=1)',  col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr, lwd = 2)
\end_layout

\begin_layout Plain Layout

title("The 
\backslash
"true
\backslash
" Probabilty that y = 1")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s3_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

true probabilities
\begin_inset Quotes erd
\end_inset

 are not observed.
 We see 0 or 1 for each case.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Observed 0's and 1's: Downs and Ups}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s4_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab=expression(X*beta),
\end_layout

\begin_layout Plain Layout

        ylab='Probability(y=1)',  col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr)
\end_layout

\begin_layout Plain Layout

arrows(x[10], 0.05 + ypr[10], x[10], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x[10], -0.05 + ypr[10], x[10], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

text(x[10], ypr[10]+ 0.5*(1 - ypr[10]), pos = 2, labels = paste("Pr[y = 1]
 = ", round(ypr[10], 2)))
\end_layout

\begin_layout Plain Layout

text(x[10], ypr[10] - 0.5*(ypr[10]), pos = 4, labels = paste("Pr[y = 0] =
 ", round(1 - ypr[10], 2)))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s4_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s4_2, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l", xlab=expression(X*beta), 
\end_layout

\begin_layout Plain Layout

       ylab='Probability(y=1)', col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr)
\end_layout

\begin_layout Plain Layout

j <- 4
\end_layout

\begin_layout Plain Layout

arrows(x[j], 0.05 + ypr[j], x[j], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x[j], -0.05 + ypr[j], x[j], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j]+ 0.5*(1 - ypr[j]), pos = 2, labels = paste("Pr[y = 1] =
 ", round(ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j] - 0.5*(ypr[j]), pos = 4, labels = paste("Pr[y = 0] = ",
 round(1 - ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s4_2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s4_3, fig=TRUE, include=F,  echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l", xlab=expression(X*beta), 
\end_layout

\begin_layout Plain Layout

ylab='Probability(y=1)', col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr)
\end_layout

\begin_layout Plain Layout

j <- 15
\end_layout

\begin_layout Plain Layout

arrows(x[j], 0.05 + ypr[j], x[j], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x[j], -0.05 + ypr[j], x[j], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j]+ 0.5*(1 - ypr[j]), pos = 2, labels = paste("Pr[y = 1] =
 ", round(ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j] - 0.5*(ypr[j]), pos = 4, labels = paste("Pr[y = 0] = ",
 round(1 - ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s4_3}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s5_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)', col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

points(x, ypr, col = "gray60")
\end_layout

\begin_layout Plain Layout

arrows(x, ifelse(ypr < 0.94, 0.05 + ypr, ypr + 0.1 * (1-ypr)),  x, 1, length
 = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x, ifelse(ypr > 0.05, ypr - 0.05, 0), x, 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s5_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Ways to think about that}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The linear predictor is transformed to the S-shaped curve
\end_layout

\begin_deeper
\begin_layout Itemize
Then an 
\begin_inset Quotes eld
\end_inset

up or down
\begin_inset Quotes erd
\end_inset

 random draw assigns 0 or 1
\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

up or down
\begin_inset Quotes erd
\end_inset

 draw is said to be drawn from a Binomial probability distribution
\end_layout

\end_deeper
\begin_layout Itemize
The probability values (expected values of 
\begin_inset Formula $y_{i})$
\end_inset

 are link-transformed back to values of 
\begin_inset Formula $X_{i}\beta$
\end_inset


\end_layout

\begin_layout Itemize
Any 
\begin_inset Quotes eld
\end_inset

S-shaped
\begin_inset Quotes erd
\end_inset

 curve would work.
 Many reasonable suggestions exist.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{If X is a dichotomy}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s8_1, fig=TRUE, include=F,  echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l", xlab=expression(X*beta), 
\end_layout

\begin_layout Plain Layout

ylab='Probability(y=1)', col = "gray80")
\end_layout

\begin_layout Plain Layout

xdic <- c(90, 110)
\end_layout

\begin_layout Plain Layout

rug(xdic, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(xdic, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(xdic, ypr)
\end_layout

\begin_layout Plain Layout

arrows(xdic[1], 0.05 + ypr[1], xdic[1], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(xdic[1], -0.05 + ypr[1], xdic[1], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(xdic[2], 0.05 + ypr[2], xdic[2], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(xdic[2], -0.05 + ypr[2], xdic[2], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

text(xdic[1], ypr[1]+ 0.5*(1 - ypr[1]), pos = 2, labels = paste("Pr[y = 1]"))
\end_layout

\begin_layout Plain Layout

text(xdic[1], ypr[1] - 0.5*(ypr[1]), pos = 2, labels = paste("Pr[y = 0]"))
\end_layout

\begin_layout Plain Layout

text(xdic[2], ypr[2]+ 0.5*(1 - ypr[2]), pos = 2, labels = paste("Pr[y = 1]"))
\end_layout

\begin_layout Plain Layout

text(xdic[2], ypr[2] - 0.5*(ypr[2]), pos = 4, labels = paste("Pr[y = 0]"))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s8_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
We still think as though there is an underlying S-curve, but outcomes only
 observed at a few points
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What does a scatterplot look like if X is a dichotomy}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s8_2, fig=TRUE, include=F,  echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="n", xlab=expression(X*beta), 
\end_layout

\begin_layout Plain Layout

ylab='Probability(y=1)', col = "gray80")
\end_layout

\begin_layout Plain Layout

xdic <- c(rep(90, 50), rep(110, 50))
\end_layout

\begin_layout Plain Layout

rug(xdic, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(xdic, beta0, beta1)
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(length(ypr), size = 1, pr = ypr)
\end_layout

\begin_layout Plain Layout

points(xdic, yobs)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s8_2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Fitting the coefficients for an S-shaped curve seems somewhat 
\begin_inset Quotes eld
\end_inset

heroic
\begin_inset Quotes erd
\end_inset

, but that's what we do.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Logistic S-Shaped Curve
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic S-Shape Formula}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
One formula for an S-shaped curve, the Logistic Model 
\begin_inset Formula 
\begin{eqnarray}
Prob(y_{i}=1|X_{i}) & = & \frac{exp(X_{i}\beta)}{1+exp(X_{i}\beta)}\\
 & = & \frac{1}{1+exp(-X_{i}\beta)}\\
\{\mathrm{same\,as}\} & = & \frac{1}{1+e^{-(X_{i}\beta)}}\label{eq:logisticS}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
Remember that 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $exp(X_{i}\beta)\rightarrow\infty$
\end_inset

 (rapidly) as 
\begin_inset Formula $X_{i}\beta$
\end_inset

 grows.
\end_layout

\begin_layout Itemize
\begin_inset Formula $exp(-X_{i}\beta)\rightarrow0$
\end_inset

 as 
\begin_inset Formula $X_{i}\beta$
\end_inset

 grows.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logit Transform}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $P_{i}=Prob(y_{i}=1|X_{i})$
\end_inset

.
\end_layout

\begin_layout Standard
We can re-arrange equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:logisticS"

\end_inset

) to produce a new formula that has the linear predictor on the right side
 by itself.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\ln\left[\frac{P_{i}}{1-P_{i}}\right]=x_{i}\beta
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
This is the 
\begin_inset Quotes eld
\end_inset

logit
\begin_inset Quotes erd
\end_inset

 transform of 
\begin_inset Formula $P_{i}$
\end_inset

.
 logit = 
\begin_inset Quotes eld
\end_inset

log of the odds ratio
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_layout Itemize
Can somebody interpret the odds for me? 
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $P_{i}=0$
\end_inset

 or 
\begin_inset Formula $1$
\end_inset

, the logit is undefined.
 The theory does not allow a 
\begin_inset Quotes eld
\end_inset

sure thing
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "logit-trans-graph"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logitrans10, fig=T,echo=F,include=F,width=4,height=4>>=
\end_layout

\begin_layout Plain Layout

prob <- seq(0.001, 0.999, length.out=1000)
\end_layout

\begin_layout Plain Layout

odds <- prob/(1-prob)
\end_layout

\begin_layout Plain Layout

plot(prob, odds, ylab = "P/(1-P)", xlab= "P", type = "l", ylim = c(0,200))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

<<logitrans20, fig=T,echo=F,include=F,width=4,height=4>>=
\end_layout

\begin_layout Plain Layout

lnodds <- log(prob/(1-prob))
\end_layout

\begin_layout Plain Layout

plot(prob, lnodds, ylab = "logit=ln(P/(1-P))", xlab= "P", type = "l")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{tmpout/t-logitrans10}
\backslash
includegraphics[width=6cm]{tmpout/t-logitrans20}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic Coefficient Interpretation}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $P_{i}$
\end_inset

 be the chance 
\begin_inset Formula $y=1$
\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $x_{i}$
\end_inset

 be one predictor
\end_layout

\begin_layout Enumerate
The slope for one predictor, 
\begin_inset Formula $\frac{\partial Pi}{\partial x_{i}}$
\end_inset

 = 
\begin_inset Formula $\beta_{1}\cdot P_{i}\cdot(1-P_{i})$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
Logistic population growth: as 
\begin_inset Formula $P_{i}$
\end_inset

 nears the upper limit of 
\begin_inset Formula $1$
\end_inset

, its rate of growth is slower and slower.
\end_layout

\begin_layout Itemize
The effect of 1 unit change in 
\begin_inset Formula $x_{i}$
\end_inset

 is 
\begin_inset Formula $\beta_{1}$
\end_inset

 weighted by 
\begin_inset Formula $P_{i}(1-P_{i})$
\end_inset

.
 
\end_layout

\begin_layout Itemize
At 
\begin_inset Formula $P_{i}=0.5$
\end_inset

, the slope is at a maximum.
 There 
\begin_inset Formula $P_{i}(1-P_{i})=0.25$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\frac{1}{4}\beta_{1}$
\end_inset

 the slope of the 
\begin_inset Quotes eld
\end_inset

S curve
\begin_inset Quotes erd
\end_inset

 at the mid point.
 
\end_layout

\end_deeper
\begin_layout Itemize
If 
\begin_inset Formula $y_{i}$
\end_inset

 is very likely to be a 1 or a 0, a change in 
\begin_inset Formula $X_{i}$
\end_inset

 doesn't make much difference.
\end_layout

\end_deeper
\begin_layout Enumerate
Obtain predicted probabilities, make nice table or plot
\end_layout

\begin_layout Enumerate
Explore estimates in the linear predictor space.
 Because
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\ln\left[\frac{P_{i}}{1-P_{i}}\right]=x_{i}\beta
\]

\end_inset


\end_layout

\begin_layout Standard
then people who can think of 
\begin_inset Formula $ln[\frac{P}{1-P}]$
\end_inset

 as a meaningful value can use 
\begin_inset Formula $\hat{\beta}$
\end_inset

 as a prediction of it.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The odds ratio: One way of "scaling" logit coefficients}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Some like to interpret the odds of the outcomes.
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\frac{P}{1-P}$
\end_inset

 (graphed that on slide 
\begin_inset CommandInset ref
LatexCommand ref
reference "logit-trans-graph"

\end_inset

)
\end_layout

\end_deeper
\begin_layout Itemize
Going further, some consider the ratio of the odds for 2 sets of predictors.
 The OR (Odds Ratio) is widely used.
\end_layout

\begin_layout Itemize
Suppose a predictor 
\begin_inset Formula $x_{i}$
\end_inset

 has only 2 values, 0 and 1.
 i.e., a 
\begin_inset Quotes eld
\end_inset

dummy variable
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Calculate the difference in the log odds ratio.
 
\end_layout

\begin_layout Itemize
Let 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $P_{1}$
\end_inset

 be the probability that 
\begin_inset Formula $y_{i}=1$
\end_inset

 if 
\begin_inset Formula $x_{i}=1$
\end_inset

 and 
\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{0}$
\end_inset

 be the probability 
\begin_inset Formula $y_{i}=1$
\end_inset

 if 
\begin_inset Formula $x_{i}=0$
\end_inset

 
\end_layout

\end_deeper
\begin_layout Itemize
The difference in the log odds:
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
ln\left[\frac{P_{1}}{1-P_{1}}\right]-ln\left[\frac{P_{0}}{1-P_{0}}\right]=\left\{ \beta_{0}+\beta_{1}\cdot1\right\} -\left\{ \beta_{0}+\beta_{1}\cdot0\right\} 
\]

\end_inset


\begin_inset Formula 
\[
ln\left[\frac{\frac{P_{1}}{1-P_{1}}}{\frac{P_{0}}{1-P_{0}}}\right]=\beta_{1}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Now apply 
\begin_inset Formula $\mathrm{exp}$
\end_inset

 to both sides get the odds ratio by itself on the left side
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\frac{\frac{P_{1}}{1-P_{1}}}{\frac{P_{0}}{1-P_{0}}}=exp(\beta_{1})
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
On the left, we have the ratio of the log odds.
 Hence,
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $exp(\beta_{1})$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

odds ratio
\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_deeper
\begin_layout Itemize
Another Interpretation: odds in case 1 are proportional to odds in case
 0
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{P_{1}}{1-P_{1}}=\frac{P_{0}}{1-P_{0}}exp(\beta_{1})
\]

\end_inset


\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $x_{i}$
\end_inset

 is a 
\begin_inset Quotes eld
\end_inset

dummy variable
\begin_inset Quotes erd
\end_inset

, then this approach may be meaningful.
 When 
\begin_inset Formula $x_{i}$
\end_inset

 has a different range, I don't see any value in it.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Weaknesses in the odds ratio}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
I'm not sure who first proposed the OR, but there are many publications
 that do use it.
 
\end_layout

\begin_layout Itemize
There are also quite a few articles that discourage it (
\begin_inset CommandInset citation
LatexCommand citet
key "lee_practical_2009,cummings_relative_2009,sainani_understanding_2011"
literal "true"

\end_inset

.
 The gist of this is as follows
\end_layout

\begin_layout Itemize
Many authors actually want to study the 
\begin_inset Quotes eld
\end_inset

relative risk
\begin_inset Quotes erd
\end_inset


\begin_inset Formula 
\[
RelativeRisk=RR=\frac{P_{1}}{P_{0}}
\]

\end_inset


\end_layout

\begin_layout Itemize
However, from the logistic regression output, we cannot get RR.
 Additional calculation would be needed.
\end_layout

\begin_layout Itemize
Decades ago, it was noticed that if 
\begin_inset Formula $P_{1}$
\end_inset

 and 
\begin_inset Formula $P_{0}$
\end_inset

 are very large or very small, then the Odds Ratio is a reasonable, quick,
 
\begin_inset Quotes eld
\end_inset

back of the envelope
\begin_inset Quotes erd
\end_inset

 guess about RR.
 
\end_layout

\begin_layout Itemize
Nevertheless, over time, the roots were forgotten and authors are urged
 to report OR, mistakenly believing that they are interpreted as relative
 risk.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Example: Logistic Model
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The BIG PICTURE: Overlay OLS and Logit}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
My test data has outcome 
\begin_inset Quotes eld
\end_inset

y2
\begin_inset Quotes erd
\end_inset

 and predictor 
\begin_inset Quotes eld
\end_inset

x2
\begin_inset Quotes erd
\end_inset

.
 Was graphed above.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logit1, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

glm1 <- glm(y2~x2, family=binomial(logit))
\end_layout

\begin_layout Plain Layout

summary(glm1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logit2, fig=T, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(x2,y2)
\end_layout

\begin_layout Plain Layout

abline(m1, lty=2)
\end_layout

\begin_layout Plain Layout

library(rockchalk)
\end_layout

\begin_layout Plain Layout

plotx <- plotSeq(x2)
\end_layout

\begin_layout Plain Layout

glmpred <- predict(glm1, newdata=data.frame(x=plotx), type="response")
\end_layout

\begin_layout Plain Layout

lines(plotx, glmpred, lty=1)
\end_layout

\begin_layout Plain Layout

legend("topleft", title = "Predicted Values", 
\end_layout

\begin_layout Plain Layout

    legend=c("Logistic", "OLS"), lty=c(1,2))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logit2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic fitted with glm in R}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In R, it is fitted as a generalized linear model.
\end_layout

\begin_deeper
\begin_layout Itemize
Family is binomial
\end_layout

\begin_layout Itemize
link is logit
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-logit1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Features worth noting}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Familiar 
\begin_inset Quotes eld
\end_inset

parameter summary table
\begin_inset Quotes erd
\end_inset

 with columns for 
\begin_inset Formula $\hat{\beta}$
\end_inset

 and 
\begin_inset Formula $std.err.(\hat{\beta}$
\end_inset

)
\end_layout

\begin_layout Itemize
3rd column is not 
\begin_inset Formula $t,$
\end_inset

 but rather 
\begin_inset Formula $z$
\end_inset

.
\end_layout

\begin_layout Itemize
There's no 
\begin_inset Formula $R^{2}$
\end_inset


\end_layout

\begin_layout Itemize
New statistics 
\begin_inset Quotes eld
\end_inset

Null deviance
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Residual deviance
\begin_inset Quotes erd
\end_inset

 and AIC.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rockchalk outreg table: Compare OLS and Logistic}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logit4, echo=F, include=F, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(OLS = modl2, Logit = glm1), showAIC=T, 
\end_layout

\begin_layout Plain Layout

       request = c("fstatistic" = "F"))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-logit4}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Consider the Standard Error and z stat columns}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
No T test
\end_layout

\begin_layout Itemize
Technically, the ratio 
\begin_inset Formula $\frac{\hat{\beta}-0}{std.err.(\hat{\beta})}$
\end_inset

 is not compared against 
\begin_inset Formula $t$
\end_inset

 distribution because that ratio has an unknown distribution in small samples.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $N$
\end_inset

 were infinite, the ratio 
\begin_inset Formula $\frac{\hat{\beta}-0}{std.err.(\hat{\beta})}$
\end_inset

 would be distributed Normally, that's why column in output is labeled 
\begin_inset Formula $z$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
That's what 
\begin_inset Quotes eld
\end_inset

asymptotically distributed as
\begin_inset Quotes erd
\end_inset

 refers to.
\end_layout

\end_deeper
\begin_layout Itemize
Some software reports a squared ratio 
\begin_inset Formula $\left(\frac{\hat{\beta}}{std.err.(\hat{\beta})}\right)^{2}$
\end_inset

 which is labeled as a Wald 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Predicted values}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
OLS: estimates the 
\begin_inset Formula $\beta$
\end_inset

's in 
\begin_inset Formula $\hat{y}_{i}=\hat{\beta}_{0}+\hat{\beta}_{1}x_{i}$
\end_inset

.
 Those are 
\begin_inset Quotes eld
\end_inset

linear probability
\begin_inset Quotes erd
\end_inset

 estimates
\end_layout

\begin_layout Itemize
Logistic: predicted values may be transformed, or not.
\end_layout

\begin_deeper
\begin_layout Itemize
NOT: In linear predictor scale 
\begin_inset Formula $\hat{\eta}_{i}=\hat{\beta}_{0}+\hat{\beta}_{1}x_{i}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
transform in order to get probabilities
\begin_inset Formula 
\[
\frac{e^{\hat{\eta_{i}}}}{1+e^{\hat{\eta_{i}}}}\,\mathrm{same\,as\,}\frac{1}{1+e^{-\hat{\eta_{i}}}}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{About Predicted Values}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset


\begin_inset Flex Code
status open

\begin_layout Plain Layout
predict
\end_layout

\end_inset


\begin_inset Quotes erd
\end_inset

 function calculates 
\begin_inset Formula $\hat{\eta}$
\end_inset

 values from the fitted glm:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

glm1 <- glm(y ~ x1 + x2 + x3, data=dat, family=binomial(logit))
\end_layout

\begin_layout Plain Layout

predy1 <- predict(glm1)
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The default predict output is on the linear predictor scale, a number that
 can range from 
\begin_inset Formula $-\infty$
\end_inset

 to 
\begin_inset Formula $\infty$
\end_inset

.
 
\end_layout

\begin_layout Itemize
To shrink that back to 
\begin_inset Formula $(0,1)$
\end_inset

 interval (representing probability scale of observed scores), transform
 back to the 
\begin_inset Quotes eld
\end_inset

response
\begin_inset Quotes erd
\end_inset

 scale.
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

predy2 <- predict(glm1, type="response")
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Works well with the 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
newdata
\end_layout

\end_inset

 parameter to get predicted probabilities for particular cases
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

nd <- rockchalk::newdata(glm1,  <whatever you need>)
\end_layout

\begin_layout Plain Layout

predy2 <- predict(glm1, newdata = nd, type="response")
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
HOWEVER
\series default
, 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
predict.glm
\end_layout

\end_inset

 does not provide confidence intervals (long, controversial story).
 Various 
\begin_inset Quotes eld
\end_inset

improvised
\begin_inset Quotes erd
\end_inset

 CIs possible
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rockchalk::predictOMatic gives fitted values on the response
 scale}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

predictOMatic(glm1, predVals = c(x2 = "seq"), n = 10)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]HOWEVERHOWEVER
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Show off some more predictOMatic}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here the values of the predictor are selected so they equal the mean, +/-
 standard deviation, +/- 2 standard deviations
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

predictOMatic(glm1, predVals = c(x2 = "std.dev."), n = 5, interval = "confidence")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{plotCurves in rockchalk}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(glm1, plotx="x2", interval="confidence")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Maximum Likelihood
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Probability of Observing a Whole Sample}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Assume the observations are statistically independent, meaning the probability
 of the sample equals the individual probabilities multiplied together.
 Hence,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
Likelihood\,of\,Sample:\,\,L(\beta_{0},\beta_{1})=\\
=P(y_{1}=0,y_{2}=0,...,y_{m}=0,y_{m+1}=1,y_{m+2}=1,...,y_{N}=1)\\
=P(y_{1}=0)P(y_{2}=0)\cdots P(y_{m}=0)\\
\times P(y_{m+1}=1)P(y_{m+2}=1)\cdots P(y_{N}=1)
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Simplify That}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Remember that 
\begin_inset Formula $P(y_{i}=0)$
\end_inset


\begin_inset Formula $=1-P(y_{i}=1)$
\end_inset

, so 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
L(\beta_{0},\beta_{1})=(1-P(y_{1}=1))(1-P(y_{2}=1))\cdots(1-P(y_{m}=1))\nonumber \\
\times P(y_{m+1}=1)P(y_{m+2}=1)\cdots P(y_{N}=1)
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
Simplify notation: 
\begin_inset Formula $P_{i}=P(y_{i}=1)$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
L(\beta_{0},\beta_{1})=(1-P_{1})(1-P_{2})\cdots(1-P_{m}))\nonumber \\
\times P{}_{m+1}P{}_{m+2}\cdots P{}_{N}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Log That To Simplify Further}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The Log of the Likelihood Function is a sum of logs:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\ln L(\beta_{0},\beta_{1})=\ln(1-P_{1})+\ln(1-P_{2})+\cdots+\ln(1-P_{m})+\ln(P_{m+1})+\cdots+\ln(P_{N})
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
In a Logistic case, we'd fill in 
\begin_inset Formula $P_{i}=\frac{1}{1+e^{-(\beta_{0}+\beta_{1}X_{i})}}$
\end_inset

 
\end_layout

\begin_layout Itemize
MLE, short for Maximum Likelihood Estimate, is the choice of estimators
 
\begin_inset Formula $\beta_{0}$
\end_inset

, 
\begin_inset Formula $\beta_{1}$
\end_inset

 that maximize the log of the likelihood function.
 This solution is also a maximizer of L.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Quick summary of MLE properties}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
NOT unbiased.
 (suspicious, or even poor, small sample properties)
\end_layout

\begin_layout Enumerate
Large sample (
\begin_inset Quotes eld
\end_inset

asymptotic
\begin_inset Quotes erd
\end_inset

) properties.
 MLE's are 
\end_layout

\begin_deeper
\begin_layout Enumerate
consistent, 
\end_layout

\begin_layout Enumerate
asymptotically efficient, 
\end_layout

\begin_layout Enumerate
asymptotically Normal (the central limit theorem).
 
\end_layout

\end_deeper
\begin_layout Enumerate
Asymptotic standard errors.
 Fisher showed a way to create a variance-covariance matrix of 
\begin_inset Formula $\hat{\beta}.$
\end_inset

 The square root of the diagonal has standard errors that appear in output.
 
\end_layout

\begin_deeper
\begin_layout Enumerate
Asymptotic: if you had an infinite sample with this var-covar matrix, then
 we could do hypothesis tests that are accurate.
 
\end_layout

\begin_layout Enumerate
Problem: In real life data, samples are not infinite, and thus we have approxima
te standard errors.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Estimation requires iteration}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

score equations
\begin_inset Quotes erd
\end_inset

 set the first derivatives of the log likelihood function equal to 0
\begin_inset Formula 
\[
\frac{\partial\mathrm{ln}L}{\partial\beta_{j}}=0
\]

\end_inset


\end_layout

\begin_layout Itemize
The numerical method for finding the 
\begin_inset Formula $\beta$
\end_inset

's goes roughly like this
\end_layout

\begin_deeper
\begin_layout Itemize
make guess
\end_layout

\begin_layout Itemize
choose a direction going 
\begin_inset Quotes eld
\end_inset

uphill
\begin_inset Quotes erd
\end_inset

 on the likelihood surface
\end_layout

\begin_layout Itemize
repeat until guesses don't change
\end_layout

\end_deeper
\begin_layout Itemize
The clearest description I've found is in 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 121"
key "hastie_elements_2009"
literal "true"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Bias is a realistic concern}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Because estimates are known to be biased in finite samples, there is increasing
 pressure to consider non-ML estimates that trim off some of the known bias
\end_layout

\begin_layout Itemize
While I don't delve into that here, the place to start is the article by
 Firth 
\begin_inset CommandInset citation
LatexCommand citet
key "firth_bias_1993"
literal "true"

\end_inset


\end_layout

\begin_layout Itemize
Very recently, an R package to estimate the 
\begin_inset Quotes eld
\end_inset

bias reduced
\begin_inset Quotes erd
\end_inset

 logistic regression was introduced (brglm2).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Use any CDF
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Where did the error term go?} 
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In OLS, we were constantly going on about 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 and its variance.
 OLS says
\begin_inset Formula 
\[
y_{i}=\beta_{0}+\beta_{1}X_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
Logit says 
\begin_inset Formula 
\[
P_{i}=\frac{1}{1+exp(-(\beta_{0}+\beta_{1}X_{i}))}
\]

\end_inset


\end_layout

\begin_layout Itemize
Where is the error term? 
\end_layout

\begin_layout Itemize
Along the way, we answer 
\begin_inset Quotes eld
\end_inset

what's the difference between probit and logit?
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

what is probit, anyway?
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Restate the theory in a different way}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Write a predictive statement about a latent variable 
\begin_inset Formula $Z_{i}$
\end_inset

.
\begin_inset Formula 
\[
Z_{i}=\beta_{0}+\beta_{1}X_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
I frequently make mistakes with signs, etc, but maybe I have this correct
 now
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Theory: If 
\begin_inset Formula $Z_{i}$
\end_inset

 is greater than 0, then 
\begin_inset Formula $y_{i}=1$
\end_inset

.
\begin_inset Formula 
\[
\beta_{0}+\beta_{1}X_{i}+\varepsilon_{i}>0
\]

\end_inset


\begin_inset Formula 
\[
\beta_{0}+\beta_{1}X_{i}>-\varepsilon_{i}
\]

\end_inset


\begin_inset Formula 
\[
-\beta_{0}-\beta_{1}X_{i}<\varepsilon_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
That's the upper right side of a CDF.
 If 
\begin_inset Formula $f(\varepsilon_{i})$
\end_inset

 is the PDF, then the chance of a 1 is 
\begin_inset Formula $1-F(-\beta_{0}-\beta_{1}X_{i})$
\end_inset

.
 
\end_layout

\begin_layout Itemize
And, as mentioned above, because 
\begin_inset Formula $f(\varepsilon)$
\end_inset

 is symmetric
\begin_inset Formula 
\[
F(\beta_{0}+\beta_{1}X_{i})=1-F(-\beta_{0}-\beta_{1}X_{i})
\]

\end_inset


\end_layout

\begin_layout Itemize
Now recall my CDF discussion above.
 The 
\begin_inset Quotes eld
\end_inset

dividing point
\begin_inset Quotes erd
\end_inset

 in the data is 
\begin_inset Formula $\beta_{0}+\beta_{1}X_{i}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<cdf100, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="")
\end_layout

\begin_layout Plain Layout

xcut <- 0.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(1, 0.025, pos = 4, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

text(-1.25, 0.025, pos = 2, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

mtext(expression(beta[0]+beta[1]*X[i]), 1, at = xcut)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-cdf100}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Because I want to think of the chance going up as 
\begin_inset Formula $\eta_{i}$
\end_inset

 increases, I'm graphing 
\begin_inset Formula $y=1$
\end_inset

 on the LEFT side (If you plot 
\begin_inset Formula $-\eta_{i}$
\end_inset

, the sides 'swap').
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Logistic Regression
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logit}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The logistic probability distribution is single peaked and symmetric.
\end_layout

\begin_layout Itemize
Its formulae are especially simple and it is easy to calculate the 
\begin_inset Quotes eld
\end_inset

area under the curve
\begin_inset Quotes erd
\end_inset

 up to a point.
\end_layout

\begin_layout Itemize
We already did the CDF graph
\end_layout

\begin_layout Itemize
All you should need is proof that 
\end_layout

\begin_deeper
\begin_layout Enumerate
the 
\begin_inset Formula $f(\varepsilon_{i})$
\end_inset

 is a formula that exists in a book somewhere, with parameters like any
 probability model
\end_layout

\begin_layout Enumerate
the CDF of the logistic has the formula 
\begin_inset Formula $exp(X_{i}\beta)/(1+exp(X_{i}\beta))$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
Maybe you are willing to accept those claims and we skip 2 slides.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic Distribution Details (skip this slide)}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Logistic PDF for a variable 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

:
\begin_inset Formula 
\begin{equation}
f(\varepsilon_{i})=\frac{exp(-(\varepsilon_{i}-\mu)/\sigma)}{\sigma(1+exp(-(\varepsilon_{i}-\mu)/\sigma))}\label{eq:logistpdf}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
The expected value is 
\begin_inset Formula $\mu.$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\sigma$
\end_inset

 is a scale parameter, NOT the standard deviation
\end_layout

\begin_layout Itemize
The variance is 
\begin_inset Formula $Var(\varepsilon_{i})=\frac{1}{3}(\pi\sigma)^{2}$
\end_inset

 and the standard deviation is 
\begin_inset Formula $\frac{\pi\sigma}{\sqrt{3}}$
\end_inset


\end_layout

\begin_layout Itemize
To simplify, it is usual to assume 
\begin_inset Formula $\mu=0$
\end_inset

 and 
\begin_inset Formula $\sigma=1$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\mu=0$
\end_inset

 because any non-zero amount of 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 would show up as 
\begin_inset Formula $\beta_{o}$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\sigma=1.0$
\end_inset

 because that 
\begin_inset Quotes eld
\end_inset

works
\begin_inset Quotes erd
\end_inset

 well enough.
\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\sigma$
\end_inset

 is an 
\begin_inset Quotes eld
\end_inset

unidentified
\begin_inset Quotes erd
\end_inset

 (unestimable) coefficient.
\end_layout

\begin_deeper
\begin_layout Itemize
Theory says 
\begin_inset Formula 
\[
y_{i}=1\,\,if\,\,\varepsilon\leq\beta_{0}+\beta_{1}X_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
Note that the inequality is not altered if we divide both sides by any value
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
y_{i}=1\,\,if\,\,\frac{\varepsilon}{\sigma}\leq\frac{\beta_{0}}{\sigma}+\frac{\beta_{1}}{\sigma}X_{i}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Because the observable result is the same, no matter how 
\begin_inset Formula $\sigma$
\end_inset

 is set, we suppose it is 1 (and simplify our formulas)
\end_layout

\end_deeper
\begin_layout Itemize
If we assume 
\begin_inset Formula $\mu=0$
\end_inset

 and 
\begin_inset Formula $\sigma=1$
\end_inset

, then the PDF simplifies to
\begin_inset Formula 
\begin{equation}
f(\varepsilon_{i})=\frac{e^{-\varepsilon_{i}}}{(1+e^{-\varepsilon_{i}})^{2}}\label{eq:}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Through the magic of integral calculus, the solution is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(y_{i}=0|X_{i},\beta_{i})=\frac{e^{\beta_{0}+\beta_{1}X_{i}}}{1+e^{\beta_{0}+\beta_{1}X_{i}}}=\frac{1}{1+e^{-(\beta_{0}+\beta_{1}X_{i})}}\label{eq:logistic}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Show My Work: Derivation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The indefinite integral is very simple.
 
\begin_inset Formula 
\begin{eqnarray*}
F(\tau) & = & \int_{-\infty}^{\tau}\frac{e^{-\varepsilon_{i}}}{(1+e^{-\varepsilon_{i}})^{2}}de_{i}\\
 & =\frac{e^{\tau}}{1+e^{\tau}} & =\frac{1}{1+e^{-\tau}}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Probit Regression
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Probit}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 be Normally distributed, 
\begin_inset Formula $N(0,\sigma_{\varepsilon}^{2})$
\end_inset

.
 
\end_layout

\begin_layout Itemize
The Normal is a 
\begin_inset Quotes eld
\end_inset

good
\begin_inset Quotes erd
\end_inset

 distribution in many respects, especially because of 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
the central limit theorem
\end_layout

\begin_layout Itemize
the (relatively) easy extension of the Normal to a multi-dimensional outcome
 variable.
\end_layout

\end_deeper
\begin_layout Itemize
However, it is more computationally intensive.
\end_layout

\begin_layout Itemize
The PDF is
\begin_inset Formula 
\[
f(\varepsilon_{i})=\frac{1}{\sqrt{2\pi\sigma^{2}}}e^{-\frac{(\varepsilon_{i}-\mu)^{2}}{2\sigma^{2}}}
\]

\end_inset


\end_layout

\begin_layout Itemize
But the CDF is an integral for which there is no simple formula.
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\int_{-\infty}^{\beta_{0}+\beta_{1}X_{i}}\frac{1}{\sqrt{2\pi\sigma^{2}}}\cdot e^{-}\frac{(e_{i}-\mu)^{2}}{2\sigma^{2}}de_{i}\label{eq:probit}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This must be numerically approximated
\end_layout

\end_deeper
\begin_layout Itemize
Simplify by assuming
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\mu=0$
\end_inset

.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\sigma^{2}=1$
\end_inset

.
 
\begin_inset Formula $\sigma^{2}$
\end_inset

 is called the 
\begin_inset Quotes eld
\end_inset

scale parameter
\begin_inset Quotes erd
\end_inset

, it is unidentified (can't be estimated).
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Probit Notation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Because the probit equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:probit"

\end_inset

 is complicated, refer to it as, 
\begin_inset Formula $\Phi$
\end_inset

, representing the CDF as.
 
\begin_inset Formula 
\begin{equation}
P(y_{i}=1|X_{i},\beta_{i})=\Phi(\beta_{0}+\beta_{1}X_{i})\label{eq:probit2}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
The probability of observing a 
\begin_inset Formula $0$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(y_{i}=0|X_{i},\beta_{i})=1-\Phi(\beta_{0}+\beta_{1}X_{i})\label{eq:compl}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Does it matter if you use Logit or Probit?}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Itemize
Not very much.
\end_layout

\begin_layout Itemize
I adjust the parameter 
\begin_inset Formula $\sigma$
\end_inset

 so that the variances of the 2 variables are the same
\end_layout

\begin_layout Itemize
If Logistic scale param= 1, then Normal std.dev.= 
\begin_inset Formula $\pi/\sqrt{3}$
\end_inset

.
\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<landn,echo=F, include=F, fig=T,height=6, width=6>>=
\end_layout

\begin_layout Plain Layout

x <- seq(-6,6, by=0.05)
\end_layout

\begin_layout Plain Layout

mylogis111 <- dlogis(x, location = 0, scale = 1, log = FALSE) 
\end_layout

\begin_layout Plain Layout

myNorm <- dnorm(x, mean = 0, sd = pi/sqrt(3)) 
\end_layout

\begin_layout Plain Layout

matplot(x, cbind(mylogis111, myNorm),type="l",ylim=c(0,0.5), xlab="x", ylab="P(x)
", main="") 
\end_layout

\begin_layout Plain Layout

normlabel = expression(paste("Normal(",0,",",pi^{2}/3,")"))
\end_layout

\begin_layout Plain Layout

legend("topleft", c("Logistic(0,1)",normlabel), lty=1:2, col=1:2) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{tmpout/t-landn}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Probit Fit
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Fit a probit model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<probit1, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

glm2 <- glm(y2~x2, family=binomial(probit))
\end_layout

\begin_layout Plain Layout

summary(glm2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-probit1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Compare Logit and Probit
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Coefficients differ}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logitprobit10, echo=F, include=F, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(Logit = glm1, Probit = glm2), showAIC=T, 
\end_layout

\begin_layout Plain Layout

       request = c("fstatistic" = "F"))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-logitprobit10}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Coefficients generally proportional to each other, approximately 
\begin_inset Formula $\hat{\beta}_{logit}=\frac{\pi}{\sqrt{3}}\hat{\beta}_{probit}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{And you see now why people don't care if you use Logit or Probit}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<probit2, include=T, echo=T>>=
\end_layout

\begin_layout Plain Layout

options(scipen = 10)
\end_layout

\begin_layout Plain Layout

p1 <- predictOMatic(glm1, predVals = c(x2 = "seq"), n = 10)
\end_layout

\begin_layout Plain Layout

p2 <- predictOMatic(glm2, predVals=c(x2 = "seq"), n = 10)
\end_layout

\begin_layout Plain Layout

cbind(p1, p2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Compare the S-shaped curves}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<probit10, fig=T, include=F, echo=F, height = 5, width = 8>>=
\end_layout

\begin_layout Plain Layout

plot(x2,y2)
\end_layout

\begin_layout Plain Layout

p1 <- predictOMatic(glm1, predVals = c(x2 = "seq"), n = 50)
\end_layout

\begin_layout Plain Layout

p2 <- predictOMatic(glm2, predVals=c(x2 = "seq"), n = 50)
\end_layout

\begin_layout Plain Layout

lines(p1$x2, p1$fit, lty=1)
\end_layout

\begin_layout Plain Layout

lines(p2$x2, p2$fit, lty=2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend=c("Logit", "Probit"), 
\end_layout

\begin_layout Plain Layout

           title = "Predicted Probabilities", lty=c(1,2))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-probit10.tex}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-probit10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Summary: Comparison of Logit/Probit?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
What is the difference? 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Logit is based on the Logistic distribution, the 
\begin_inset Formula $\hat{\eta}_{i}$
\end_inset

 is converted into probabilities by the logistic CDF
\end_layout

\begin_layout Itemize
Probit is based on the Normal distribution, the 
\begin_inset Formula $\hat{\eta}_{i}$
\end_inset

 is converted into probabilities by the normal CDF
\end_layout

\end_deeper
\begin_layout Itemize
In practice, Is there a big difference?
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Not if your dependent variable is dichotomous
\end_layout

\begin_layout Itemize
Otherwise, there can be big differences, more caution needed
\end_layout

\end_deeper
\begin_layout Itemize
Field dependent
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Psychologists pretty strongly prefer logistic
\end_layout

\begin_layout Itemize
Economists pretty strongly prefer probit
\end_layout

\begin_layout Itemize
Political scientists indifferent
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Data Problems: Imbalance, separation
\end_layout

\begin_layout Subsection
Homogeneous outcomes
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Can't estimate if all $y_{i}=1$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sep10, fig=T, include=F, echo=F,results=hide>>=
\end_layout

\begin_layout Plain Layout

xrange <- seq(50, 150, length = 200)
\end_layout

\begin_layout Plain Layout

x <- runif(20, 115, 150)
\end_layout

\begin_layout Plain Layout

beta0 <- -10
\end_layout

\begin_layout Plain Layout

beta1 <- .1
\end_layout

\begin_layout Plain Layout

pry <- function(x, k0, k1){
\end_layout

\begin_layout Plain Layout

   exp(k0 + k1 * x)/(1 + exp(k0 + k1 * x))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

ProbY1 <- pry(xrange, beta0, beta1)
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)', col = "gray70",
\end_layout

\begin_layout Plain Layout

     main = "The True S is there, but...")
\end_layout

\begin_layout Plain Layout

y <- rep(1, 20)
\end_layout

\begin_layout Plain Layout

points(x, y)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-sep10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Nearly Homogeneous outcomes
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Rare Events}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In most data, we don't find all 
\begin_inset Formula $y$
\end_inset

's are 0 or 1
\end_layout

\begin_deeper
\begin_layout Standard
but we do find most y's are one or the other
\end_layout

\end_deeper
\begin_layout Itemize
In political science, this was brought to our attention by 
\begin_inset CommandInset citation
LatexCommand citet
key "king_logistic_2001"
literal "true"

\end_inset

, who described it in a 
\begin_inset Quotes eld
\end_inset

rare events
\begin_inset Quotes erd
\end_inset

 jargon
\end_layout

\begin_layout Standard
Suggested:
\end_layout

\begin_layout Itemize
Find more cases in the minority outcome
\end_layout

\begin_layout Itemize
Correct the logit estimates, mainly the intercept needs fixing
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Troubles with categorical predictors}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
When estimating dummy variables, estimator must calculate 
\begin_inset Formula $P/(1-P)$
\end_inset

 for each subgroup of observations
\end_layout

\begin_layout Itemize
If a group's outcomes are all 0 or all 1, then 
\begin_inset Formula $P/(1-P)$
\end_inset

 can't be calculated
\end_layout

\begin_layout Itemize
This is called 
\begin_inset Quotes eld
\end_inset

separation
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_layout Itemize
Next I have an example of a similar problem of 
\begin_inset Quotes eld
\end_inset

separation
\begin_inset Quotes erd
\end_inset

 with a numeric predictor.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Small Sample with Separation
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Small sample example}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Will use small samples, just 20 observations
\end_layout

\begin_layout Itemize
My 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 model will have 
\end_layout

\begin_deeper
\begin_layout Itemize
Just 1 numeric predictor, which ranges from 50 to 150
\end_layout

\begin_layout Itemize
Logistic coefficients are 
\begin_inset Formula $\beta_{0}=-10$
\end_inset

 and 
\begin_inset Formula $\beta_{1}=0.1$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The "true" model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<include=F, echo=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

seedfn <- "before-seed-6_1.rds"
\end_layout

\begin_layout Plain Layout

if(!file.exists(seedfn)){
\end_layout

\begin_layout Plain Layout

    seedbf6_1 <- .Random.seed
\end_layout

\begin_layout Plain Layout

    saveRDS(seedbf6_1, file = seedfn)
\end_layout

\begin_layout Plain Layout

} else {
\end_layout

\begin_layout Plain Layout

	seedbf6_1 <- readRDS(seedfn) 
\end_layout

\begin_layout Plain Layout

    assign(".Random.seed", seedbf6_1, envir = .GlobalEnv)
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s6_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

xrange <- seq(50, 150, length = 200)
\end_layout

\begin_layout Plain Layout

x <- rnorm(20, m = 100, s = 20)
\end_layout

\begin_layout Plain Layout

beta0 <- -10
\end_layout

\begin_layout Plain Layout

beta1 <- .1
\end_layout

\begin_layout Plain Layout

pry <- function(x, k0, k1){
\end_layout

\begin_layout Plain Layout

   exp(k0 + k1 * x)/(1 + exp(k0 + k1 * x))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

ProbY1 <- pry(xrange, beta0, beta1)
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)', col = "gray70",
\end_layout

\begin_layout Plain Layout

     main = paste("The True Model, beta0 =", beta0, ", beta1 = ", beta1))
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1)
\end_layout

\begin_layout Plain Layout

rug(x)
\end_layout

\begin_layout Plain Layout

points(x, ypr)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s6_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{I'll draw 10 samples}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
I'll keep the values of 
\begin_inset Formula $x$
\end_inset

 fixed, and I'll draw fresh samples of the observed 
\begin_inset Formula $y$
\end_inset

 from a binomial distribution
\end_layout

\begin_layout Itemize
I drew enough samples to make the 
\begin_inset Quotes eld
\end_inset

funny thing
\begin_inset Quotes erd
\end_inset

 happen.
 
\end_layout

\begin_layout Itemize
Look for sample 8
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_1, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m1 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m1, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_2, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m2 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m2, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 3}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_3, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m3 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m3, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_3}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 4}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_4, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m4 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m4, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_4}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 5}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_5, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m5 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m5, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_5}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 6}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_6, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m6 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m2, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_6}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 7}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_7, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m7 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m7, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_7}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 8}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "m8"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<seedsnap, include=F, echo=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

seedbf8 <- .Random.seed
\end_layout

\begin_layout Plain Layout

saveRDS(seedbf8, file = "before8-seed.rds")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_8, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m8 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

dat8 <- data.frame(yobs, x)
\end_layout

\begin_layout Plain Layout

plotCurves(m8, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<seedsnap2, include=F, echo=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

saveRDS(dat8, file = "before8-dat.rds")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_8}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 9}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_9, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m9 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m9, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_9}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Sample 10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_10, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m10 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m10, plotx = "x", ylab = "Probability(y = 1)", plotLegend = FALSE)
\end_layout

\begin_layout Plain Layout

lines(xrange, ProbY1, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Estimate", "True"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s7_10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Estimates table}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_fits1,echo=FALSE,results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(m1, m2, m3, m4, m5))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s7_fits2,echo=FALSE,results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list("M6" = m6, "M7" = m7, "M8" = m8, "M9" = m9, "M10" = m10))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Funny Business in model 8}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Scroll back to slide 
\begin_inset CommandInset ref
LatexCommand ref
reference "m8"

\end_inset

, the graph of model 8
\end_layout

\begin_layout Itemize
The glm function does not throw an error.
 But, if we are running interactively, there is a warning, which looks like
 this:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

> glm(yobs ~ x, dat8, family=binomial)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Call:  glm(formula = yobs ~ x, family = binomial, data = dat)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Coefficients:
\end_layout

\begin_layout Plain Layout

(Intercept)            x
\end_layout

\begin_layout Plain Layout

   -727.991        7.383
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Degrees of Freedom: 19 Total (i.e.
 Null);  18 Residual
\end_layout

\begin_layout Plain Layout

Null Deviance:      26.92
\end_layout

\begin_layout Plain Layout

Residual Deviance: 2.652e-09    AIC: 4
\end_layout

\begin_layout Plain Layout

Warning messages:
\end_layout

\begin_layout Plain Layout

1: glm.fit: algorithm did not converge
\end_layout

\begin_layout Plain Layout

2: glm.fit: fitted probabilities numerically 0 or 1 occurred
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{How to comprehend that}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Theoretical model says 
\begin_inset Formula $Pr(y=1)$
\end_inset

 must always be between 
\begin_inset Formula $0$
\end_inset

 and 
\begin_inset Formula $1$
\end_inset

, never exactly equal to it.
\end_layout

\begin_layout Itemize
But the data wants to say 
\begin_inset Formula $y$
\end_inset

 is certainly 0 up to a point, and then 
\begin_inset Formula $1$
\end_inset

 after.
\end_layout

\begin_layout Itemize
To 
\begin_inset Quotes eld
\end_inset

fit
\begin_inset Quotes erd
\end_inset

 that, the S shaped curve would need kinks
\end_layout

\begin_layout Itemize
Why doesn't optimizer notice and stop
\end_layout

\begin_deeper
\begin_layout Itemize
A well behaved ML has a single peak in the interior of the parameter space
\end_layout

\begin_layout Itemize
An ill-behaved ML surface has a maximum at infinity, so the estimator might
 keep guessing bigger and bigger values
\end_layout

\begin_layout Itemize
The stopping algorithm quits on the way to an infinite estimate and glm
 reports that non-converged value.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Funny Business in model 8}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
One defense method is the safeBinaryRegression package, which provokes an
 error, rather than a warning.
 Run like this:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

> library(safeBinaryRegression)
\end_layout

\begin_layout Plain Layout

> glm(yobs ~ x, dat = dat8, family = "binomial")
\end_layout

\begin_layout Plain Layout

Error in glm(yobs ~ x, dat = dat8, family = "binomial") :
\end_layout

\begin_layout Plain Layout

  The following terms are causing separation among the sample points: (Intercept
), x
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Testing Statistical Significance
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Hypo Tests in practice}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Deciding which variable to keep in the model: 
\end_layout

\begin_deeper
\begin_layout Itemize
Is the true effect really 0?
\end_layout

\begin_layout Itemize
Is it safe to omit that variable from the equation
\end_layout

\end_deeper
\begin_layout Itemize
The best practice is to fit a larger model, then fit a model that omits
 a variable, and do the analysis of deviance (liklihood ratio test) to test
 (Hastie, Tibshirani, Friedman, ESL 2ed, p.
 124).
 
\end_layout

\begin_layout Itemize
However, because that requires calculation, there is emphasis 
\end_layout

\begin_layout Itemize
Testing one parameter at a time is somewhat dangerous.
\end_layout

\begin_deeper
\begin_layout Itemize
z test, or Wald 
\begin_inset Formula $\chi^{2}$
\end_inset

 test, is approximate unless sample is very large
\end_layout

\begin_layout Itemize
remember ML coefficient estimates are known to be biased
\end_layout

\end_deeper
\begin_layout Itemize
Venables and Ripley (MASS) caution about a particular kind of numerical
 instability in Logit models, known as the Hauck Donner effect.
 
\end_layout

\begin_deeper
\begin_layout Itemize
They suggest that hypothesis tests be done with a likelihood ratio test
 comparing models that do and don't have a single variable.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{z-test and t-test: two approximations}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Asymptotically, 
\begin_inset Formula $\hat{\beta}$
\end_inset

 is Normal (recall fundamental ML Theory).
 What about the quantity: 
\begin_inset Formula 
\[
\frac{\hat{\beta}-\beta_{null}}{s.e.(\hat{\beta})}
\]

\end_inset


\end_layout

\begin_layout Itemize
it looks like a 
\begin_inset Formula $t-test$
\end_inset

, doesn't it? 
\end_layout

\begin_layout Itemize
More correct to say it is a 
\begin_inset Formula $z$
\end_inset

 statistic, approximately Normally distributed 
\begin_inset Formula 
\begin{equation}
z=\frac{\hat{\beta}-\beta_{null}}{s.e.(\hat{\beta})}\label{eq:logitttest}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Wald $
\backslash
chi^2$ test: another approximation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The Wald Chi-square is the ratio of the squared estimate to the variance,
\begin_inset Formula $\hat{\beta}^{2}/Var(\hat{\beta})$
\end_inset

.
 But alert users will note that it is simply 
\begin_inset Formula $z^{2}$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
z^{2}=\left(\frac{\hat{\beta}}{s.e.(\hat{\beta})}\right)^{2}\label{eq:zsquare}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Wald contended that value is distributed as a 
\begin_inset Formula $\chi^{2}$
\end_inset

 variable.
 The square root 
\begin_inset Formula $\hat{\beta}/se(\hat{\beta})$
\end_inset

 is approximately Normal (and also approximately t-distributed).
 That explains why some programs call the statistic 
\begin_inset Formula $\hat{\beta}/se(\hat{\beta})$
\end_inset

 a 
\begin_inset Formula $t$
\end_inset

 variable, while others call it a 
\begin_inset Formula $Z$
\end_inset

 statistic.
 
\end_layout

\begin_layout Itemize
From elementary statistics, we know that the square root of a 
\begin_inset Formula $\chi^{2}$
\end_inset

 variable with one degree of freedom is Normal(0,1), so the Wald Chi-Square
 test for a single parameter is actually substantively IDENTICAL to the
 
\begin_inset Formula $t$
\end_inset

 or 
\begin_inset Formula $z$
\end_inset

 approaches.
\end_layout

\begin_layout Itemize
The Wald Chi-Square can be used to simultaneously test several coefficients.
 
\begin_inset Formula 
\[
\hat{\beta}Var(\hat{b)}^{-1}\hat{\beta}
\]

\end_inset


\end_layout

\begin_layout Itemize
Note that if we were testing only one parameter, this degenerates to the
 preceding equation.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{likelihood ratio test (Compare nested models)}
\end_layout

\end_inset


\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset

Unrestricted
\begin_inset space ~
\end_inset


\begin_inset Quotes eld
\end_inset

Full
\begin_inset Quotes erd
\end_inset


\begin_inset space ~
\end_inset

Model.
 Let 
\begin_inset Formula $L_{max}$
\end_inset

 be the value of the likelihood function at its maximum, when all coefficients,
 the slope and the intercept, are estimated to maximize the likelihood.
\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset

Restricted
\begin_inset space ~
\end_inset

Model.
 Set some parameter at a fixed value, possibly 0.
 Let 
\begin_inset Formula $L_{0}$
\end_inset

 be the value of the likelihood function in which the "slope" coefficient
 
\begin_inset Formula $\beta_{1}$
\end_inset

 (or other coefficients if they are in the model) is 0.
\end_layout

\begin_layout Itemize
The likelihood ratio test can be used to compare 
\series bold
nested
\series default
 models that are estimated ON THE 
\series bold
SAME DATA
\series default
 
\end_layout

\begin_layout Description
Compare
\begin_inset space ~
\end_inset


\begin_inset Formula $L_{max}$
\end_inset

 and 
\begin_inset Formula $L_{0}$
\end_inset

 with a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Let 
\begin_inset Formula $\lambda$
\end_inset

, (Greek 
\begin_inset Quotes eld
\end_inset

lambda
\begin_inset Quotes erd
\end_inset

), be the ratio of 
\begin_inset Formula $L_{0}$
\end_inset

 to 
\begin_inset Formula $L_{max}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\lambda\quad=\frac{L_{0}}{L_{max.}}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula $-2\cdot\ln(\lambda)$
\end_inset

 has a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution with 
\begin_inset Formula $k$
\end_inset

 degrees of freedom, where 
\begin_inset Formula $k$
\end_inset

 is the difference in the number of coefficients in 
\begin_inset Formula $L_{0}$
\end_inset

 versus 
\begin_inset Formula $L_{max}$
\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Where do they get standard errors?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Fisher showed that the second derivative matrix of the likelihood function,
 dubbed the 
\begin_inset Quotes eld
\end_inset

Information matrix
\begin_inset Quotes erd
\end_inset

, can be used to derive a variance-covariance matrix for the coefficient
 estimates.
\end_layout

\begin_deeper
\begin_layout Itemize
The var-covar matrix is -1 times the inverse of the information matrix
\end_layout

\end_deeper
\begin_layout Itemize
The estimator for 
\begin_inset Formula $\hat{\beta}$
\end_inset

 is wandering about in a 
\begin_inset Formula $p$
\end_inset

 dimensional space, trying to find the h
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Where do they get standard errors?...}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Here's an intuition: 
\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Itemize
If the likelihood surface looks like a sharply peaked mountain, then we
 are very confident we are at the maximum, and the standard errors will
 be small.
\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename importfigs/the-mountain-top-feeling-family.jpg
	width 6cm

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename importfigs/mountain-medium.jpeg
	width 6cm

\end_inset


\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Itemize
If the likelihood surface looks like a rounded weathered foothill, then
 we are uncertain about the estimates, and the standard errors will be big.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Itemize
And if the likelihood surface looks like a mole hill, we stop doing this
 kind of work for a while
\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename importfigs/molehill.jpeg
	width 6cm

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Anything to say about variance-covariance?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The Variance matrix in logistic regression is interestingly similar to OLS
\end_layout

\begin_deeper
\begin_layout Itemize
OLS:
\begin_inset Formula 
\begin{equation}
Var(\hat{\beta}^{OLS})=\sigma^{2}(X'X)^{-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Logistic Regression:
\begin_inset Formula 
\begin{equation}
Var(\hat{\beta}^{logistic})=\left[X'WX\right]^{-1}\label{eq:varcovar}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $W$
\end_inset

 has the estimated probabilities for the individual cases:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
W=\left[\begin{array}{ccccc}
P_{1}(1-P_{1}) & 0 & 0 & 0 & 0\\
0 & P_{2}(1-P_{2}) & 0 & 0 & 0\\
0 & \cdots\\
0 & \cdots\\
0 & 0 & 0 & 0 & P_{N}(1-P_{N})
\end{array}\right]\label{eq:varmatrix}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
This variance-covariance matrix is rather similar to what we would get if
 we used WLS in the linear probability model.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Model Goodness
\end_layout

\begin_layout Subsection
Percent Correctly Predicted and ROC
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Predicted value table}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Use the predicted probabilities 
\begin_inset Formula $P_{i}$
\end_inset

 to predict 0 or 1 for each case
\end_layout

\begin_layout Itemize
The 
\emph on
percent correctly predicted
\emph default
 has sometimes been emphasized as a summary of model accuracy
\end_layout

\begin_deeper
\begin_layout Itemize
However, usually it is uninformative
\end_layout

\begin_layout Itemize
E.g., if 80% of the observations are 1, then a model that predicts 1 for all
 cases will be correct 80% of the time.
\end_layout

\end_deeper
\begin_layout Itemize
Need a way to penalize by accounting for incorrect predictions.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Confusion matrix}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Make a table like so.
 Commonly called a 
\begin_inset Quotes eld
\end_inset

confusion matrix
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="6">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Predicted
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Count in Data
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Observed
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
true-negative (TN)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
false-positive(FP)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N (#0's)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
false-negative (FN)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
true-positive(TP)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
P (#1's)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
true positive rate (TPR), also called 
\begin_inset Quotes eld
\end_inset

sensitivity
\begin_inset Quotes erd
\end_inset


\begin_inset Formula 
\[
sensitivity=\frac{TP}{TP+FN}
\]

\end_inset


\end_layout

\begin_layout Itemize
true negative rate (TNR), also called 
\begin_inset Quotes eld
\end_inset

specificity
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula 
\[
specificity=\frac{TN}{TN+FP}
\]

\end_inset


\end_layout

\begin_layout Itemize
accuracy is the plain old 
\begin_inset Quotes eld
\end_inset

percent correctly predicted
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula 
\[
\frac{TN+TP}{TP+TN+FP+FN}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{ROC}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
ROC Curve: Receiver Operating Characteristic curve is a visual summary of
 how the model's fit with the data will depend on alternative methods of
 calculating predictions.
\end_layout

\begin_layout Itemize
Before I used simple idea that dividing between 0 and 1 is 
\begin_inset Formula $P_{i}=0.5$
\end_inset


\end_layout

\begin_layout Itemize
Now we change the threshold, called 
\begin_inset Formula $\tau$
\end_inset

, or lower it, to somehow make the predictions fit the data more accurately.
\end_layout

\begin_layout Itemize
Perhaps if we raise the threshold to predict 1 to 
\begin_inset Formula $.6$
\end_inset

, we will make fewer 
\begin_inset Quotes eld
\end_inset

false positive predictions
\begin_inset Quotes erd
\end_inset

 and have more 
\begin_inset Quotes eld
\end_inset

true negatives
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{ROC diagram (from the LogitProbit-Worked Example)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{importfigs/t-roc20.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Explaining that ROC diagram}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Take the predicted probabilities from the model, 
\begin_inset Formula $\hat{p}_{i}$
\end_inset

, and calculate predictions for a cutoff point, 
\begin_inset Formula $\tau$
\end_inset

.
 
\end_layout

\begin_layout Standard
Predicted 
\begin_inset Formula $y$
\end_inset

 (0 or 1) is based on 
\begin_inset Formula $\hat{p}_{i}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{y}_{i}(\tau)=\begin{cases}
1\, & \hat{p}_{i}\geq\tau\\
0 & else
\end{cases}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We vary 
\begin_inset Formula $\tau$
\end_inset

 from 
\begin_inset Formula $1$
\end_inset

 to 
\begin_inset Formula $0$
\end_inset

 (predictions begin as all 0's, and end up at all 1's).
 
\end_layout

\begin_layout Standard
As we vary 
\begin_inset Formula $\tau$
\end_inset

, we 
\begin_inset Quotes eld
\end_inset

trace
\begin_inset Quotes erd
\end_inset

 the curve in previous slide.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
LLR equivalent of an F test
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{anova test in linear models}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
when our linear predictor is 
\begin_inset Formula $\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+\ldots+\beta_{p}xp_{i}$
\end_inset


\end_layout

\begin_layout Itemize
Linear regression output includes an F test, which is a test of that larger
 fitted model against a linear predictor that includes only the intercept
\begin_inset Formula 
\[
y_{i}=\beta_{0}+\varepsilon_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
That 
\begin_inset Formula $F$
\end_inset

 asks 
\begin_inset Quotes eld
\end_inset

are all of my predictor coefficients equal to 0
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
not a very informative test, but we often do report it.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The ML equivalent of and F test}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
A statistic, often referred to as a 
\begin_inset Quotes eld
\end_inset

model 
\begin_inset Formula $\chi^{2}$
\end_inset


\begin_inset Quotes erd
\end_inset

 test, can be calculated as a likelihood ratio test.
\end_layout

\begin_layout Itemize
The value referred to in my regression tables, -2LLR, is approximately distribut
ed as a 
\begin_inset Formula $\chi^{2}$
\end_inset

 statistic:
\begin_inset Formula 
\[
-2ln\left[\frac{likelihood\,of\,intercept\,only\,model}{likelihood\,of\,model\,including\,predictors}\right]
\]

\end_inset


\end_layout

\begin_layout Itemize
If this value is large, it means at least one of the predictor coefficients
 is not 0.
 
\end_layout

\begin_deeper
\begin_layout Itemize
again, not very informative
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Deviance
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Deviance to diagnose model specification}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Here we think of model comparison in a different direction
\end_layout

\begin_layout Itemize
A 
\begin_inset Quotes eld
\end_inset


\series bold
saturated model
\series default

\begin_inset Quotes erd
\end_inset

 is one in which we are include unique a unique predictors for each combination
 of the input variables.
\end_layout

\begin_deeper
\begin_layout Itemize
The saturated model typically has likelihood 1, its predicted values exactly
 match the observed data.
\end_layout

\begin_layout Itemize
Saturated model log likelihood is thus usually 
\begin_inset Formula $0$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
If a fitted model's likelihood is very far from the saturated model, then
 perhaps 
\begin_inset Quotes eld
\end_inset

something is wrong.
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_deeper
\begin_layout Itemize
Maybe more predictors are needed? 
\end_layout

\begin_layout Itemize
Maybe the functional form should be changed? 
\end_layout

\begin_layout Itemize
New probability model?
\end_layout

\end_deeper
\begin_layout Itemize
The standard output for a logistic regression includes 2 values
\end_layout

\begin_deeper
\begin_layout Itemize
Null Deviance
\end_layout

\begin_layout Itemize
Residual Deviance
\end_layout

\end_deeper
\begin_layout Itemize
Residual deviance is difference between a 
\begin_inset Quotes eld
\end_inset

saturated
\begin_inset Quotes erd
\end_inset

 model and your 
\begin_inset Quotes eld
\end_inset

fitted
\begin_inset Quotes erd
\end_inset

 model
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
-2ln\left[\frac{Likelihood\,of\,fitted\,model}{Likelihood\,of\,saturated\,model}\right]
\end{equation}

\end_inset


\begin_inset Newline newline
\end_inset

 
\end_layout

\begin_layout Standard
it usually boils down to
\begin_inset Formula 
\[
-2ln(Likelihood\,of\,fitted\,model)
\]

\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
Residual deviance, which is commonly referred to as Deviance, indicates
 of 
\begin_inset Quotes eld
\end_inset

how bad
\begin_inset Quotes erd
\end_inset

 your model is when compared against the saturated model.
 
\end_layout

\begin_layout Itemize
Myers, Montgomery, and Vining (2002) observe, (I'm paraphrasing notation
 here to match the above notation) 
\begin_inset Quotes eld
\end_inset

Formally, an insignificant value of (deviance) in a one-tailed test implies
 that the fit of the model is not significantly worse than that of the saturated
 model.
 ...
 Often the rule of thumb is applied that the quality of fit is reasonable
 if 
\begin_inset Formula $\frac{deviance}{N-p}$
\end_inset

 is not appreciably larger than 1.
 The rule of thumb is prompted by the fact that N-p is the mean of the 
\begin_inset Formula $\chi_{N-p}^{2}$
\end_inset

 distribution
\begin_inset Quotes erd
\end_inset

(p.
 113).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Why no R square
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{$R^2$?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
several approximate 
\begin_inset Formula $R^{2}$
\end_inset

 statistics have been proposed
\end_layout

\begin_layout Itemize
Since I think 
\begin_inset Formula $R^{2}$
\end_inset

 is silly in ordinary linear models, you can guess how excited I am to work
 on approximate or 
\begin_inset Quotes eld
\end_inset

pseudo 
\begin_inset Formula $R^{2}$
\end_inset


\begin_inset Quotes erd
\end_inset

 for logit models.
\end_layout

\begin_layout Itemize
What is silly about 
\begin_inset Formula $R^{2}$
\end_inset

.
 Read King(1986)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Hosmer and Lemeshow test
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{H-L test: Do your Predicted Probabilities Match Observed Percentages?
}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Calculate predicted probabilities, 
\begin_inset Formula $\hat{P_{i}}$
\end_inset

 for all cases.
 
\end_layout

\begin_layout Itemize
Sort the data by 
\begin_inset Formula $\hat{P}_{i}$
\end_inset

.
 Subdivide the sample into subgroups.
 
\end_layout

\begin_layout Itemize
Find out if the observed frequency of 1's and 0's matches the estimated
 probabilities from the model.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{H-L Test boils down to a $
\backslash
chi^2$ statistic}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Pick some pleasant number of subgroups, say 10.
 For each subgroup, one can calculate the observed 
\begin_inset Quotes eld
\end_inset

success rate
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $O_{i}$
\end_inset

 and an expected (from the model) success rate, and the 
\begin_inset Formula $\chi^{2}$
\end_inset

 test is used to find out if the model is grossly out-of-whack.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
homer.and.lemeshow_{\chi}^{2}=\sum_{i=1}^{10}\left[\frac{(O_{i}-E_{i})^{2}}{E_{i}}\right]\label{eq:hosmer}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
If the 
\begin_inset Formula $\chi^{2}$
\end_inset

 value is extreme by that standard, it means that your predicted probabilities
 do not match the observations very well.
\end_layout

\begin_layout Standard
That is informative, but not too informative.
 It does not tell you if the model is 
\begin_inset Quotes eld
\end_inset

off
\begin_inset Quotes erd
\end_inset

 for any particular reason, and there could be many suspects in your search
 for the criminal.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset Note Note
status open

\begin_layout Subsection
Overdispersion
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Overdispersion: Extra-Binomial Variation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Suppose your deviance is very high.
 
\end_layout

\begin_layout Itemize
The Logit model assumes the binomial variance is 
\begin_inset Formula $P_{i}(1-P_{1})$
\end_inset

 
\end_layout

\begin_layout Itemize
That means that when the model has 
\begin_inset Formula $\hat{P}=0.9$
\end_inset

, there's only a very small chance you will observe a 0.
 Sometimes you observe more 0's and 1's in the extremes than you expect.
\end_layout

\begin_layout Itemize
The cause may be 
\begin_inset Quotes eld
\end_inset

frailty
\begin_inset Quotes erd
\end_inset

, an extra amount of randomness in your study responses.
 This 
\begin_inset Quotes eld
\end_inset

extrabinomial variation
\begin_inset Quotes erd
\end_inset

 might be the cause of your poor fit.
\end_layout

\begin_layout Itemize
The effects of overdispersion are the same as heteroskedasticity in the
 OLS model.
 The estimated variance-covariance matrix of the 
\begin_inset Formula $\hat{\beta}$
\end_inset

's does not match the true variance of the 
\begin_inset Formula $\hat{\beta}$
\end_inset

's.
\end_layout

\begin_layout Itemize
Perhaps departure/respecification is needed.
 For example, instead of assuming that all cases with the same inputs should
 have the same predicted probability, suppose instead there is an unmeasured
 error term that affects the subgroups in the dataset.
 So, if one started with 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:probit2"

\end_inset

, one could insert an error term, a random component that afflicts the members
 of group 
\begin_inset Formula $j$
\end_inset

: 
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
P(y_{i}=1|X_{i},\beta_{i})=\Phi(\beta_{0}+\beta_{1}X_{i}+e_{j})\label{eq:frailty}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
This model is a mixed model, one in which there is a random coefficient
 that should be taken into account.
 In R, it is covered in the lmer procedure of lme4 package or the GLMM package
 (which is simpler to use at the current time) 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{References}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "theme/R"
options "apalike2"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Session}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sess10>>=
\end_layout

\begin_layout Plain Layout

sessionInfo()
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<opts20, include=F>>=
\end_layout

\begin_layout Plain Layout

## Don't delete this.
 It puts the interactive session options
\end_layout

\begin_layout Plain Layout

## back the way they were.
 If this is compiled within a session
\end_layout

\begin_layout Plain Layout

## it is vital to do this.
\end_layout

\begin_layout Plain Layout

options(opts.orig)
\end_layout

\begin_layout Plain Layout

options(par.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
