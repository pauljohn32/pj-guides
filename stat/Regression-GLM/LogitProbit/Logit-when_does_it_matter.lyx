#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble
\usepackage{dcolumn}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{graphicx}
%\newcommand\makebeamertitle{\frame{\maketitle}}%
\renewcommand{\doiprefix}{doi:\kern-1pt}
\setlength{\bibsep}{10pt}

% use 'handout' to produce handouts
%\documentclass[handout]{beamer}
\usepackage{wasysym}
\usepackage{pgfpages}
%for bold upright roman in math for matrix algebra
\newcommand{\vn}[1]{\mbox{{\it #1}}}\newcommand{\vb}{\vspace{\baselineskip}}\newcommand{\vh}{\vspace{.5\baselineskip}}\newcommand{\vf}{\vspace{\fill}}\newcommand{\splus}{\textsf{S-PLUS}}\newcommand{\R}{\textsf{R}}


%%paste in guidePreambleSweavel.tex
%%% From beamer slide:
\usepackage{Sweave}
%% 
%% This controls display of code chunks
\usepackage{ae,fancyvrb,relsize,listings}

\providecommand{\Sweavesize}{\normalsize}
\providecommand{\Rsize}{}
\renewcommand{\Rsize}{\normalsize}
\providecommand{\Routsize}{\scriptsize}

\providecommand{\Rcolor}{\color[rgb]{0.1, 0.1, 0.1}}
\providecommand{\Routcolor}{\color[rgb]{0.2, 0.2, 0.2}}
\providecommand{\Rcommentcolor}{\color[rgb]{0.101, 0.43, 0.432}}

\providecommand{\Rbackground}{\color[gray]{0.91}}
\providecommand{\Routbackground}{\color[gray]{0.935}}
% Can specify \color[gray]{1} for white background or just \color{white}

\lstdefinestyle{Rinput}{
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  basicstyle=\Rsize\Rcolor\ttfamily,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%,
  commentstyle=\Rcommentcolor\ttfamily,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1{==}{{=\,=}}2{--}{{-\,-}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},%
  backgroundcolor=\Rbackground,%
  numbers=left,%
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}%

% Other options of interest:
% frame=single,framerule=0.1pt,framesep=1pt,rulecolor=\color{blue},
% numbers=left,numberstyle=\tiny,stepnumber=1,numbersep=7pt,
% keywordstyle={\bf\Rcolor}

\lstdefinestyle{Routput}{fancyvrb=false,
  literate={~}{{$\sim$}}1{R^2}{{$R^{2}$}}2{^}{{$^{\scriptstyle\wedge}$}}1{R-squared}{{$R^{2}$}}2,%
  basicstyle=\Routcolor\Routsize\ttfamily,%
  backgroundcolor=\Routbackground,
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1 {==}{{=\,=}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},
  numbers=left,
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}

\renewenvironment{Schunk}{}{}
\renewenvironment{Sinput}{}{}
\let\Sinput\relax
\let\Scode\relax
\let\Soutput\relax
\lstnewenvironment{Sinput}{\lstset{style=Rinput}}{}
\lstnewenvironment{Scode}{\lstset{style=Rinput}}{}
\lstnewenvironment{Soutput}{\lstset{style=Routput}}{}

\lstset{tabsize=2, breaklines=true, style=Rinput, breakatwhitespace=true}

\fvset{listparameters={\setlength{\topsep}{0em}}}

\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.90}
\usepackage{realboxes}
\providecommand*{\code}[1]{\texttt{#1}}
\renewcommand{\code}[1]{%
\Colorbox{light-gray}{#1}%
}%
%%end paste in guidePreambleSweavel.tex

\usepackage[natbibapa]{apacite}

\definecolor{darkblue}{HTML}{1e2277}

%would be in beamerthemekucrmda%
\mode<presentation>
\definecolor{kublue}{RGB}{0,81,186}
\usefonttheme{professionalfonts}
\useoutertheme{infolines}
\useinnertheme{rounded}
%disable rounded for alert and example boxes%
\setbeamertemplate{blocks}[default]
\usecolortheme{whale}
\usecolortheme{orchid}
\setbeamercolor{structure}{bg=kublue,fg=kublue!90!black}
%\setbeamercolor{structure}{fg=kublue}
\setbeamercolor{frametitle}{bg=kublue}
\setbeamercolor{section in toc}{fg=kublue!40!black}

\setbeamertemplate{frametitle continuation}[from second]
\renewcommand\insertcontinuationtext{...}
\beamertemplatenavigationsymbolsempty
%end of beamerthemekucrmda%

%If you want bigger margins, try this:
\setbeamersize{text margin left=05mm,text margin right=10mm} 
\hypersetup{colorlinks,allcolors=.,urlcolor=darkblue}
%Following seems to have no effect now
%\usepackage{handoutWithNotes}
%\pgfpagesuselayout{3 on 1 with notes}[letterpaper, border shrink=5mm]

\titlegraphic{\includegraphics[width=6cm]{theme/logo}}
\end_preamble
\options aspectratio=1609
\use_default_options false
\begin_modules
logicalmkup
sweave
natbibapa
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref false
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\branch R
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch semboot
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\branch cfalvm
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Branch R
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% tmpout directory must exist first
\end_layout

\begin_layout Plain Layout

<<tmpout, echo=FALSE, include=FALSE, results=hide>>=
\end_layout

\begin_layout Plain Layout

if(!dir.exists("tmpout")) dir.create("tmpout", showWarnings=FALSE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=tmpout/t,split=T,ae=F,height=4.5,width=7,concordance=FALS
E}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Roptions, echo=F>>=
\end_layout

\begin_layout Plain Layout

opts.orig <- options()
\end_layout

\begin_layout Plain Layout

options(width=100, prompt = " ", continue = "  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE)
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

par.orig <- par(no.readonly = TRUE) 
\end_layout

\begin_layout Plain Layout

pjmar <- c(4.1, 4.1, 1.5, 2.1)
\end_layout

\begin_layout Plain Layout

par(mar=pjmar, ps=11)
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(mar=pjmar, ps=12, xpd=F)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=F,family="Times",pointsize=12)
\end_layout

\begin_layout Plain Layout

if(!file.exists("tmpout")) dir.create("tmpout", showWarnings=F)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Title
When is a Linear Model 
\begin_inset Quotes eld
\end_inset

as good
\begin_inset Quotes erd
\end_inset

 as Logistic Regression?
\begin_inset Argument 1
status open

\begin_layout Plain Layout
logit
\end_layout

\end_inset


\end_layout

\begin_layout Subtitle
Very small note
\end_layout

\begin_layout Author
Paul Johnson
\begin_inset Flex InstituteMark
status open

\begin_layout Plain Layout
1
\end_layout

\end_inset


\end_layout

\begin_layout Institute
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
1
\end_layout

\end_inset

CRMDA, University of Kansas 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
CRMDA
\end_layout

\end_inset


\end_layout

\begin_layout Date
2020
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
logo{
\backslash
includegraphics[width=5mm]{theme/logomini}}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
The following causes the table of contents to be shown at the beginning
 of every subsection.
 Delete this, if you do not want it.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
AtBeginSection[]{
\end_layout

\begin_layout Plain Layout

  
\backslash
frame<beamer>{ 
\end_layout

\begin_layout Plain Layout

    
\backslash
frametitle{Outline}
\end_layout

\begin_layout Plain Layout

    
\backslash
tableofcontents[currentsection, currentsubsection] 
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Outline}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%following is LyX shortcut 
\backslash
vb for bold upright math for matrices
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\vb}[1]{\bm{\mathrm{#1}}}
\end_inset


\end_layout

\begin_layout Section
Similarity of linear and logistic fits
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The "true" model}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
This uses R 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "RCore"
literal "false"

\end_inset

 to do a simple illustration, adapting a student's example from POLS707
\end_layout

\begin_layout Itemize
The predictor is coded 1 through 7 (political ideology)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<include=F, echo=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

set.seed(12323)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s6_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

library(rockchalk)
\end_layout

\begin_layout Plain Layout

x <- sample(1:7, size = 1000, replace = TRUE)
\end_layout

\begin_layout Plain Layout

xseq <- 1:7
\end_layout

\begin_layout Plain Layout

beta0 <- -1
\end_layout

\begin_layout Plain Layout

beta1 <- .2
\end_layout

\begin_layout Plain Layout

pry <- function(x, k0, k1){
\end_layout

\begin_layout Plain Layout

   exp(k0 + k1 * x)/(1 + exp(k0 + k1 * x))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

trueprob <- pry(xseq, beta0, beta1)
\end_layout

\begin_layout Plain Layout

plot(1:7, trueprob, type="l",xlab='x',ylab='Probability(y=1)', col = "gray70",
\end_layout

\begin_layout Plain Layout

     main = paste("The True Model, beta0 =", beta0, ", beta1 = ", beta1),
\end_layout

\begin_layout Plain Layout

     ylim = c(0,1))
\end_layout

\begin_layout Plain Layout

rug(x)
\end_layout

\begin_layout Plain Layout

points(xseq, trueprob)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1)
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s6_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic Predicted Probabilities}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

m1 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

summary(m1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s1, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

plotCurves(m1, plotx = "x", ylab = "Logistic Probability(y = 1)", legendArgs=
\begin_inset Quotes erd
\end_inset

none
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(xseq, trueprob, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Logistic Estimate", "True Logistic"), lty
 = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Linear Probability Model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
glm(family=gaussian) is same as lm() !
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

m2 <- glm(yobs ~ x, family = gaussian)
\end_layout

\begin_layout Plain Layout

summary(m2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s2, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

plotCurves(m2, plotx = "x", ylab = "Linear Probability(y = 1)", legendArgs=
\begin_inset Quotes erd
\end_inset

none
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(xseq, trueprob, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Linear Prediction", "True Logistic"), lty
 = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-s2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Predicted values are very very close}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s3>>=
\end_layout

\begin_layout Plain Layout

## The logistic model
\end_layout

\begin_layout Plain Layout

predictOMatic(m1, predVals = list(x=1:7), type = "response")
\end_layout

\begin_layout Plain Layout

## The linear model
\end_layout

\begin_layout Plain Layout

predictOMatic(m2, predVals = list(x=1:7), type = "response")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{How to make sense out of that?}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
One guess: imagine predictor had wider range
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s4, fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(m1, plotx = "x", ylab = "Logistic Probability(y = 1)", legendArgs=
\begin_inset Quotes erd
\end_inset

none
\begin_inset Quotes erd
\end_inset

, plotxRange = c(-10, 15))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Linear model eventually goes 
\begin_inset Quotes eld
\end_inset

out of bounds
\begin_inset Quotes erd
\end_inset

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s5, fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(m2, plotx = "x", ylab = "Linear Probability(y = 1)", legendArgs=
\begin_inset Quotes erd
\end_inset

none
\begin_inset Quotes erd
\end_inset

, plotxRange = c(-10, 15))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Linear and Logistic differences appear on wider range}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s5, fig=T>>=
\end_layout

\begin_layout Plain Layout

plotCurves(m2, plotx = "x", ylab = "Linear Probability(y = 1)", legendArgs=
\begin_inset Quotes erd
\end_inset

none
\begin_inset Quotes erd
\end_inset

, plotxRange = c(-10, 15))
\end_layout

\begin_layout Plain Layout

m1.pom <- predictOMatic(m1, predVals = list(x = seq(-10, 15)))
\end_layout

\begin_layout Plain Layout

lines(fit ~ x, m1.pom, col = 
\begin_inset Quotes eld
\end_inset

red
\begin_inset Quotes erd
\end_inset

, lty = 2, lwd = 3)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Linear Prediction", "Logistic Prediction"),
 lty = c(1, 2),col=c(
\begin_inset Quotes eld
\end_inset

black
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

red
\begin_inset Quotes erd
\end_inset

), lwd = c(1,3))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Repeat with more dramatic slope
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The "true" model with higher beta coefficient}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<include=F, echo=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

set.seed(12323)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<t0, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

xseq <- 1:7
\end_layout

\begin_layout Plain Layout

beta0 <- -1
\end_layout

\begin_layout Plain Layout

beta1 <- .5
\end_layout

\begin_layout Plain Layout

pry <- function(x, k0, k1){
\end_layout

\begin_layout Plain Layout

   exp(k0 + k1 * x)/(1 + exp(k0 + k1 * x))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

trueprob <- pry(xseq, beta0, beta1)
\end_layout

\begin_layout Plain Layout

plot(1:7, trueprob, type="l",xlab='x',ylab='Probability(y=1)', col = "gray70",
\end_layout

\begin_layout Plain Layout

     main = paste("The True Model, beta0 =", beta0, ", beta1 = ", beta1),
\end_layout

\begin_layout Plain Layout

     ylim = c(0,1))
\end_layout

\begin_layout Plain Layout

rug(x)
\end_layout

\begin_layout Plain Layout

points(xseq, trueprob)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-t0}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic Predicted Probabilities}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<t1, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1)
\end_layout

\begin_layout Plain Layout

yobs <- rbinom(n = length(ypr), size = 1, prob = ypr)
\end_layout

\begin_layout Plain Layout

m1 <- glm(yobs ~ x, family = "binomial")
\end_layout

\begin_layout Plain Layout

plotCurves(m1, plotx = "x", ylab = "Logistic Probability(y = 1)", legendArgs=
\begin_inset Quotes erd
\end_inset

none
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(xseq, trueprob, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Logistic Estimate", "True Logistic"), lty
 = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-t1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Linear Probability Model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<t2, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

m2 <- glm(yobs ~ x, family = gaussian)
\end_layout

\begin_layout Plain Layout

plotCurves(m2, plotx = "x", ylab = "Linear Probability(y = 1)", legendArgs=
\begin_inset Quotes erd
\end_inset

none
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(xseq, trueprob, lty = 2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = c("Linear Prediction", "True Logistic"), lty
 = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-t2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Predicted values are not so very very close}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<t3>>=
\end_layout

\begin_layout Plain Layout

## The logistic model
\end_layout

\begin_layout Plain Layout

predictOMatic(m1, predVals = list(x=1:7), type = "response")
\end_layout

\begin_layout Plain Layout

## The linear model
\end_layout

\begin_layout Plain Layout

predictOMatic(m2, predVals = list(x=1:7), type = "response")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
And the Answer Is
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{When does the OLS model do 
\begin_inset Quotes eld
\end_inset

as well
\begin_inset Quotes erd
\end_inset

?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
If the 
\begin_inset Quotes eld
\end_inset

range
\begin_inset Quotes erd
\end_inset

 of the predictor is narrow, then there is not much curvature visible within
 the data range.
\end_layout

\begin_layout Itemize
If the slope coefficient is small, then the S shaped curve is very elongated.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
What about a dichotomy?
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Here is a shocking fact}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The predicted probabilities from a model that uses a categorical predictor
 are identical, whether we use a logistic or a linear model
\end_layout

\begin_layout Itemize
The linear model cannot 
\begin_inset Quotes eld
\end_inset

wander out of bounds
\begin_inset Quotes erd
\end_inset

 because each level of the predictor gets a new coefficient that causes
 the predicted value to match the data exactly.
\end_layout

\begin_layout Itemize
I'm going to have to dial up the coefficients so you can see what's going
 on.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The True probability model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<include=F, echo=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

set.seed(12323)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<dummy0, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

x <- sample(0:1, size = 1000, replace = TRUE)
\end_layout

\begin_layout Plain Layout

xdummy <- 0:1
\end_layout

\begin_layout Plain Layout

beta0 <- -2
\end_layout

\begin_layout Plain Layout

beta1 <- 3.3
\end_layout

\begin_layout Plain Layout

pry <- function(x, k0, k1){
\end_layout

\begin_layout Plain Layout

   exp(k0 + k1 * x)/(1 + exp(k0 + k1 * x))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

trueprob <- pry(xdummy, beta0, beta1)
\end_layout

\begin_layout Plain Layout

plot(0:1, trueprob, type="n",xlab='x',ylab='Probability(y=1)', col = "gray70",
\end_layout

\begin_layout Plain Layout

     main = paste("The True Model, beta0 =", beta0, ", beta1 = ", beta1),
\end_layout

\begin_layout Plain Layout

     ylim = c(0,1))
\end_layout

\begin_layout Plain Layout

xseq <- seq(0, 1, length.out=10000)
\end_layout

\begin_layout Plain Layout

lines(xseq, pry(xseq, beta0, beta1))
\end_layout

\begin_layout Plain Layout

rug(x)
\end_layout

\begin_layout Plain Layout

points(xdummy, trueprob)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-dummy0}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic Predicted Probabilities}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<dum0, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1)
\end_layout

\begin_layout Plain Layout

dat <- data.frame(yobs=rbinom(n = length(ypr), size = 1, prob = ypr),
\end_layout

\begin_layout Plain Layout

                  ypr = ypr, x = x)
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Observed Proportions}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

pctable(yobs ~ x, data = dat)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Fit the Logit Model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<dum1, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

m1 <- glm(yobs ~ x, family = "binomial", data=dat)
\end_layout

\begin_layout Plain Layout

plotCurves(m1, plotx = "x", ylab = "Logistic Probability(y = 1)", legendArgs
 = 
\begin_inset Quotes eld
\end_inset

none
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(xseq, pry(xseq, beta0, beta1), lty=2)
\end_layout

\begin_layout Plain Layout

legend("top", legend = c("Logistic Estimate", "True Logistic"), lty = c(1,
 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-dum1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Sorry, did you want to see the logistic regression output?
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

summary(m1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Linear Probability Model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<dum2, fig = TRUE, echo=FALSE, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

m2 <- glm(yobs ~ x, family = gaussian, data = dat)
\end_layout

\begin_layout Plain Layout

plotCurves(m2, plotx = "x", ylab = "Linear Probability(y = 1)", legendArgs
 = 
\begin_inset Quotes eld
\end_inset

none
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Plain Layout

lines(xseq, pry(xseq, beta0, beta1), lty=2)
\end_layout

\begin_layout Plain Layout

legend("top", legend = c("Linear Prediction", "True Logistic"), lty = c(1,
 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-dum2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Sorry, did you want to see the linear model regression output?
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

summary(m2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Shock: Predicted values same}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<dum3>>=
\end_layout

\begin_layout Plain Layout

## The logistic model
\end_layout

\begin_layout Plain Layout

(m1p1 <- predictOMatic(m1, predVals = 
\begin_inset Quotes eld
\end_inset

margins
\begin_inset Quotes erd
\end_inset

, type = "response"))
\end_layout

\begin_layout Plain Layout

## The linear model
\end_layout

\begin_layout Plain Layout

(m2p1 <- predictOMatic(m2, predVals = 
\begin_inset Quotes eld
\end_inset

margins
\begin_inset Quotes erd
\end_inset

, type = "response"))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Even more shocking, the predicted values exactly match the observed proportions!
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{But the lines are not exactly identical}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<dum5, fig=T, echo=F, include=F>>=
\end_layout

\begin_layout Plain Layout

plotCurves(m1, plotx = "x", ylab = "Probability(y = 1)", legendArgs = 
\begin_inset Quotes eld
\end_inset

none
\begin_inset Quotes erd
\end_inset

, plotPoints=FALSE)
\end_layout

\begin_layout Plain Layout

abline(m2, lty = 2, lwd = 2)
\end_layout

\begin_layout Plain Layout

legend("top", legend = c("Logistic", "Linear"), lty = c(1, 2), lwd = c(2,1))
\end_layout

\begin_layout Plain Layout

points(x = m1p1$x$x, y=m1p1$x$fit)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-dum5}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What is the lesson supposed to be?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Lots of methods teachers are hysterical if a student fits a linear regression
 with data that seems categorical
\end_layout

\begin_layout Itemize
If we are only worried about predicted probabilities, both seem OK
\end_layout

\begin_layout Itemize
The OLS model has heteroskedasticity and the standard errors are incorrect,
 so we'd need to 
\end_layout

\begin_deeper
\begin_layout Itemize
re-estimate with WLS, or
\end_layout

\begin_layout Itemize
use robust standard errors
\end_layout

\end_deeper
\begin_layout Itemize
The major dangers with the linear model arise when there are numerical predictor
s, ones which can go out of bounds.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{References}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "theme/R"
options "apalike2"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Session}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sess10>>=
\end_layout

\begin_layout Plain Layout

sessionInfo()
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<opts20, include=F>>=
\end_layout

\begin_layout Plain Layout

## Don't delete this.
 It puts the interactive session options
\end_layout

\begin_layout Plain Layout

## back the way they were.
 If this is compiled within a session
\end_layout

\begin_layout Plain Layout

## it is vital to do this.
\end_layout

\begin_layout Plain Layout

options(opts.orig)
\end_layout

\begin_layout Plain Layout

options(par.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
