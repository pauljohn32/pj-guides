#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble
\usepackage{dcolumn}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{graphicx}
\newcommand\makebeamertitle{\frame{\maketitle}}%
\renewcommand{\doiprefix}{doi:\kern-1pt}
\setlength{\bibsep}{10pt}

% use 'handout' to produce handouts
%\documentclass[handout]{beamer}
\usepackage{wasysym}
\usepackage{pgfpages}
%for bold upright roman in math for matrix algebra
\newcommand{\vn}[1]{\mbox{{\it #1}}}\newcommand{\vb}{\vspace{\baselineskip}}\newcommand{\vh}{\vspace{.5\baselineskip}}\newcommand{\vf}{\vspace{\fill}}\newcommand{\splus}{\textsf{S-PLUS}}\newcommand{\R}{\textsf{R}}


%%paste in guidePreambleSweavel.tex
%%% From beamer slide:
\usepackage{Sweave}
%% 
%% This controls display of code chunks
\usepackage{ae,fancyvrb,relsize,listings}

\providecommand{\Sweavesize}{\normalsize}
\providecommand{\Rsize}{}
\renewcommand{\Rsize}{\normalsize}
\providecommand{\Routsize}{\scriptsize}

\providecommand{\Rcolor}{\color[rgb]{0.1, 0.1, 0.1}}
\providecommand{\Routcolor}{\color[rgb]{0.2, 0.2, 0.2}}
\providecommand{\Rcommentcolor}{\color[rgb]{0.101, 0.43, 0.432}}

\providecommand{\Rbackground}{\color[gray]{0.91}}
\providecommand{\Routbackground}{\color[gray]{0.935}}
% Can specify \color[gray]{1} for white background or just \color{white}

\lstdefinestyle{Rinput}{
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  basicstyle=\Rsize\Rcolor\ttfamily,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%,
  commentstyle=\Rcommentcolor\ttfamily,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1{==}{{=\,=}}2{--}{{-\,-}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},%
  backgroundcolor=\Rbackground,%
  numbers=left,%
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}%

% Other options of interest:
% frame=single,framerule=0.1pt,framesep=1pt,rulecolor=\color{blue},
% numbers=left,numberstyle=\tiny,stepnumber=1,numbersep=7pt,
% keywordstyle={\bf\Rcolor}

\lstdefinestyle{Routput}{fancyvrb=false,
  literate={~}{{$\sim$}}1{R^2}{{$R^{2}$}}2{^}{{$^{\scriptstyle\wedge}$}}1{R-squared}{{$R^{2}$}}2,%
  basicstyle=\Routcolor\Routsize\ttfamily,%
  backgroundcolor=\Routbackground,
  language=R,
  escapechar=`,
  fancyvrb=false,%
  tabsize=2,%
  breaklines=true,
  breakatwhitespace=true,%
  captionpos=b,%
  frame=single,%
  framerule=0.2pt,%
  framesep=1pt,%
  showstringspaces=false,%
  columns=fixed%,
  \lst@ifdisplaystyle\scriptsize\fi,%
  identifierstyle=,%
  keywords=\bfseries,%
  keywordstyle=\color[rgb]{0, 0.5, 0.5},
  escapeinside={(*}{*)},
  literate={~}{{$\sim$}}1 {==}{{=\,=}}2,
  alsoother={$},
  alsoletter={.<-},%
  otherkeywords={!,!=,~,$,*,\&,\%/\%,\%*\%,\%\%,<-,<<-,/},
  numbers=left,
  %numberblanklines=false,%
  stepnumber=5,
  firstnumber=1,
  numberstyle={\tiny}
}

\renewenvironment{Schunk}{}{}
\renewenvironment{Sinput}{}{}
\let\Sinput\relax
\let\Scode\relax
\let\Soutput\relax
\lstnewenvironment{Sinput}{\lstset{style=Rinput}}{}
\lstnewenvironment{Scode}{\lstset{style=Rinput}}{}
\lstnewenvironment{Soutput}{\lstset{style=Routput}}{}

\lstset{tabsize=2, breaklines=true, style=Rinput, breakatwhitespace=true}

\fvset{listparameters={\setlength{\topsep}{0em}}}

\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.90}
\usepackage{realboxes}
\providecommand*{\code}[1]{\texttt{#1}}
\renewcommand{\code}[1]{%
\Colorbox{light-gray}{#1}%
}%
%%end paste in guidePreambleSweavel.tex

\usepackage[natbibapa]{apacite}

\definecolor{darkblue}{HTML}{1e2277}

%would be in beamerthemekucrmda%
\mode<presentation>
\definecolor{kublue}{RGB}{0,81,186}
\usefonttheme{professionalfonts}
\useoutertheme{infolines}
\useinnertheme{rounded}
%disable rounded for alert and example boxes%
\setbeamertemplate{blocks}[default]
\usecolortheme{whale}
\usecolortheme{orchid}
\setbeamercolor{structure}{bg=kublue,fg=kublue!90!black}
%\setbeamercolor{structure}{fg=kublue}
\setbeamercolor{frametitle}{bg=kublue}
\setbeamercolor{section in toc}{fg=kublue!40!black}

\setbeamertemplate{frametitle continuation}[from second]
\renewcommand\insertcontinuationtext{...}
\beamertemplatenavigationsymbolsempty
%end of beamerthemekucrmda%

%If you want bigger margins, try this:
\setbeamersize{text margin left=05mm,text margin right=10mm} 
\hypersetup{colorlinks,allcolors=.,urlcolor=darkblue}
%Following seems to have no effect now
%\usepackage{handoutWithNotes}
%\pgfpagesuselayout{3 on 1 with notes}[letterpaper, border shrink=5mm]

\titlegraphic{\includegraphics[width=6cm]{theme/logo}}
\end_preamble
\options aspectratio=1609
\use_default_options false
\begin_modules
logicalmkup
sweave
natbibapa
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref false
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style 
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\branch R
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch semboot
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\branch cfalvm
\selected 1
\filename_suffix 0
\color #d6fbd6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Branch R
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% tmpout directory must exist first
\end_layout

\begin_layout Plain Layout

<<tmpout, echo=FALSE, include=FALSE, results=hide>>=
\end_layout

\begin_layout Plain Layout

if(!dir.exists("tmpout")) dir.create("tmpout", showWarnings=FALSE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=tmpout/t,split=T,ae=F,height=4.5,width=7,concordance=FALS
E}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Roptions, echo=F>>=
\end_layout

\begin_layout Plain Layout

opts.orig <- options()
\end_layout

\begin_layout Plain Layout

options(width=100, prompt = " ", continue = "  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE)
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

par.orig <- par(no.readonly = TRUE) 
\end_layout

\begin_layout Plain Layout

pjmar <- c(4.1, 4.1, 1.5, 2.1)
\end_layout

\begin_layout Plain Layout

par(mar=pjmar, ps=11)
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(mar=pjmar, ps=12, xpd=F)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=F,family="Times",pointsize=12)
\end_layout

\begin_layout Plain Layout

if(!file.exists("tmpout")) dir.create("tmpout", showWarnings=F)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<texcopy, include=FALSE>>=
\end_layout

\begin_layout Plain Layout

library(stationery)
\end_layout

\begin_layout Plain Layout

## If theme directory does not have required logo files, retrieve them.
\end_layout

\begin_layout Plain Layout

logos <- c(logo = "logo.pdf",
\end_layout

\begin_layout Plain Layout

            logomini = "logomini.pdf")
\end_layout

\begin_layout Plain Layout

getFiles(logos, pkg = "crmda")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Title
Regression with binary outputs
\begin_inset Argument 1
status open

\begin_layout Plain Layout
logit
\end_layout

\end_inset


\end_layout

\begin_layout Author
Paul Johnson
\begin_inset Flex InstituteMark
status open

\begin_layout Plain Layout
1
\end_layout

\end_inset


\end_layout

\begin_layout Institute
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
1
\end_layout

\end_inset

CRMDA, University of Kansas 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
CRMDA
\end_layout

\end_inset


\end_layout

\begin_layout Date
2018
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
logo{
\backslash
includegraphics[width=5mm]{theme/logomini}}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
The following causes the table of contents to be shown at the beginning
 of every subsection.
 Delete this, if you do not want it.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
AtBeginSection[]{
\end_layout

\begin_layout Plain Layout

  
\backslash
frame<beamer>{ 
\end_layout

\begin_layout Plain Layout

    
\backslash
frametitle{Outline}
\end_layout

\begin_layout Plain Layout

    
\backslash
tableofcontents[currentsubsection] 
\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Outline}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%following is LyX shortcut 
\backslash
vb for bold upright math for matrices
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\vb}[1]{\bm{\mathrm{#1}}}
\end_inset


\end_layout

\begin_layout Section*
Introduction
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What's Different about Categorical Outcomes?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Dependent variable is categorical.
 
\end_layout

\begin_deeper
\begin_layout Itemize
For discussion, we refer to 
\begin_inset Formula $Y_{i}\in\{0,1\}$
\end_inset


\end_layout

\begin_layout Itemize
But the numbers have no substantive meaning.
 They are just labels, could write 
\begin_inset Formula ${No,Yes}$
\end_inset

 or 
\begin_inset Formula ${Fail,Pass}$
\end_inset


\end_layout

\begin_layout Itemize
Temptation to treat the labels 
\begin_inset Formula $\{0,1\}$
\end_inset

 as numbers
\end_layout

\end_deeper
\begin_layout Itemize
Estimated by Maximum Likelihood
\end_layout

\begin_deeper
\begin_layout Description
ML idea: Choose estimates to make the observed outcomes most likely
\end_layout

\begin_layout Itemize
proposed by Ronald Fisher 1905-1922
\end_layout

\end_deeper
\begin_layout Itemize
Alternative models we consider–logit and probit–are members of the 
\begin_inset Quotes eld
\end_inset

family
\begin_inset Quotes erd
\end_inset

 of models in the Generalized Linear Model 
\begin_inset CommandInset citation
LatexCommand citep
key "mccullagh_nelder_1989"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Terminology
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Terminology}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
This is a terminology section, possibly a refresher
\end_layout

\begin_layout Itemize
We need to be comfortable with PDF and CDF in order to make progress in
 what follows
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Terminology: CDF Primer
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{A Probability Density Function (PDF)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf10, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon), ylab="Probab
ility Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable(location = 0, scale = 1)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The random variable 
\begin_inset Formula $\varepsilon\in(-\infty,\infty)$
\end_inset

 has PDF 
\begin_inset Formula $f(\varepsilon)$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Divide the PDF into 2 sections}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf20, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- -1.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(-1.3, 0.025, pos = 4, "Above 'cut point' of -1.5")
\end_layout

\begin_layout Plain Layout

text(-2.4, 0.075, pos = 2, "Below 'cut point'")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf20}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The areas of the sections represent chance $y=0$ or $y=1$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf30, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon), ylab="Probab
ility Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- -1.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(-1, 0.025, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

text(-2.4, 0.075, pos = 2, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf30}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Increase the cut point, change the probabilities}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf40, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- 0.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(1, 0.025, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

text(-1.25, 0.025, pos = 2, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf40}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Increase the cut point}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf50, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="") 
\end_layout

\begin_layout Plain Layout

legend("topleft", c(expression(paste("Logistic(", location==0, " , ",
\end_layout

\begin_layout Plain Layout

                                     scale == 1, ")"))), lty=1:2, col=1:2,
 cex = 0.8) 
\end_layout

\begin_layout Plain Layout

title("Logistic variable")
\end_layout

\begin_layout Plain Layout

xcut <- 2
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(2.05, 0.015, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

text(-1.5, 0.015, pos = 2, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logpdf50}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The area on the left is Cumulative Probability}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
About the dividing point.
 Lets don't worry too much about notation, just call it 
\begin_inset Formula $\tau$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

tau
\begin_inset Quotes erd
\end_inset

) until we think of something better.
\end_layout

\begin_layout Itemize
We use the probability that the random variable 
\begin_inset Formula $\varepsilon\leq\tau$
\end_inset

 to determine 
\begin_inset Formula $y_{i}$
\end_inset

 as 
\begin_inset Quotes eld
\end_inset

low
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

high
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
The 
\series bold
Cumulative Distribution Function
\series default
 is customary term for that value.
\end_layout

\begin_deeper
\begin_layout Itemize
CDF is the chance of an outcome smaller than 
\begin_inset Formula $\tau$
\end_inset


\end_layout

\begin_layout Itemize
Customary also to refer to it by the capital letter 
\begin_inset Formula $F(\tau)$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Mathematically, the probability that 
\begin_inset Formula $y=0$
\end_inset

 is an integral
\begin_inset Formula 
\[
F(\tau)=\int_{-\infty}^{\tau}f(\varepsilon)d\varepsilon
\]

\end_inset


\end_layout

\begin_layout Itemize
Mathematically, the probability that 
\begin_inset Formula $y=1$
\end_inset

 is area on the high side.
 
\begin_inset Formula 
\[
1-F(\tau)=\int_{\tau}^{\infty}f(\varepsilon)d\varepsilon
\]

\end_inset


\end_layout

\begin_layout Itemize
In other versions of these notes, I've put 1 on the left side and some parts
 of the story are easier to write.
 However, there are some advantages in this method.
 (its just notation)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Clearly, 
\end_layout

\begin_deeper
\begin_layout Itemize
if 
\begin_inset Formula $\tau\rightarrow-\infty$
\end_inset

, then 
\begin_inset Formula $F(\tau)\rightarrow0$
\end_inset


\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\tau\rightarrow\infty,$
\end_inset

 then 
\begin_inset Formula $F(\tau)\rightarrow1$
\end_inset


\end_layout

\begin_layout Itemize
Between those extremes, the graph of the CDF is 
\end_layout

\begin_deeper
\begin_layout Itemize
always increasing (or flat, but we usually have increasing)
\end_layout

\begin_layout Itemize
S-shaped
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Compare PDF and CDF}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf60, fig=T, include=F, width=8, height=3.5>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]),
\end_layout

\begin_layout Plain Layout

      ylab="Probability Density", main="") 
\end_layout

\begin_layout Plain Layout

xcut <- 2
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(2.05, 0.015, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

plogisatxcut <- plogis(xcut, 0, 1, log=FALSE)
\end_layout

\begin_layout Plain Layout

text(2, 0.015, pos = 2, paste("Pr(y = 0) = ", formatC(plogisatxcut)))
\end_layout

\begin_layout Plain Layout

mtext(expression(tau), 1, at = xcut)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logpdf70, fig=T, include=F, width=8, height=3>>=
\end_layout

\begin_layout Plain Layout

par.orig <- par(noReadOnly=TRUE)
\end_layout

\begin_layout Plain Layout

par(mar = c(4.1, 4.1, 2.1, 2.1))
\end_layout

\begin_layout Plain Layout

cumlogis <- plogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, cumlogis, type="l", ylim=c(0,1), xlab=expression(tau),
\end_layout

\begin_layout Plain Layout

      ylab="Cumulative Probability", main="") 
\end_layout

\begin_layout Plain Layout

abline(v=xcut, lty = 4, col = "gray80")
\end_layout

\begin_layout Plain Layout

par(par.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-logpdf60}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-logpdf70}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Looking Forward}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Will build a predictive model that sets the dividing line each case.
 
\end_layout

\begin_layout Itemize
All Logistic programs will give technically consistent results, but may
 have different signs on 
\begin_inset Formula $\beta$
\end_inset

 because there is 
\begin_inset Quotes eld
\end_inset

artistic license
\begin_inset Quotes erd
\end_inset

 in putting 
\begin_inset Formula $y=0$
\end_inset

 or 
\begin_inset Formula $y=1$
\end_inset

 on the left side of the graph.
\end_layout

\begin_layout Itemize
I've got this setup because it is consistent with ordinal multicategory
 models.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Terminology: Linear Predictor 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Linear Predictor}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Linear Predictor
\series default
 is the right hand side of a regression, 
\emph on
BUT
\emph default
 with no error term
\begin_inset Formula 
\begin{equation}
\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Shorthand 
\begin_inset Formula $X_{i}\beta$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $X_{i}$
\end_inset

 is a 
\begin_inset Quotes eld
\end_inset

row
\begin_inset Quotes erd
\end_inset

 of predictor values, usually with 
\begin_inset Formula $1$
\end_inset

 in the first position
\end_layout

\begin_layout Itemize
\begin_inset Formula $\beta$
\end_inset

 is a column vector of coefficients
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
[1,x1_{i},x2_{i},x3_{i}]\left[\begin{array}{c}
\beta_{0}\\
\beta_{1}\\
\beta_{2}\\
\beta_{3}
\end{array}\right]=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
That's called an 
\begin_inset Quotes eld
\end_inset


\series bold
inner product
\series default

\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset


\series bold
dot product
\series default

\begin_inset Quotes erd
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
An OLS regression
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+\varepsilon_{i}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
would be
\begin_inset Formula 
\[
y_{i}=X_{i}\beta+\varepsilon_{i}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Often use the Greek 
\begin_inset Formula $\eta_{i}$
\end_inset

 (
\begin_inset Quotes eld
\end_inset

eta
\begin_inset Quotes erd
\end_inset

) for the linear predictor, so
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
y_{i}=\eta_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
The expected value of 
\begin_inset Formula $y_{i}$
\end_inset

 in ordinary regression equals the linear predictor
\begin_inset Formula 
\begin{align*}
E[y_{i}|X_{i}] & =E[\eta_{i}+\varepsilon_{i}]\\
 & =E[\eta_{i}]+E[\varepsilon_{i}]\\
 & =\eta_{i}+0=X_{i}\beta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Itemize
Matrix notation (transpose nonsense)
\end_layout

\begin_deeper
\begin_layout Itemize
Sometimes notation enforces the 
\begin_inset Quotes eld
\end_inset

all vectors are columns rule
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
Thus it is necessary to say 
\begin_inset Formula $X_{i}$
\end_inset

 is a column:
\end_layout

\begin_deeper
\begin_layout Plain Layout
\begin_inset Formula 
\[
X_{i}=\left[\begin{array}{c}
1\\
x1_{i}\\
x2_{i}\\
x3_{i}
\end{array}\right]
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
A 
\series bold
transpose
\series default
 is same thing on its side
\begin_inset Formula 
\[
X_{i}^{T}=[1,x1_{i},x2_{i},x3_{i}]
\]

\end_inset


\end_layout

\begin_deeper
\begin_layout Plain Layout
So others might write 
\begin_inset Formula $X_{i}^{T}\beta$
\end_inset


\end_layout

\end_deeper
\end_deeper
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Terminology: Generalized Linear Model
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{GLM}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
McCullagh & Nelder (
\begin_inset CommandInset citation
LatexCommand citeyear
key "mccullagh_nelder_1989"

\end_inset

) worked out a framework called generalized linear models (GLM)
\end_layout

\begin_layout Itemize
The Logit & Probit models are examples
\end_layout

\begin_layout Itemize
There are 2 twists on the usual regression that we need to watch for.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Generalized Linear Model, step 1}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Rewrite OLS in this way.
 
\end_layout

\begin_layout Itemize
Regression
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
y_{i}=X_{i}\beta+\varepsilon_{i},\,\,\varepsilon_{i}\sim N(0,\sigma_{\varepsilon}^{2})
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Because error is Normal, and 
\begin_inset Formula $E[\varepsilon_{i}]=0,$
\end_inset

 the conditional distribution of 
\begin_inset Formula $y_{i}$
\end_inset

 is normal with mean 
\begin_inset Formula $\eta_{i}$
\end_inset

 and variance 
\begin_inset Formula $\sigma_{\varepsilon}^{2}$
\end_inset

: 
\begin_inset Formula 
\[
y_{i}\sim N(\eta_{i},\sigma_{\varepsilon}^{2})
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
framebreak
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\series bold
Generalization step 1
\series default
: Put other distributions in place of the Normal.
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $y_{i}\sim SomeOtherDistribution(\eta_{i})\,\,\{\mathrm{may\,have\,more\,parameters}\}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
In the categorical model, we will use a Binomial distribution, a random
 draw from {0,1}.
\end_layout

\begin_layout Itemize
Clarify Binomial versus Bernoulli
\end_layout

\begin_deeper
\begin_layout Itemize
Binomial answers 
\begin_inset Quotes eld
\end_inset

how many positives out of X draws with probability 
\begin_inset Formula $p_{i}$
\end_inset


\begin_inset Quotes erd
\end_inset

, 
\begin_inset Formula $Bin(X,p_{i})$
\end_inset


\end_layout

\begin_layout Itemize
Bernoulli is 
\begin_inset Quotes eld
\end_inset

take 1 draw with probability 
\begin_inset Formula $p_{i}$
\end_inset


\begin_inset Quotes erd
\end_inset

, give back 0 or 1
\end_layout

\begin_layout Itemize
Binomial with 
\begin_inset Formula $X=1$
\end_inset

 is same as Bernoulli.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Generalized Linear Model, step 2}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Transform 
\begin_inset Formula $\eta_{i}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
This part is a little difficult to describe in general, but we'll demonstrate
 it with the 
\begin_inset Quotes eld
\end_inset

S-shaped
\begin_inset Quotes erd
\end_inset

 curve
\end_layout

\begin_layout Itemize
The transformation connects the expected value of the outcome variable 
\begin_inset Formula $y_{i}$
\end_inset

 with the linear predictor, as we will see.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Using OLS With Categorical DV
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{OLS versus Logit}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Ordinary Least Squares is for numeric outcomes, but before 1980
\end_layout

\begin_deeper
\begin_layout Itemize
researchers frequently treated the {0,1} data as numbers
\end_layout

\end_deeper
\begin_layout Itemize
Logit (or other 
\begin_inset Quotes eld
\end_inset

categorical regression models
\begin_inset Quotes erd
\end_inset

) grew rapidly in popularity in the late 1970s.
\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

big data
\begin_inset Quotes erd
\end_inset

 (
\begin_inset Quotes eld
\end_inset

data mining
\begin_inset Quotes erd
\end_inset

) field has put new life into the linear model, mainly because it is easy
 to calculate and most often results are similar to other, more elaborate
 models
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The Boundary Problem
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{$y_i$ is dichotomous}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Suppose 
\begin_inset Formula $y_{i}$
\end_inset

 is coded 0 and 1, representing answers to a Yes or No question.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

set.seed(44444)
\end_layout

\begin_layout Plain Layout

x <- 25:75
\end_layout

\begin_layout Plain Layout

p= 1/(1+exp(2-0.05*x))
\end_layout

\begin_layout Plain Layout

y <- rbinom(length(x), size=1, prob=p)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<a, echo=F, fig=T,include=F>>=
\end_layout

\begin_layout Plain Layout

plot(x,y,ylim=c(-.2,1.2), xlab="One Predictor X", ylab="dichotomous output",
 type="n")
\end_layout

\begin_layout Plain Layout

points(x,y,pch=16,cex=0.85)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-a}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Fit OLS with Dichotomous data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<b,fig=T, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

mod <- lm(y~x)
\end_layout

\begin_layout Plain Layout

plot(x,y)
\end_layout

\begin_layout Plain Layout

abline(mod)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-b}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Problem: OLS predicts out of range}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
A straight line will eventually go above 1 and below 0.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

x2 <- seq(0,150,length=200)
\end_layout

\begin_layout Plain Layout

expbx2 <- exp((-1)*(-10+.145*x2))
\end_layout

\begin_layout Plain Layout

ProbY1 <- 1/(1+expbx2)
\end_layout

\begin_layout Plain Layout

y2 <- rbinom(n=200, size=1, prob=ProbY1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

modl2 <- lm(y2~x2)
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout

<<c, fig=TRUE, echo=FALSE, include=F>>=
\end_layout

\begin_layout Plain Layout

plot(x2, y2, ylim=c(-0.3,1.5),type="n");
\end_layout

\begin_layout Plain Layout

points(x2,y2,cex=0.85)
\end_layout

\begin_layout Plain Layout

abline(modl2);
\end_layout

\begin_layout Plain Layout

lines(c(0,150),c(0,0),lty=c(2)); lines(c(0,150),c(1,1),lty=c(2));
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-c}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Might try 'truncation' of the predicted values}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To prevent the OLS model from going out of bounds, one approach is to insert
 
\begin_inset Quotes eld
\end_inset

kinks
\begin_inset Quotes erd
\end_inset

 in the fitted line.
 
\end_layout

\begin_layout Standard
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout

<<olskink, fig=TRUE, echo=FALSE, include=F>>=
\end_layout

\begin_layout Plain Layout

plot(x2, y2, ylim=c(-0.3,1.5),type="n");
\end_layout

\begin_layout Plain Layout

points(x2,y2,cex=0.8, col="gray70")
\end_layout

\begin_layout Plain Layout

lines(c(0,150),c(0,0),lty=c(2), col="gray60"); 
\end_layout

\begin_layout Plain Layout

lines(c(0,150),c(1,1),lty=c(2), col="gray60");
\end_layout

\begin_layout Plain Layout

eta <- coef(modl2)[1] + coef(modl2)[2] * x2
\end_layout

\begin_layout Plain Layout

etakink <- ifelse(eta < 0, 0, ifelse(eta > 1, 1, eta)) 
\end_layout

\begin_layout Plain Layout

lines(x2, etakink)
\end_layout

\begin_layout Plain Layout

@ 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-olskink}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
But I've never seen anybody carry through on that in a serious way.
\end_layout

\begin_layout Standard
Shortcomings
\end_layout

\begin_layout Enumerate
Theoretically unappealing.
 Why would it be that the input has no effect, then a linear effect, then
 no effect again?
\end_layout

\begin_layout Enumerate
Difficult to interpret 
\begin_inset Formula $\hat{y}_{i}=0$
\end_inset

.
 Something is actually impossible? 
\end_layout

\begin_layout Enumerate
Does 
\begin_inset Formula $\hat{y}_{i}=1$
\end_inset

 have meaning? Something is certain to happen? Suppose observed 
\begin_inset Formula $y_{i}=0.$
\end_inset

 Does that mean whole model is 
\begin_inset Quotes eld
\end_inset

impossible
\begin_inset Quotes erd
\end_inset

?
\end_layout

\begin_layout Enumerate
How to estimate the 
\begin_inset Quotes eld
\end_inset

kink
\begin_inset Quotes erd
\end_inset

 points coherently?
\end_layout

\begin_layout Standard
Don't worry so much if all predictors are dummy variables.
 Predictions will stay in bounds.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Error is not normally distributed
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Linear Probability Model}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Linear probability model says
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
y_{i}=X_{i}\beta+\varepsilon_{i}\label{ols1}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
If we fit that, the predicted value 
\begin_inset Formula $\hat{y}_{i}=X_{i}\hat{\beta}$
\end_inset

 is interpreted as a probability estimate
\end_layout

\begin_layout Itemize
Problem: The error term 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 can't be normally distributed.
 (Explain next slide)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Error term must be one of 2 values for any particular observation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
error term is defined as difference between 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $X_{i}\beta$
\end_inset

, and
\end_layout

\begin_layout Itemize
the observed value, 1 or 0.
\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 must be either
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $1-X_{i}\beta$
\end_inset

 if 
\begin_inset Formula $y_{i}=0$
\end_inset

, or
\end_layout

\begin_layout Itemize
\begin_inset Formula $X_{i}\beta$
\end_inset

 if 
\begin_inset Formula $y_{i}=1$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Repeat, error term can have only 2 values.
 It goes Up (
\begin_inset Formula $1-X_{i}\beta)$
\end_inset

 or Down (
\begin_inset Formula $-X_{i}\beta$
\end_inset

).
 
\end_layout

\begin_layout Itemize
That can't be Normal!
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Heteroskedasticity
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{You insist that $E[
\backslash
varepsilon_i]=0$, then find $Var(
\backslash
varepsilon)$}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $P_{i}$
\end_inset

 be the probability of a 1 for case 
\begin_inset Formula $i$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
Then probability that 
\begin_inset Formula $y_{i}=0$
\end_inset

 is 
\begin_inset Formula $(1-P_{i})$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
The expected value of error term:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
E[\varepsilon_{i}] & = & P_{i}(1-P_{i})+(1-P_{i})(-P_{i})\nonumber \\
 & = & P_{i}-P_{i}^{2}-P_{i}+P_{i}^{2}=0
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
Recall, 
\begin_inset Formula $E[]$
\end_inset

 is sum of probabilities times outcomes.
 
\end_layout

\begin_deeper
\begin_layout Itemize
The probabilities are 
\begin_inset Formula $P_{i}$
\end_inset

 and 
\begin_inset Formula $(1-P_{i})$
\end_inset

.
\end_layout

\begin_layout Itemize
The outcomes are 
\begin_inset Formula $(1-P_{i})$
\end_inset

 and 
\begin_inset Formula $(-P_{i})$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{That Implies Heteroskedasticity}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Heteroskedasticity is not fatal, we'd need to do 
\begin_inset Quotes eld
\end_inset

weighted least squares
\begin_inset Quotes erd
\end_inset

 to address it.
 But only would bother if I could convince myself he 
\begin_inset Quotes eld
\end_inset

mean model
\begin_inset Quotes erd
\end_inset

 is reasonable
\end_layout

\begin_layout Itemize
The variance of the error term is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{c}
Var(\varepsilon_{i})=E([\varepsilon_{i}-E[\varepsilon_{i}])^{2}]\\
=E[\varepsilon_{i}^{2}]\,\,\{\mathrm{because\,E[\varepsilon_{i}]=0}\}\\
=P_{i}(1-P_{i})^{2}+(1-P_{i})(-P_{i})^{2}\\
=P_{i}(1-P_{i})
\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
The error variance is biggest when 
\begin_inset Formula $P_{i}=0.5,$
\end_inset

 smaller (tending toward 0) as 
\begin_inset Formula $P_{i}\rightarrow0$
\end_inset

 or 
\begin_inset Formula $P_{i}\rightarrow1$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Weighted Least Squares might be used to homogenize variances, to 
\begin_inset Quotes eld
\end_inset

correct
\begin_inset Quotes erd
\end_inset

 the standard errors from the model.
\end_layout

\begin_deeper
\begin_layout Itemize
Assumes we believe the linear model for probabilities
\end_layout

\begin_layout Itemize
We ignore the boundary problem entirely to make this work.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
S-Shaped Curves
\begin_inset CommandInset label
LatexCommand label
name "sec:logit1"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Smooth Curve for Probability}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Theory: probability that 
\begin_inset Formula $y_{i}=1$
\end_inset

 changes 
\begin_inset Quotes eld
\end_inset

smoothly
\begin_inset Quotes erd
\end_inset

 in response to changes in 
\begin_inset Formula $x_{i}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Monotonic relationship implies an S-shaped curve.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s1_1, include=F, fig=TRUE,height=4,width=6, echo=F>>=
\end_layout

\begin_layout Plain Layout

xrange <- seq(50, 150, length = 200)
\end_layout

\begin_layout Plain Layout

beta0 <- -10
\end_layout

\begin_layout Plain Layout

beta1 <- .1
\end_layout

\begin_layout Plain Layout

pry <- function(x, k0, k1){
\end_layout

\begin_layout Plain Layout

   exp(k0 + k1 * x)/(1 + exp(k0 + k1 * x))
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

ProbY1 <- pry(xrange, beta0, beta1)
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l", xlab='x', ylab='Probability(y=1)')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s1_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Visualize the X's as fixed characteristics}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s2_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l", xlab='x', ylab='Probability(y=1)', col =
 "gray60")
\end_layout

\begin_layout Plain Layout

x <- rnorm(20, m = 100, s = 20)
\end_layout

\begin_layout Plain Layout

x <- sort(x)
\end_layout

\begin_layout Plain Layout

rug(x, lwd = 1)
\end_layout

\begin_layout Plain Layout

title ("x values marked by 'rug' marks")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The S-curve is the 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 probability that 
\begin_inset Formula $y_{i}=1$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s2_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The True Probability for each value of X}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s3_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)',  col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr, lwd = 2)
\end_layout

\begin_layout Plain Layout

title("The 
\backslash
"true
\backslash
" Probabilty that y = 1")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s3_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

true probabilities
\begin_inset Quotes erd
\end_inset

 are not observed...
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Observed 0's and 1's: Downs and Ups}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s4_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)',  col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr)
\end_layout

\begin_layout Plain Layout

arrows(x[10], 0.05 + ypr[10], x[10], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x[10], -0.05 + ypr[10], x[10], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

text(x[10], ypr[10]+ 0.5*(1 - ypr[10]), pos = 2, labels = paste("Pr[y = 1]
 = ", round(ypr[10], 2)))
\end_layout

\begin_layout Plain Layout

text(x[10], ypr[10] - 0.5*(ypr[10]), pos = 4, labels = paste("Pr[y = 0] =
 ", round(1 - ypr[10], 2)))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s4_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s4_2, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)', col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr)
\end_layout

\begin_layout Plain Layout

j <- 4
\end_layout

\begin_layout Plain Layout

arrows(x[j], 0.05 + ypr[j], x[j], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x[j], -0.05 + ypr[j], x[j], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j]+ 0.5*(1 - ypr[j]), pos = 2, labels = paste("Pr[y = 1] =
 ", round(ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j] - 0.5*(ypr[j]), pos = 4, labels = paste("Pr[y = 0] = ",
 round(1 - ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s4_2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s4_3, fig=TRUE, include=F,  echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)', col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

ypr <- pry(x, beta0, beta1) 
\end_layout

\begin_layout Plain Layout

points(x, ypr)
\end_layout

\begin_layout Plain Layout

j <- 15
\end_layout

\begin_layout Plain Layout

arrows(x[j], 0.05 + ypr[j], x[j], 1, length = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x[j], -0.05 + ypr[j], x[j], 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j]+ 0.5*(1 - ypr[j]), pos = 2, labels = paste("Pr[y = 1] =
 ", round(ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

text(x[j], ypr[j] - 0.5*(ypr[j]), pos = 4, labels = paste("Pr[y = 0] = ",
 round(1 - ypr[j], 2)))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s4_3}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<s5_1, fig=TRUE, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(xrange, ProbY1, type="l",xlab='x',ylab='Probability(y=1)', col = "gray60")
\end_layout

\begin_layout Plain Layout

rug(x, ticksize = 0.01, lwd = 1)
\end_layout

\begin_layout Plain Layout

points(x, ypr, col = "gray60")
\end_layout

\begin_layout Plain Layout

arrows(x, ifelse(ypr < 0.94, 0.05 + ypr, ypr + 0.1 * (1-ypr)),  x, 1, length
 = 0.05) 
\end_layout

\begin_layout Plain Layout

arrows(x, ifelse(ypr > 0.05, ypr - 0.05, 0), x, 0, length = 0.05) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-s5_1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Ways to think about that}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The linear predictor is transformed to the S-shaped curve
\end_layout

\begin_deeper
\begin_layout Itemize
Then an 
\begin_inset Quotes eld
\end_inset

up or down
\begin_inset Quotes erd
\end_inset

 random draw assigns 0 or 1
\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

up or down
\begin_inset Quotes erd
\end_inset

 draw is said to be drawn from a Binomial probability distribution
\end_layout

\end_deeper
\begin_layout Itemize
The probability values (expected values of 
\begin_inset Formula $y_{i})$
\end_inset

 are link-transformed back to values of 
\begin_inset Formula $X_{i}\beta$
\end_inset


\end_layout

\begin_layout Itemize
Any 
\begin_inset Quotes eld
\end_inset

S-shaped
\begin_inset Quotes erd
\end_inset

 curve is as good as another
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,containsverbatim,]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Logistic S-Shaped Curve
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic S-Shape Formula}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
One formula for an S-shaped curve, the Logistic Model 
\begin_inset Formula 
\begin{eqnarray}
Prob(y_{i}=1|X_{i}) & = & \frac{exp(X_{i}\beta)}{1+exp(X_{i}\beta)}\\
 &  & \frac{1}{1+exp(-X_{i}\beta)}\\
\{\mathrm{same\,as}\} & = & \frac{1}{1+e^{-(X_{i}\beta)}}
\end{eqnarray}

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
a very small value if 
\begin_inset Formula $\eta_{i}$
\end_inset

 is really small
\end_layout

\begin_layout Itemize
a value that is close to 1 if 
\begin_inset Formula $\eta_{i}$
\end_inset

 is really big.
 
\end_layout

\end_deeper
\begin_layout Itemize
Remember that 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $exp(X_{i}\beta)\rightarrow\infty$
\end_inset

 (rapidly) as 
\begin_inset Formula $X_{i}\beta$
\end_inset

 grows.
\end_layout

\begin_layout Itemize
\begin_inset Formula $exp(-X_{i}\beta)\rightarrow0$
\end_inset

 as 
\begin_inset Formula $X_{i}\beta$
\end_inset

 grows.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic Highlights}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
The slope for one predictor, 
\begin_inset Formula $\frac{\partial Pi}{\partial X_{i}}$
\end_inset

 = 
\begin_inset Formula $\beta_{1}\cdot P_{i}\cdot(1-P_{i})$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
Logistic population growth: as 
\begin_inset Formula $P_{i}$
\end_inset

 nears the upper limit of 
\begin_inset Formula $1$
\end_inset

, its rate of growth is slower and slower.
\end_layout

\begin_layout Itemize
The effect of 1 unit change in 
\begin_inset Formula $X_{i}$
\end_inset

 is 
\begin_inset Formula $\beta_{1}$
\end_inset

 weighted by 
\begin_inset Formula $P_{i}(1-P_{i})$
\end_inset

.
 
\end_layout

\begin_layout Itemize
At 
\begin_inset Formula $P_{i}=0.5$
\end_inset

, the slope is at a maximum.
 There 
\begin_inset Formula $P_{i}(1-P_{i})=0.25$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\frac{1}{4}\beta_{1}$
\end_inset

 the slope of the 
\begin_inset Quotes eld
\end_inset

S curve
\begin_inset Quotes erd
\end_inset

 at the mid point.
 
\end_layout

\end_deeper
\begin_layout Itemize
If 
\begin_inset Formula $y_{i}$
\end_inset

 is very likely to be a 1 or a 0, a change in 
\begin_inset Formula $X_{i}$
\end_inset

 doesn't make much difference.
\end_layout

\end_deeper
\begin_layout Enumerate
The "odds ratio" is 
\begin_inset Formula $\frac{P_{i}}{(1-P_{i})}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
The log of the odds ratio, AKA the 
\begin_inset Quotes eld
\end_inset

logit
\begin_inset Quotes erd
\end_inset

 of 
\begin_inset Formula $P_{i}$
\end_inset

.
 It can be shown that
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\ln\left[\frac{P_{i}}{1-P_{i}}\right]=X_{i}\beta
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Note the transformation is on the left hand side.
 
\end_layout

\begin_layout Itemize
McCullagh and Nelder called the LHS transform a 
\begin_inset Quotes eld
\end_inset


\series bold
link
\series default

\begin_inset Quotes erd
\end_inset

 function.
 It goes from the expected value of 
\begin_inset Formula $y_{i}$
\end_inset

, which is 
\begin_inset Formula $P_{i}$
\end_inset

 in this case, back to the linear predictor.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The odds ratio: One way of "scaling" logit coefficients}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Suppose a predictor 
\begin_inset Formula $X_{i}$
\end_inset

 has only 2 values, 0 and 1.
\end_layout

\begin_layout Itemize
Then, the difference in the log odds ratio is easy to see.
\end_layout

\begin_layout Itemize
Let 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $P_{1}$
\end_inset

 be the probability that 
\begin_inset Formula $y_{i}=1$
\end_inset

 if 
\begin_inset Formula $X_{i}=1$
\end_inset

 and 
\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{0}$
\end_inset

 be the probability 
\begin_inset Formula $y_{i}=1$
\end_inset

 if 
\begin_inset Formula $X_{i}=0$
\end_inset

 
\end_layout

\end_deeper
\begin_layout Itemize
The difference in the log odds:
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
ln\left[\frac{P_{1}}{1-P_{1}}\right]-ln\left[\frac{P_{0}}{1-P_{0}}\right]=\left\{ \beta_{0}+\beta_{1}\cdot1\right\} -\left\{ \beta_{0}+\beta_{1}\cdot0\right\} 
\]

\end_inset


\begin_inset Formula 
\[
ln\left[\frac{\frac{P_{1}}{1-P_{1}}}{\frac{P_{0}}{1-P_{0}}}\right]=\beta_{1}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\frac{P_{1}}{1-P_{1}}}{\frac{P_{0}}{1-P_{0}}}=exp(\beta_{1})
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
On the left, we have the ratio of the log odds.
 Hence,
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $exp(\beta_{1})$
\end_inset

 is an estimate of the 
\begin_inset Quotes eld
\end_inset

odds ratio
\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_deeper
\begin_layout Itemize
Interpretation: odds in case 1 are proportional to odds in case 0
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{P_{1}}{1-P_{1}}=\frac{P_{0}}{1-P_{0}}exp(\beta_{1})
\]

\end_inset


\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $X_{i}$
\end_inset

 is a 
\begin_inset Quotes eld
\end_inset

dummy variable
\begin_inset Quotes erd
\end_inset

, then this approach may be meaningful
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Weaknesses in the odds ratio}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The danger, spelled out clearly in (XXX), is that there's no substantive
 meaning in the ratio of odds
\end_layout

\begin_layout Itemize
Many people mistake the odds ratio for the 
\begin_inset Quotes eld
\end_inset

relative risk
\begin_inset Quotes erd
\end_inset

, which in this case would be
\begin_inset Formula 
\[
RelativeRisk=RR=\frac{P_{1}}{P_{0}}
\]

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $RR$
\end_inset

: the chance of an 
\begin_inset Quotes eld
\end_inset

event
\begin_inset Quotes erd
\end_inset

 when 
\begin_inset Formula $X_{i}=1$
\end_inset

 is 
\begin_inset Formula $RR$
\end_inset

 orders of magnitude higher
\end_layout

\begin_layout Itemize
Nevertheless, many texts & authors use OR because they think they are more
 easily interpreted than 
\begin_inset Formula $\hat{\beta}$
\end_inset

 from these models.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Example: Logistic Model
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks, containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The BIG PICTURE: Overlay OLS and Logit}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
My test data was described above.
 Estimate with OLS and a Logistic model.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logit1, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

glm1 <- glm(y2~x2, family=binomial(logit))
\end_layout

\begin_layout Plain Layout

summary(glm1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logit2, fig=T, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

plot(x2,y2)
\end_layout

\begin_layout Plain Layout

abline(mod, lty=2)
\end_layout

\begin_layout Plain Layout

library(rockchalk)
\end_layout

\begin_layout Plain Layout

plotx <- plotSeq(x2)
\end_layout

\begin_layout Plain Layout

glmpred <- predict(glm1, newdata=data.frame(x=plotx), type="response")
\end_layout

\begin_layout Plain Layout

lines(plotx, glmpred, lty=1)
\end_layout

\begin_layout Plain Layout

legend("topleft", title = "Predicted Values", 
\end_layout

\begin_layout Plain Layout

    legend=c("Logistic", "OLS"), lty=c(1,2))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{tmpout/t-logit2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logistic fitted with glm in R}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In R, it is fitted as a generalized linear model.
\end_layout

\begin_deeper
\begin_layout Itemize
Family is binomial
\end_layout

\begin_layout Itemize
link is logit
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-logit1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Features worth noting}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Familiar 
\begin_inset Quotes eld
\end_inset

parameter summary table
\begin_inset Quotes erd
\end_inset

 with columns for 
\begin_inset Formula $\hat{\beta}$
\end_inset

 and 
\begin_inset Formula $std.err.(\hat{\beta}$
\end_inset

)
\end_layout

\begin_layout Itemize
3rd column is not 
\begin_inset Formula $t,$
\end_inset

 but rather 
\begin_inset Formula $z$
\end_inset

.
\end_layout

\begin_layout Itemize
There's no 
\begin_inset Formula $R^{2}$
\end_inset


\end_layout

\begin_layout Itemize
New statistics 
\begin_inset Quotes eld
\end_inset

Null deviance
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Residual deviance
\begin_inset Quotes erd
\end_inset

 and AIC.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rockchalk outreg table: Compare OLS and Logistic}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logit4, echo=F, include=F, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(OLS = modl2, Logit = glm1), showAIC=T, 
\end_layout

\begin_layout Plain Layout

       request = c("fstatistic" = "F"))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-logit4}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Predicted values}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
OLS: estimates the 
\begin_inset Formula $\beta$
\end_inset

's in 
\begin_inset Formula $\hat{y}_{i}=\hat{\beta}_{0}+\hat{\beta}_{1}x_{i}$
\end_inset

.
 Those are 
\begin_inset Quotes eld
\end_inset

linear probability
\begin_inset Quotes erd
\end_inset

 estimates
\end_layout

\begin_layout Itemize
Logistic: use the estimates on two levels 
\end_layout

\begin_deeper
\begin_layout Itemize
In linear predictor scale 
\begin_inset Formula $\hat{\eta}_{i}=\hat{\beta}_{0}+\hat{\beta}_{1}x_{i}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
transform in order to get probabilities
\begin_inset Formula 
\[
\frac{e^{\hat{\eta_{i}}}}{1+e^{\hat{\eta_{i}}}}\,\mathrm{same\,as\,}\frac{1}{1+e^{-\hat{\eta_{i}}}}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{About Predicted Values}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

predict
\begin_inset Quotes erd
\end_inset

 function takes the glm and calculates those 
\begin_inset Formula $\hat{\eta}$
\end_inset

 values:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

glm1 <- glm(y~x, data=dat, family=binomial(logit))
\end_layout

\begin_layout Plain Layout

predy1 <- predict(glm1)
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The default output is a prediction on the linear predictor scale, a number
 that can range from 
\begin_inset Formula $-\infty$
\end_inset

 to 
\begin_inset Formula $\infty$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Shrink that back to 
\begin_inset Formula $(0,1)$
\end_inset

 interval, representing scale of observed scores 
\end_layout

\begin_layout Itemize
In R, that is requested by adding a type parameter, 
\begin_inset Quotes eld
\end_inset

response
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

predy2 <- predict(glm1, type="response")
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rockchalk::predictOMatic works}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

predictOMatic(glm1, predVals = c(x2 = "seq"), n = 10)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Show off some more predictOMatic}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here the values of the predictor are selected so they equal the mean, +/-
 standard deviation, +/- 2 standard deviations
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

predictOMatic(glm1, predVals = c(x2 = "std.dev."), n = 5)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Consider the Standard Error and z stat columns}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
It is confusing that we don't get a 
\begin_inset Formula $t$
\end_inset

-test out of this.
\end_layout

\begin_layout Itemize
Technically, the ratio 
\begin_inset Formula $\frac{\hat{\beta}-0}{std.err.(\hat{\beta})}$
\end_inset

 is not compared against 
\begin_inset Formula $t$
\end_inset

 distribution because that ratio has an unknown distribution in small samples.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $N$
\end_inset

 were infinite, the ratio 
\begin_inset Formula $\frac{\hat{\beta}-0}{std.err.(\hat{\beta})}$
\end_inset

 would be distributed Normally, that's why column in output is labeled 
\begin_inset Formula $z$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
That's what 
\begin_inset Quotes eld
\end_inset

asymptotically distributes as
\begin_inset Quotes erd
\end_inset

 refers to.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Maximum Likelihood Estimation
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Probability of Observing a Whole Sample}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Assume the observations are statistically independent, meaning the probability
 of the sample equals the individual probabilities multiplied together.
 Hence,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
Likelihood\,of\,Sample:\,\,L(\beta_{0},\beta_{1})=\\
=P(y_{1}=0,y_{2}=0,...,y_{m}=0,y_{m+1}=1,y_{m+2}=1,...,y_{N}=1)\\
=P(y_{1}=0)P(y_{2}=0)\cdots P(y_{m}=0)\\
\times P(y_{m+1}=1)P(y_{m+2}=1)\cdots P(y_{N}=1)
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Simplify That}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Remember that 
\begin_inset Formula $P(y_{i}=0)$
\end_inset


\begin_inset Formula $=1-P(y_{i}=1)$
\end_inset

, so 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
L(\beta_{0},\beta_{1})=(1-P(y_{1}=1))(1-P(y_{2}=1))\cdots(1-P(y_{m}=1))\nonumber \\
\times P(y_{m+1}=1)P(y_{m+2}=1)\cdots P(y_{N}=1)
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
Simplify notation: 
\begin_inset Formula $P_{i}=P(y_{i}=1)$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
L(\beta_{0},\beta_{1})=(1-P_{1})(1-P_{2})\cdots(1-P_{m}))\nonumber \\
\times P{}_{m+1}P{}_{m+2}\cdots P{}_{N}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Log That To Simplify Further}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The Log of the Likelihood Function is a sum of logs:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\ln L(\beta_{0},\beta_{1})=\ln(1-P_{1})+\ln(1-P_{2})+\cdots+\ln(1-P_{m})+\ln(P_{m+1})+\cdots+\ln(P_{N})
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
In a Logistic case, we'd fill in 
\begin_inset Formula $P_{i}=\frac{1}{1+e^{-(\beta_{0}+\beta_{1}X_{i})}}$
\end_inset

 
\end_layout

\begin_layout Itemize
MLE, short for Maximum Likelihood Estimate, is the choice of estimators
 
\begin_inset Formula $\beta_{0}$
\end_inset

, 
\begin_inset Formula $\beta_{1}$
\end_inset

 that maximize the log of the likelihood function.
 This solution is also a maximizer of L.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Quick summary of MLE properties}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
NOT unbiased.
\end_layout

\begin_layout Enumerate
MLE's are consistent, asymptotically efficient, asymptotically Normal.
 The asymptotic normality implies that we can conduct approximate t-tests,
 as long as we can get estimates of the standard errors of 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Asymptotic standard errors.
 They tell you, approximately, if you had an infinite sample, what the standard
 error of would be.
 They are sometimes called approximate standard errors because you never
 have an infinite sample.
\end_layout

\begin_layout Enumerate
Because of dangers in asymptotic approximations, there is now a concerted
 effort to find more exact standard errors for small samples.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{likelihood ratio test (Compare nested models)}
\end_layout

\end_inset


\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset

Unrestricted
\begin_inset space ~
\end_inset


\begin_inset Quotes eld
\end_inset

Full
\begin_inset Quotes erd
\end_inset


\begin_inset space ~
\end_inset

Model.
 Let 
\begin_inset Formula $L_{max}$
\end_inset

 be the value of the likelihood function at its maximum, when all coefficients,
 the slope and the intercept, are estimated to maximize the likelihood.
\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset

Restricted
\begin_inset space ~
\end_inset

Model.
 Set some parameter at a fixed value, possibly 0.
 Let 
\begin_inset Formula $L_{0}$
\end_inset

 be the value of the likelihood function in which the "slope" coefficient
 
\begin_inset Formula $\beta_{1}$
\end_inset

 (or other coefficients if they are in the model) is 0.
\end_layout

\begin_layout Description
Compare
\begin_inset space ~
\end_inset


\begin_inset Formula $L_{max}$
\end_inset

 and 
\begin_inset Formula $L_{0}$
\end_inset

 with a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Let 
\begin_inset Formula $\lambda$
\end_inset

, (Greek 
\begin_inset Quotes eld
\end_inset

lambda
\begin_inset Quotes erd
\end_inset

), be the ratio of 
\begin_inset Formula $L_{0}$
\end_inset

 to 
\begin_inset Formula $L_{max}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\lambda\quad=\frac{L_{0}}{L_{max.}}
\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula $-2\cdot\ln(\lambda)$
\end_inset

 has a 
\begin_inset Formula $\chi^{2}$
\end_inset

 distribution with 
\begin_inset Formula $k$
\end_inset

 degrees of freedom, where 
\begin_inset Formula $k$
\end_inset

 is the difference in the number of coefficients in 
\begin_inset Formula $L_{0}$
\end_inset

 versus 
\begin_inset Formula $L_{max}$
\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Use any CDF
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Where did the error term go?} 
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In OLS, we were constantly going on about 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 and its variance.
 OLS says
\begin_inset Formula 
\[
y_{i}=\beta_{0}+\beta_{1}X_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
Logit says 
\begin_inset Formula 
\[
P_{i}=\frac{1}{1+exp(-(\beta_{0}+\beta_{1}X_{i}))}
\]

\end_inset


\end_layout

\begin_layout Itemize
Where is the error term? 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Restate the theory in a different way}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Write a predictive statement about a latent variable 
\begin_inset Formula $Z$
\end_inset

.
\begin_inset Formula 
\[
Z_{i}=\beta_{0}+\beta_{1}X_{i}+\varepsilon_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
At this point, we run into troubles because I frequently make mistakes with
\end_layout

\begin_deeper
\begin_layout Itemize
the signs of the 
\begin_inset Formula $\beta$
\end_inset

 or 
\begin_inset Formula $\varepsilon$
\end_inset


\end_layout

\begin_layout Itemize
the side of the PDF graph on which 
\begin_inset Formula $y=1$
\end_inset

 ought to lie
\end_layout

\begin_deeper
\begin_layout Itemize
My graph: 
\begin_inset Quotes eld
\end_inset

as 
\begin_inset Formula $\beta_{0}+\beta_{1}X_{i}$
\end_inset

 goes up, then the divider 
\begin_inset Formula $-\beta_{0}-\beta_{1}X_{i}$
\end_inset

 moves to the left, causing the area of 
\begin_inset Formula $y=1$
\end_inset

 to become larger.
 BUT it is getting larger on the right side of the graph.
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
If 
\begin_inset Formula $Z_{i}$
\end_inset

 is greater than 0, then 
\begin_inset Formula $y_{i}=1$
\end_inset

.
 Else 
\begin_inset Formula $y_{i}=0$
\end_inset


\begin_inset Formula 
\[
Z_{i}>0\Rightarrow\beta_{0}+\beta_{1}X_{i}+\varepsilon_{i}>0
\]

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
-\beta_{0}-\beta_{1}X_{i}<\varepsilon_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
In the graphs I showed before, That's the probability of a 0.
\end_layout

\end_deeper
\begin_layout Itemize
Same as saying
\end_layout

\begin_deeper
\begin_layout Itemize
if 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 is greater than 
\begin_inset Formula $-\beta_{0}-\beta_{1}X_{i}$
\end_inset

, then 
\begin_inset Formula $y_{i}=1$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
y_{i}=\left\{ \begin{array}{ll}
1 & if\,-\beta_{0}-\beta_{1}X_{i}<\varepsilon_{i}\\
0 & if\,\varepsilon_{i}\leq-\beta_{0}-\beta_{1}X_{i}
\end{array}\right.\label{eq:ydefined}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{That is a CDF}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Now recall my CDF discussion above.
 The 
\begin_inset Quotes eld
\end_inset

dividing point
\begin_inset Quotes erd
\end_inset

 in the data is 
\begin_inset Formula $-\beta_{0}-\beta_{1}X_{i}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Put 
\begin_inset Quotes eld
\end_inset

some distribution
\begin_inset Quotes erd
\end_inset

 you like as the probability density.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<cdf100, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

x <- seq (-7, 7, by=0.05)
\end_layout

\begin_layout Plain Layout

logis10 <- dlogis(x, location = 0, scale = 1, log = FALSE)
\end_layout

\begin_layout Plain Layout

plot(x, logis10, type="l", ylim=c(0,0.35), xlab=expression(epsilon[i]), ylab="Pro
bability Density", main="")
\end_layout

\begin_layout Plain Layout

xcut <- 0.5
\end_layout

\begin_layout Plain Layout

xlt <- x < xcut
\end_layout

\begin_layout Plain Layout

xmax <- max(x[xlt])
\end_layout

\begin_layout Plain Layout

xseq <- c(x[xlt], rev(x[xlt])) 
\end_layout

\begin_layout Plain Layout

yseq <- c(rep(0, sum(xlt)), rev(logis10[xlt])) 
\end_layout

\begin_layout Plain Layout

polygon(xseq, yseq, col = "gray80")
\end_layout

\begin_layout Plain Layout

text(1, 0.025, pos = 4, "Pr(y = 1)")
\end_layout

\begin_layout Plain Layout

text(-1.25, 0.025, pos = 2, "Pr(y = 0)")
\end_layout

\begin_layout Plain Layout

mtext(expression(-beta[0]-beta[1]*X[i]), 1, at = xcut)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{tmpout/t-cdf100}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In the way I have this scaled, the left side of the graph is the probability
 that 
\begin_inset Formula $y_{i}=0$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\[
\varepsilon_{i}\leq-\beta_{0}-\beta_{1}X_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
Could reverse the scaling if we wanted to reverse the coefficients 
\end_layout

\end_deeper
\begin_layout Itemize
Generally speaking, then, we are modeling the upper limit of an integral:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
Prob(y_{i} & =0|X_{i},\beta)=Prob(e_{i}\leq-\beta_{0}-\beta_{1}X_{i})\label{eq:CDF}\\
 & =F(-\beta_{0}-\beta_{1}X_{i})=\int_{-\infty}^{-\beta_{0}-\beta_{1}X_{i}}f(\varepsilon_{i})d\varepsilon_{i}.
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Logistic Regression
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Logit}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

logistic
\begin_inset Quotes erd
\end_inset

 pdf has a very workable formula.
\end_layout

\begin_layout Itemize
Probability density function for a variable 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\varepsilon_{i}$
\end_inset


\begin_inset Quotes erd
\end_inset

:
\begin_inset Formula 
\begin{equation}
f(\varepsilon_{i})=\frac{exp(-(\varepsilon_{i}-\mu)/\sigma)}{\sigma(1+exp(-(\varepsilon_{i}-\mu)/\sigma))}\label{eq:logistpdf}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
The expected value of 
\begin_inset Formula $x_{i}$
\end_inset

 in this distribution is 
\begin_inset Formula $\mu.$
\end_inset

 
\end_layout

\begin_deeper
\begin_layout Itemize
Models typically assume 
\begin_inset Formula $\mu=0$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\sigma$
\end_inset

 is a scale parameter, NOT the standard deviation
\end_layout

\begin_layout Itemize
The variance is
\begin_inset Formula 
\[
Var(\varepsilon_{i})=\frac{1}{3}(\pi\sigma)^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Customize the Logistic for use in the model}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
So assume 
\begin_inset Formula $\mu=0$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Currently, the software is usually written with the assumption that 
\begin_inset Formula $\sigma=1.0$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
That's an 
\begin_inset Quotes eld
\end_inset

unidentified
\begin_inset Quotes erd
\end_inset

 (unestimable) coefficient.
\end_layout

\end_deeper
\begin_layout Itemize
The PDF simplifies to
\begin_inset Formula 
\begin{equation}
f(\varepsilon_{i})=\frac{e^{-\varepsilon_{i}}}{(1+e^{-\varepsilon_{i}})^{2}}\label{eq:}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Through the magic of integral calculus, the solution is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(y_{i}=0|X_{i},\beta_{i})=\frac{e^{\beta_{0}+\beta_{1}X_{i}}}{1+e^{\beta_{0}+\beta_{1}X_{i}}}=\frac{1}{1+e^{-(\beta_{0}+\beta_{1}X_{i})}}\label{eq:logistic}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Show My Work: Derivation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The indefinite integral is very simple.
 
\begin_inset Formula 
\begin{eqnarray*}
F(\alpha) & = & \int_{-\infty}^{\alpha}\frac{e^{-\varepsilon_{i}}}{(1+e^{-\varepsilon_{i}})^{2}}de_{i}\\
 & =\frac{e^{\alpha}}{1+e^{\alpha}} & =\frac{1}{1+e^{-\alpha}}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Probit Regression
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Probit}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $\varepsilon_{i}$
\end_inset

 be 
\end_layout

\begin_layout Itemize
Normally distributed.
 
\end_layout

\begin_layout Itemize
The Normal is a 
\begin_inset Quotes eld
\end_inset

good
\begin_inset Quotes erd
\end_inset

 distribution in many respects, especially because of 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
the central limit theorem
\end_layout

\begin_layout Itemize
the (relatively) easy extension of the Normal to a multi-dimensional outcome
 variable.
\end_layout

\end_deeper
\begin_layout Itemize
However, it is more computationally intensive.
\end_layout

\begin_layout Itemize
The PDF is
\begin_inset Formula 
\[
f(\varepsilon_{i})=\frac{1}{\sqrt{2\pi\sigma^{2}}}e^{-\frac{(\varepsilon_{i}-\mu)^{2}}{2\sigma^{2}}}
\]

\end_inset


\end_layout

\begin_layout Itemize
But there is no simple formula for the integral
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(y_{i}=1|X_{i},\beta_{i})=\int_{-\infty}^{\beta_{0}+\beta_{1}X_{i}}\frac{1}{\sqrt{2\pi\sigma^{2}}}\cdot e^{-}\frac{(e_{i}-\mu)^{2}}{2\sigma^{2}}de_{i}\label{eq:probit}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Assume
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\mu=0$
\end_inset

.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\sigma^{2}=1$
\end_inset

.
 
\begin_inset Formula $\sigma^{2}$
\end_inset

 is called the 
\begin_inset Quotes eld
\end_inset

scale parameter
\begin_inset Quotes erd
\end_inset

, it is unidentified (can't be estimated).
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Probit Notation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Because the probit equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:probit"

\end_inset

 is such a complicated thing to write down, articles in almost always avoid
 it, instead calling it 
\begin_inset Formula $\Phi$
\end_inset

, to refer to the cumulative probability distribution.
 
\begin_inset Formula 
\begin{equation}
P(y_{i}=1|X_{i},\beta_{i})=\Phi(\beta_{0}+\beta_{1}X_{i})\label{eq:probit2}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
We don't usually think about this in the two-category model, but the probability
 of observing a 
\begin_inset Formula $0$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(y_{i}=0|X_{i},\beta_{i})=1-\Phi(\beta_{0}+\beta_{1}X_{i})\label{eq:compl}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Does it matter if you use Logit or Probit?}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
6cm
\end_layout

\begin_layout Itemize
Not very much.
 The PDF of the Logistic and the Normal distributions overlap to a considerable
 extent.
 
\end_layout

\begin_layout Itemize
Adjust the parameter 
\begin_inset Formula $\sigma$
\end_inset

 of the logistic so that the variance of the Logistic and the Normal distributio
ns are the same.
\end_layout

\begin_layout Itemize
Normal with 
\begin_inset Formula $\sigma=1$
\end_inset

 Logistic std.dev.= 
\begin_inset Formula $\pi/\sqrt{3}$
\end_inset

.
\end_layout

\begin_layout Column
6cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<landn,echo=F, include=F, fig=T,height=6, width=6>>=
\end_layout

\begin_layout Plain Layout

x <- seq(-6,6, by=0.05)
\end_layout

\begin_layout Plain Layout

mylogis111 <- dlogis(x, location = 0, scale = 1, log = FALSE) 
\end_layout

\begin_layout Plain Layout

myNorm <- dnorm(x, mean = 0, sd = pi/sqrt(3)) 
\end_layout

\begin_layout Plain Layout

matplot(x, cbind(mylogis111, myNorm),type="l",ylim=c(0,0.5), xlab="x", ylab="P(x)
", main="") 
\end_layout

\begin_layout Plain Layout

normlabel = expression(paste("Normal(",0,",",pi^{2}/3,")"))
\end_layout

\begin_layout Plain Layout

legend("topleft", c("Logistic(0,1)",normlabel), lty=1:2, col=1:2) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{tmpout/t-landn}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Probit
\end_layout

\begin_layout Subsection*
Fit
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Fit a probit model}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<probit1, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

glm2 <- glm(y2~x2, family=binomial(probit))
\end_layout

\begin_layout Plain Layout

summary(glm2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-probit1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Compare Logit and Probit
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Coefficients differ}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<logitprobit10, echo=F, include=F, results=tex>>=
\end_layout

\begin_layout Plain Layout

outreg(list(Logit = glm1, Probit = glm2), showAIC=T, 
\end_layout

\begin_layout Plain Layout

       request = c("fstatistic" = "F"))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-logitprobit10}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Coefficients generally proportional to each other, will explain why
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{And you see now why people don't care if you use Logit or Probit}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<probit2, include=T, echo=T>>=
\end_layout

\begin_layout Plain Layout

options(scipen = 10)
\end_layout

\begin_layout Plain Layout

p1 <- predictOMatic(glm1, predVals = c(x2 = "seq"), n = 10)
\end_layout

\begin_layout Plain Layout

p2 <- predictOMatic(glm2, predVals=c(x2 = "seq"), n = 10)
\end_layout

\begin_layout Plain Layout

cbind(p1, p2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Compare the S-shaped curves}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<probit10, fig=T, include=F, echo=F, height = 5, width = 8>>=
\end_layout

\begin_layout Plain Layout

plot(x2,y2)
\end_layout

\begin_layout Plain Layout

p1 <- predictOMatic(glm1, predVals = c(x2 = "seq"), n = 50)
\end_layout

\begin_layout Plain Layout

p2 <- predictOMatic(glm2, predVals=c(x2 = "seq"), n = 50)
\end_layout

\begin_layout Plain Layout

lines(p1$x2, p1$fit, lty=1)
\end_layout

\begin_layout Plain Layout

lines(p2$x2, p2$fit, lty=2)
\end_layout

\begin_layout Plain Layout

legend("topleft", legend=c("Logit", "Probit"), lty=c(1,2))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{tmpout/t-probit10.tex}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=12cm]{tmpout/t-probit10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Summary: Comparison of Logit/Probit?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
What is the difference? 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Logit is based on the Logistic distribution, the 
\begin_inset Formula $\hat{\eta}_{i}$
\end_inset

 is converted into probabilities by the logistic CDF
\end_layout

\begin_layout Itemize
Probit is based on the Normal distribution, the 
\begin_inset Formula $\hat{\eta}_{i}$
\end_inset

 is converted into probabilities by the normal CDF
\end_layout

\end_deeper
\begin_layout Itemize
In practice, Is there a big difference?
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Not if your dependent variable is dichotomous
\end_layout

\begin_layout Itemize
Otherwise, there can be big differences, more caution needed
\end_layout

\end_deeper
\begin_layout Itemize
Field dependent
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Psychologists pretty strongly prefer logistic
\end_layout

\begin_layout Itemize
Economists pretty strongly prefer probit
\end_layout

\begin_layout Itemize
Political scientists indifferent
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Testing Statistical Significance
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{z-test and t-test: two approximations}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Asymptotically, 
\begin_inset Formula $\hat{\beta}$
\end_inset

 is Normal (recall fundamental ML Theory).
 We have the standard error.
 What about the quantity: 
\begin_inset Formula 
\[
\frac{\hat{\beta}-\beta_{null}}{s.e.(\hat{\beta})}
\]

\end_inset


\end_layout

\begin_layout Itemize
it looks like a 
\begin_inset Formula $t-test$
\end_inset

, doesn't it? 
\end_layout

\begin_layout Itemize
More correct to say it is a 
\begin_inset Formula $z$
\end_inset

 statistic, approximately Normally distributed 
\begin_inset Formula 
\begin{equation}
z=\frac{\hat{\beta}-\beta_{null}}{s.e.(\hat{\beta})}\label{eq:logitttest}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Wald $
\backslash
chi^2$ test: another approximation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The Wald Chi-square is the ratio of the squared estimate to the variance,
\begin_inset Formula $\hat{\beta}^{2}/Var(\hat{\beta})$
\end_inset

.
 But alert users will note that it is simply 
\begin_inset Formula $z^{2}$
\end_inset

.
 
\begin_inset Formula 
\begin{equation}
z^{2}=\left(\frac{\hat{\beta}}{s.e.(\hat{\beta})}\right)^{2}\label{eq:zsquare}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Wald contended that value is distributed as a 
\begin_inset Formula $\chi^{2}$
\end_inset

 variable.
 The square root 
\begin_inset Formula $\hat{\beta}/se(\hat{\beta})$
\end_inset

 is approximately Normal (and also approximately t-distributed).
 That explains why some programs call the statistic 
\begin_inset Formula $\hat{\beta}/se(\hat{\beta})$
\end_inset

 a 
\begin_inset Formula $t$
\end_inset

 variable, while others call it a 
\begin_inset Formula $Z$
\end_inset

 statistic.
 
\end_layout

\begin_layout Itemize
From elementary statistics, we know that the square root of a 
\begin_inset Formula $\chi^{2}$
\end_inset

 variable with one degree of freedom is Normal(0,1), so the Wald Chi-Square
 test for a single parameter is actually substantively IDENTICAL to the
 
\begin_inset Formula $t$
\end_inset

 or 
\begin_inset Formula $z$
\end_inset

 approaches.
\end_layout

\begin_layout Itemize
The Wald Chi-Square can be used to simultaneously test several coefficients.
 
\begin_inset Formula 
\[
\hat{\beta}Var(\hat{b)}^{-1}\hat{\beta}
\]

\end_inset


\end_layout

\begin_layout Itemize
Note that if we were testing only one parameter, this degenerates to the
 preceding equation.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{How to estimate the standard errors?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
It is probably enough for beginners to believe that we can calculate standard
 errors from ML estimation are estimates of the standard deviation of sampling
 distributions.
\end_layout

\begin_layout Itemize
Nevertheless, here's something worth noting and its not too complicated.
 This insight was gathered from literature on the Generalized Linear Model.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Recall, in OLS, the variance/covariance matrix of the estimated 
\begin_inset Formula $b$
\end_inset

's is
\begin_inset Formula 
\begin{equation}
Var(\hat{\beta}^{OLS})=\sigma^{2}(X'X)^{-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
For the ordinary logistic regression model, the covariance-variance matrix
 is 
\begin_inset Formula 
\begin{equation}
Var(\hat{\beta})=\left[X'WX\right]^{-1}\label{eq:varcovar}
\end{equation}

\end_inset

which is almost the same.
 In fact, it would be exactly the same if not for the fact that the cases
 have unique variances.
\end_layout

\begin_layout Itemize
The matrix in the middle, 
\begin_inset Formula $W$
\end_inset

, has the variance of the individual cases:
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
W=\left[\begin{array}{ccccc}
P_{1}(1-P_{1}) & 0 & 0 & 0 & 0\\
0 & P_{2}(1-P_{2}) & 0 & 0 & 0\\
0 & \cdots\\
0 & \cdots\\
0 & 0 & 0 & 0 & P_{N}(1-P_{N})
\end{array}\right]\label{eq:varmatrix}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We don't know the 
\begin_inset Quotes eld
\end_inset

true variances
\begin_inset Quotes erd
\end_inset

 because we don't know the true probabilities.
 But we can use approximations from fitted models to get those values.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Diagnostics
\end_layout

\begin_layout Subsection
Likelihood Ratio Test
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Likelihood Ratio Test for Nested Models}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Should you remove some variables from your model? Perhaps all of them?
\end_layout

\begin_layout Itemize
Some programs report a 
\begin_inset Quotes eld
\end_inset

model chi-square
\begin_inset Quotes erd
\end_inset

, equivalent to 
\begin_inset Formula $-2ln(LikelihoodRatio)$
\end_inset

 or 
\begin_inset Formula $-2LLR$
\end_inset

, which is the difference between 
\begin_inset Formula $-2ln(Likelihood\,of\,fitted\,model)$
\end_inset

 and 
\begin_inset Formula $-2ln(Likelihood\,of\,constant-only\,model).$
\end_inset


\end_layout

\begin_layout Itemize
The likelihood ratio test can be used to compare any two models that are
 estimated ON THE SAME DATA.
 
\end_layout

\begin_layout Itemize
Comparing a full model against a subset, the following can be used to test
 the hypothesis that the coefficients for a set of variables are all equal
 to zero.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
=-2[ln{L_{restricted}}-ln{L_{full}}]=-2ln{\left[\frac{L_{restricted}}{L_{full}}\right]}\sim\chi_{diff}^{2}\label{eq:LLR}
\end{equation}

\end_inset

 where 
\begin_inset Formula $diff$
\end_inset

 is the difference in the number of fitted parameters, or 
\begin_inset Quotes eld
\end_inset

excluded variables
\begin_inset Quotes erd
\end_inset

 from the restricted model.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Deviance to Diagnose Model Fit
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Deviance and the Liklelihood of the Saturated Model}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Deviance is a benchmark: how deficient is your fitted model?
\end_layout

\begin_layout Itemize
Formally, deviance is difference between a 
\begin_inset Quotes eld
\end_inset

saturated
\begin_inset Quotes erd
\end_inset

 model and your 
\begin_inset Quotes eld
\end_inset

fitted
\begin_inset Quotes erd
\end_inset

 model
\end_layout

\begin_layout Itemize
A 
\begin_inset Quotes eld
\end_inset

saturated model
\begin_inset Quotes erd
\end_inset

 is one in which we are allowed to make a unique estimate of 
\begin_inset Formula $\widehat{P_{i}}$
\end_inset

 for each unique combination of the input variables.
 The 
\begin_inset Quotes eld
\end_inset

best possible
\begin_inset Quotes erd
\end_inset

 deviance value often reduces the log likelihood to 
\begin_inset Formula $0$
\end_inset

.
\end_layout

\begin_layout Itemize
So, Formally, deviance is the difference in the 2 models:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula 
\begin{equation}
2ln(Likelihood\,of\,saturated\,model)-2ln(Likelihood\,of\,fitted\,model)
\end{equation}

\end_inset


\begin_inset Newline newline
\end_inset

 
\end_layout

\begin_layout Standard
it usually boils down to
\begin_inset Formula 
\begin{equation}
-2ln(Likelihood\,of\,fitted\,model)
\end{equation}

\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
Deviance is an indicator of 
\begin_inset Quotes eld
\end_inset

how bad
\begin_inset Quotes erd
\end_inset

 your model is when compared against the saturated model.
 
\end_layout

\begin_layout Itemize
Myers, Montgomery, and Vining (2002) observe, (I'm paraphrasing notation
 here to match the above notation) 
\begin_inset Quotes eld
\end_inset

Formally, an insignificant value of (deviance) in a one-tailed test implies
 that the fit of the model is not significantly worse than that of the saturated
 model.
 ...
 Often the rule of thumb is applied that the quality of fit is reasonable
 if 
\begin_inset Formula $\frac{deviance}{N-p}$
\end_inset

 is not appreciably larger than 1.
 The rule of thumb is prompted by the fact that N-p is the mean of the 
\begin_inset Formula $\chi_{N-p}^{2}$
\end_inset

 distribution
\begin_inset Quotes erd
\end_inset

(p.
 113).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Hosmer and Lemeshow test
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{H-L test: Do your Predicted Probabilities Match Observed Percentages?
}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Calculate predicted probabilities, 
\begin_inset Formula $\hat{P_{i}}$
\end_inset

 for all cases.
 
\end_layout

\begin_layout Itemize
Sort the data by 
\begin_inset Formula $\hat{P}_{i}$
\end_inset

.
 Subdivide the sample into subgroups.
 
\end_layout

\begin_layout Itemize
Find out if the observed frequency of 1's and 0's matches the estimated
 probabilities from the model.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{H-L Test boils down to a $
\backslash
chi^2$ statistic}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Pick some pleasant number of subgroups, say 10.
 For each subgroup, one can calculate the observed 
\begin_inset Quotes eld
\end_inset

success rate
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $O_{i}$
\end_inset

 and an expected (from the model) success rate, and the 
\begin_inset Formula $\chi^{2}$
\end_inset

 test is used to find out if the model is grossly out-of-whack.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
homer.and.lemeshow_{\chi}^{2}=\sum_{i=1}^{10}\left[\frac{(O_{i}-E_{i})^{2}}{E_{i}}\right]\label{eq:hosmer}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
If the 
\begin_inset Formula $\chi^{2}$
\end_inset

 value is extreme by that standard, it means that your predicted probabilities
 do not match the observations very well.
\end_layout

\begin_layout Standard
That is informative, but not too informative.
 It does not tell you if the model is 
\begin_inset Quotes eld
\end_inset

off
\begin_inset Quotes erd
\end_inset

 for any particular reason, and there could be many suspects in your search
 for the criminal.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Separation
\end_layout

\begin_layout Subsection
ROC curves
\end_layout

\begin_layout Subsection
Overdispersion
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Overdispersion: Extra-Binomial Variation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Suppose your deviance is very high.
 
\end_layout

\begin_layout Itemize
The Logit model assumes the binomial variance is 
\begin_inset Formula $P_{i}(1-P_{1})$
\end_inset

 
\end_layout

\begin_layout Itemize
That means that when the model has 
\begin_inset Formula $\hat{P}=0.9$
\end_inset

, there's only a very small chance you will observe a 0.
 Sometimes you observe more 0's and 1's in the extremes than you expect.
\end_layout

\begin_layout Itemize
The cause may be 
\begin_inset Quotes eld
\end_inset

frailty
\begin_inset Quotes erd
\end_inset

, an extra amount of randomness in your study responses.
 This 
\begin_inset Quotes eld
\end_inset

extrabinomial variation
\begin_inset Quotes erd
\end_inset

 might be the cause of your poor fit.
\end_layout

\begin_layout Itemize
The effects of overdispersion are the same as heteroskedasticity in the
 OLS model.
 The estimated variance-covariance matrix of the 
\begin_inset Formula $\hat{\beta}$
\end_inset

's does not match the true variance of the 
\begin_inset Formula $\hat{\beta}$
\end_inset

's.
\end_layout

\begin_layout Itemize
Perhaps departure/respecification is needed.
 For example, instead of assuming that all cases with the same inputs should
 have the same predicted probability, suppose instead there is an unmeasured
 error term that affects the subgroups in the dataset.
 So, if one started with 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:probit2"

\end_inset

, one could insert an error term, a random component that afflicts the members
 of group 
\begin_inset Formula $j$
\end_inset

: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P(y_{i}=1|X_{i},\beta_{i})=\Phi(\beta_{0}+\beta_{1}X_{i}+e_{j})\label{eq:frailty}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
This model is a mixed model, one in which there is a random coefficient
 that should be taken into account.
 In R, it is covered in the lmer procedure of lme4 package or the GLMM package
 (which is simpler to use at the current time) 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{References}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "theme/R"
options "apalike2"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Session}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<sess10>>=
\end_layout

\begin_layout Plain Layout

sessionInfo()
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<opts20, include=F>>=
\end_layout

\begin_layout Plain Layout

## Don't delete this.
 It puts the interactive session options
\end_layout

\begin_layout Plain Layout

## back the way they were.
 If this is compiled within a session
\end_layout

\begin_layout Plain Layout

## it is vital to do this.
\end_layout

\begin_layout Plain Layout

options(opts.orig)
\end_layout

\begin_layout Plain Layout

options(par.orig)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
