#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass sweavel-beamer
\begin_preamble
\usepackage{dcolumn}
\usepackage{booktabs}

% use 'handout' to produce handouts
%\documentclass[handout]{beamer}
\usepackage{wasysym}
\usepackage{pgfpages}
\newcommand{\vn}[1]{\mbox{{\it #1}}}\newcommand{\vb}{\vspace{\baselineskip}}\newcommand{\vh}{\vspace{.5\baselineskip}}\newcommand{\vf}{\vspace{\fill}}\newcommand{\splus}{\textsf{S-PLUS}}\newcommand{\R}{\textsf{R}}


\usepackage{graphicx}
\usepackage{listings}
\lstset{tabsize=2, breaklines=true,style=Rstyle}
\usetheme{Antibes}
% or ...

%\setbeamercovered{transparent}
% or whatever (possibly just delete it)

%\mode<presentation>
%{
 % \usetheme{KU}
 % \usecolortheme{dolphin} %dark blues
%}

% In document Latex options:
\fvset{listparameters={\setlength{\topsep}{0em}}}
\def\Sweavesize{\scriptsize} 
\def\Rcolor{\color{black}} 
\def\Rbackground{\color[gray]{0.95}}



\mode<presentation>

\newcommand\makebeamertitle{\frame{\maketitle}}%

\setbeamertemplate{frametitle continuation}[from second]
\renewcommand\insertcontinuationtext{...}

\expandafter\def\expandafter\insertshorttitle\expandafter{%
 \insertshorttitle\hfill\insertframenumber\,/\,\inserttotalframenumber}
\end_preamble
\use_default_options false
\begin_modules
sweave
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman lmodern
\font_sans lmss
\font_typewriter lmtt
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 0
\branch R
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch notrun
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Branch R
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

##causes failure, don't understand why
\end_layout

\begin_layout Plain Layout

##unlink("plots", recursive=T)
\end_layout

\begin_layout Plain Layout

dir.create("plots", showWarnings=T)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=plots/t,split=T,ae=F,height=4,width=6}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Roptions, echo=F>>=
\end_layout

\begin_layout Plain Layout

options(width=65, prompt=" ", continue="  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE) 
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

op <- par() 
\end_layout

\begin_layout Plain Layout

pjmar <- c(5.1, 5.1, 1.5, 2.1) 
\end_layout

\begin_layout Plain Layout

#pjmar <- par("mar")
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(mar=pjmar, ps=12)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=F,family="Times",pointsize=12)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Title
Regression Diagnostics
\begin_inset Argument
status open

\begin_layout Plain Layout
Diag
\end_layout

\end_inset


\end_layout

\begin_layout Author
Paul E.
 Johnson
\begin_inset Flex InstituteMark
status open

\begin_layout Plain Layout
1
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
and
\end_layout

\end_inset

 
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
2
\end_layout

\end_inset


\end_layout

\begin_layout Institute
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
1
\end_layout

\end_inset

Department of Political Science
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
and
\end_layout

\end_inset

 
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
2
\end_layout

\end_inset

Center for Research Methods and Data Analysis, University of Kansas
\begin_inset Argument
status open

\begin_layout Plain Layout
K.U.
\end_layout

\end_inset


\end_layout

\begin_layout Date
2015
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
The following causes the table of contents to be shown at the beginning
 of every subsection.
 Delete this, if you do not want it.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
AtBeginSection[]{
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  
\backslash
frame<beamer>{ 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    
\backslash
frametitle{Outline}   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    
\backslash
tableofcontents[currentsection,currentsubsection] 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
frametitle{Outline}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout BeginFrame
Problem
\end_layout

\begin_layout Itemize
Recall the lecture about diagnostic plots?
\end_layout

\begin_layout Itemize
Remember some plots used terms 
\begin_inset Quotes eld
\end_inset

leverage
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Cook's Distance
\begin_inset Quotes erd
\end_inset

?
\end_layout

\begin_layout Itemize
I said we'd come to a day when I had to try to explain that?
\end_layout

\begin_deeper
\begin_layout Itemize
The day of reckoning has come.
\end_layout

\end_deeper
\begin_layout EndFrame

\end_layout

\begin_layout Section
Quick Summary Before Too Many Details
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Recall the Public Spending Example Data Set}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<hideme, echo=F, include=F>>=
\end_layout

\begin_layout Plain Layout

library(car)
\end_layout

\begin_layout Plain Layout

library(rockchalk)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress05, echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

dat <- read.table("/home/pauljohn/ps/SVN-guides/stat/DataSets/PublicSpending/publ
icspending.txt", header = TRUE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To get the publicspending dataset, download publicspending.txt in a Web browser,
 or run
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=T, eval=F, include=T>>=
\end_layout

\begin_layout Plain Layout

dat <- read.table("http://pj.freefaculty.org/guides/stat/DataSets/PublicSpending/pu
blicspending.txt", header = TRUE)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress06, echo=T>>==
\end_layout

\begin_layout Plain Layout

summarize(dat)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This time, I decided to create MET squared before running the model, but
 you will recall there are at least 4 different ways to run this regression.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress10, echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

dat$METSQ <- dat$MET*dat$MET
\end_layout

\begin_layout Plain Layout

EXfull2 <- lm(EX ~ ECAB + MET + METSQ + GROW + YOUNG + OLD + WEST, data=dat)
\end_layout

\begin_layout Plain Layout

summary(EXfull2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots/t-regress10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Recall the Public Spending Example Data Set}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress11, fig=T, include=F, height=6, width=9>>=
\end_layout

\begin_layout Plain Layout

par(mfcol=c(2,2))
\end_layout

\begin_layout Plain Layout

plot(EXfull2)
\end_layout

\begin_layout Plain Layout

par(mfcol=c(1,1))
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=11cm]{plots/t-regress11}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{influence.measures() provides one line per case in data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress20, echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

EXfull2infl <- influence.measures(EXfull2)
\end_layout

\begin_layout Plain Layout

print(EXfull2infl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
tiny}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots/t-regress20}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout BeginFrame
What is All that Stuff About?
\end_layout

\begin_layout Itemize
dfbetas.
 Change in 
\begin_inset Formula $\hat{\beta}$
\end_inset

 when row i is removed.
\end_layout

\begin_layout Itemize
dffits.
 Change in prediction for i from N-{i}
\end_layout

\begin_layout Itemize
cook.d.
 Cook's d summary of a case's damage
\end_layout

\begin_layout Itemize
hat value.
 Commonly called 
\begin_inset Quotes eld
\end_inset

leverage.
\end_layout

\begin_layout Itemize
Can ask for these one-by-one when you want them, see ?influence.measures
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{influence.measures Creates a Summary Object}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
influence.measures is row-by-row, perhaps necessary in some situations, but
 excessive most of the time.
\end_layout

\begin_layout Itemize
More simply, ask which rows are potentially troublesome with the summary
 function:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress30, echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

summary(EXfull2infl)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%%
\backslash
def
\backslash
Sweavesize{
\backslash
footnotesize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots/t-regress30}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
The Hat Matrix
\end_layout

\begin_layout BeginFrame
Bear With Me for A Moment, Please
\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset

solution
\begin_inset Quotes erd
\end_inset

 for the OLS estimator in matrix format is
\begin_inset Formula 
\begin{equation}
\hat{\beta}=(X^{T}X)^{-1}X^{T}y
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
And so the predicted value is calculated as
\begin_inset Formula 
\begin{eqnarray*}
\hat{y} & = & X\hat{\beta}\\
 &  & X(X^{T}X)^{-1}X^{T}y
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Itemize
Definiton: The Hat Matrix is that big glob of 
\begin_inset Formula $X$
\end_inset

's.
 
\begin_inset Formula 
\begin{equation}
H=X(X^{T}X)^{-1}X^{T}
\end{equation}

\end_inset


\end_layout

\begin_layout BeginFrame
Just One More Moment ...
\end_layout

\begin_layout Standard
The hat matrix is just a matrix
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
H=\left[\begin{array}{ccccc}
h_{11} & h_{12} & \ldots & h_{1(N-1)} & h_{1N}\\
h_{21} & h_{22} & \vdots & h_{2(N-1)} & h_{2N}\\
\\
 &  &  &  & h_{(N-1)N}\\
h_{N1} & h_{N2} & \ldots & h_{N(N-1)} & h_{NN}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
LEVERAGE: The 
\begin_inset Formula $h_{ii}$
\end_inset

 values (the 
\begin_inset Quotes eld
\end_inset

main diagonal
\begin_inset Quotes erd
\end_inset

 values of this matrix)
\end_layout

\begin_layout BeginFrame
But it is a Very Informative Matrix!
\end_layout

\begin_layout Itemize
It is a matrix that translates observed 
\begin_inset Formula $y$
\end_inset

 into predicted 
\begin_inset Formula $\hat{y}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Write out the prediction for the 
\begin_inset Formula $i'th$
\end_inset

 row 
\begin_inset Formula 
\begin{equation}
\hat{y}_{i}=h_{i1}y_{1}+h_{i2}y_{2}+\ldots+h_{iN}y_{N}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
That's looking at H 
\begin_inset Quotes eld
\end_inset

from side to side,
\begin_inset Quotes erd
\end_inset

 to see if one case is influencing the predicted value from another.
\end_layout

\begin_layout BeginFrame
Be clear, Could Write Out Each Case
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\begin{array}{c}
\hat{y}_{1}\\
\hat{y_{2}}\\
\hat{y_{3}}\\
\vdots\\
\\
\hat{y}_{N-1}\\
\hat{y_{N}}
\end{array}\right]=\left[\begin{array}{ccccc}
h_{11}y_{1} & +h_{12}y_{2} &  &  & +h_{1N}y_{N}\\
h_{21}y_{1} & + &  &  & +h_{2N}y_{N}\\
h_{31}y_{1} & + & \ddots &  & \vdots\\
\vdots\\
\\
 &  &  & h_{(N-1)(N-1)}y_{N-1} & +h_{(N-1)N}y_{N}\\
h_{N1}y_{1} & + & \cdots & +h_{N(N-1)}y_{N-1} & +h_{NN}y_{N}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Section
Spot Extreme Cases
\end_layout

\begin_layout BeginFrame
Diagonal Elements of 
\begin_inset Formula $H$
\end_inset


\end_layout

\begin_layout Itemize
Consider at the diagonal of the hat matrix: 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{ccccc}
h_{11}\\
 & h_{22}\\
 &  & \ddots\\
 &  &  & h_{N-1,N-1}\\
 &  &  &  & h_{NN}
\end{array}\right]\label{eq:hatdiag}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $h_{ii}$
\end_inset

 are customarily called 
\begin_inset Quotes eld
\end_inset

leverage
\begin_inset Quotes erd
\end_inset

 indicators
\end_layout

\begin_layout Itemize
\begin_inset Formula $h_{ii}$
\end_inset

 DEPEND ONLY ON THE X's.
 In a sense, 
\begin_inset Formula $h_{ii}$
\end_inset

 measures how far a case is from 
\begin_inset Quotes eld
\end_inset

the center
\begin_inset Quotes erd
\end_inset

 or all cases.
\end_layout

\begin_layout BeginFrame
leverage
\end_layout

\begin_layout Itemize
The sum of the leverage estimates is 
\begin_inset Formula $p$
\end_inset

, the number of parameters estimated (including the intercept).
\end_layout

\begin_layout Itemize
the most 
\begin_inset Quotes eld
\end_inset

pleasant
\begin_inset Quotes erd
\end_inset

 result would be that all of the elements are the same, so pleasant hat
 values would be 
\begin_inset Formula $p/N$
\end_inset


\end_layout

\begin_layout Itemize
small 
\begin_inset Formula $h_{ii}$
\end_inset

 means that the positioning of an observation in the X space is not in position
 to exert an extraordinary influence.
\end_layout

\begin_layout BeginFrame
Follow Cohen, et al on this
\end_layout

\begin_layout Itemize
The hat value is a summary of how far 
\begin_inset Quotes eld
\end_inset

out of the usual
\begin_inset Quotes erd
\end_inset

 a case is on the IVs
\end_layout

\begin_layout Itemize
In a model with only one predictor, CCWA claim (p.
 394)
\begin_inset Formula 
\begin{equation}
h_{ii}=\frac{1}{N}+\frac{(x_{i}-\bar{x})^{2}}{\sum x_{i}^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
If a case is 
\begin_inset Quotes eld
\end_inset

at the mean,
\begin_inset Quotes erd
\end_inset

 the 
\begin_inset Formula $h_{ii}$
\end_inset

 is as small as it can get
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Hat Values in the State Spending Data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress40, echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

dat$hat <- hatvalues(EXfull2)
\end_layout

\begin_layout Plain Layout

sum(dat$hat)
\end_layout

\begin_layout Plain Layout

data.frame(dat$STATE, dat$hat)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
footnotesize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots/t-regress40}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Vertical Perspective
\end_layout

\begin_layout BeginFrame
Fun Regression Fact
\end_layout

\begin_layout Itemize
All of the 
\begin_inset Quotes eld
\end_inset

unmeasured error terms
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $e_{i}$
\end_inset

 have the same variance, 
\begin_inset Formula $\sigma_{e}^{2}$
\end_inset


\end_layout

\begin_layout Itemize
For each case, we make a prediction 
\begin_inset Formula $\hat{y}_{i}$
\end_inset

 and calculate a residual, 
\begin_inset Formula $\widehat{e_{i}}$
\end_inset


\end_layout

\begin_layout Itemize
Here's the fun fact: The variance of a residual estimate 
\begin_inset Formula $Var(\hat{e}_{i})$
\end_inset

 is not a constant, it varies from one value of 
\begin_inset Formula $x$
\end_inset

 to another.
\end_layout

\begin_layout BeginFrame
Many Magical Properties of H
\end_layout

\begin_layout Itemize
The column of residuals 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
is 
\begin_inset Formula $\hat{e}=(I-H)y$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Proof
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula $\hat{e}=y-X\hat{\beta}$
\end_inset


\begin_inset Formula $=y-Hy$
\end_inset


\begin_inset Formula $=(I-H)y$
\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
The elements on the diagonal of 
\begin_inset Formula $H$
\end_inset

 are the important ones in many cases, because you can take, say, the 10'th
 observation, and you calculate the variance of the residual for that observatio
n:
\begin_inset Formula 
\[
Var(\hat{e}_{10})=\hat{\sigma}_{e}^{2}(1-h_{10,10})
\]

\end_inset


\end_layout

\begin_layout Itemize
And the estimated standard deviation of the residual is 
\begin_inset Formula 
\begin{equation}
Std.Err.(\hat{e}_{10})=\hat{\sigma}_{e}\sqrt{1-h_{10,10}}
\end{equation}

\end_inset


\end_layout

\begin_layout BeginFrame
Standartized Residuals (Internal Studentized Residuals)
\end_layout

\begin_layout Itemize
Recall the 
\begin_inset Formula $Std.Err.(\hat{e}_{i})$
\end_inset

 is 
\begin_inset Formula $\hat{\sigma}_{e}\sqrt{1-h_{ii}}$
\end_inset


\end_layout

\begin_layout Itemize
A standardized residual is the observed residual divided by its standard
 error
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
standardized\, residual\,\, r_{i}=\frac{\hat{e}_{i}}{\hat{\sigma}_{e}\sqrt{1-h_{ii}}}\label{eq:ri}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Sometimes called an internally studentized residual because case 
\begin_inset Formula $i$
\end_inset

 is left in the data for the calculation of 
\begin_inset Formula $\hat{\sigma}_{e}$
\end_inset

 (same number we call RMSE sometimes)
\end_layout

\begin_layout BeginFrame
Studentized residual (External) are t distributed
\end_layout

\begin_layout Itemize
Problem: 
\begin_inset Formula $i$
\end_inset

 is included in the calculation of 
\begin_inset Formula $\hat{\sigma}_{e}.$
\end_inset

 
\end_layout

\begin_layout Itemize
Fix: Recalculate the RMSE after omitting observation i, call that 
\begin_inset Formula $\widehat{\sigma_{e(-i)}^{2}}$
\end_inset

.
 (external, in sense i is omitted)
\end_layout

\begin_layout Standard

\series bold
\begin_inset Formula 
\begin{equation}
studentized\, residual:\, r_{i}=\frac{\hat{e}_{i}}{\sqrt{\widehat{\sigma_{e(-i)}^{2}}(1-h_{ii})}}=\frac{\hat{e}_{i}}{\widehat{\sigma_{e(-i)}}\sqrt{1-h_{ii}}}\label{eq:Rstudent}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Sometimes called 
\begin_inset Formula $R_{i}$
\end_inset

-Student
\end_layout

\begin_layout Itemize
That follows the Student's t distribution.
 That helps us set a scale.
\end_layout

\begin_layout Itemize
Have to be careful about how to set the 
\begin_inset Formula $\alpha$
\end_inset

 level (multiple comparisons problem)
\end_layout

\begin_layout Itemize
Bonferroni correction (or something like that) would have us shrink the
 required 
\begin_inset Formula $\alpha$
\end_inset

 level because we are making many comparisons, not just one,
\end_layout

\begin_layout BeginFrame
The Hat in 
\begin_inset Formula $\widehat{\sigma_{e(-i)}^{2}}$
\end_inset


\end_layout

\begin_layout Itemize
Quick Note: Not actually necessary to run new regressions to get each 
\begin_inset Formula $\widehat{\sigma_{e(-i)}^{2}}$
\end_inset

.
 There is a formula to calculate that from the hat matrix itself
\begin_inset Formula 
\begin{equation}
\widehat{\sigma_{e(-i)}^{2}}=\frac{(N-p)\hat{\sigma}_{e}^{2}-\frac{e_{i}^{2}}{(1-h_{ii})}}{N-p-1}\label{eq:externalMSE}
\end{equation}

\end_inset


\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{student Residuals in the State Spending Data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress60, echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

dat$rstudent <- rstudent(EXfull2)
\end_layout

\begin_layout Plain Layout

data.frame(dat$STATE, dat$rstudent)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
footnotesize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots/t-regress60}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout BeginFrame
DFFIT, DFFITs
\end_layout

\begin_layout Itemize
Calculate the change in predicted value of the j'th observation due to the
 deletion of observation 
\begin_inset Formula $j$
\end_inset

 from the dataset.
 Call that the DFFIT:
\begin_inset Formula 
\begin{equation}
DFFIT_{j}=\hat{y_{j}}-\hat{y}_{(-j)}\label{eq:DFFIT}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Standardize that (
\begin_inset Quotes eld
\end_inset

studentize
\begin_inset Quotes erd
\end_inset

? that):
\begin_inset Formula 
\begin{equation}
DFFITS_{j}=\frac{\hat{y_{j}}-\hat{y}_{(-j)}}{\hat{\sigma}_{e(-j)}\sqrt{h_{jj}}}\label{eq:DFFITS}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $DFFITS_{j}$
\end_inset

 is large, the 
\begin_inset Formula $j$
\end_inset

'th observation is influential on the model's predicted value for the 
\begin_inset Formula $j$
\end_inset

'th observation.
 In other words, the model does not fit observation 
\begin_inset Formula $j$
\end_inset

.
\end_layout

\begin_layout Standard
Everybody is looking around for a good rule of thumb.
 Perhaps 
\begin_inset Formula $DFFITS>2\sqrt{p/N}$
\end_inset

 means 
\begin_inset Quotes eld
\end_inset

trouble
\begin_inset Quotes erd
\end_inset

! 
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{DFFIT in the State Spending Data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress50, echo=T, include=F>>=
\end_layout

\begin_layout Plain Layout

dat$dffits <- dffits(EXfull2)
\end_layout

\begin_layout Plain Layout

data.frame(dat$STATE, dat$dffits)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
footnotesize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots/t-regress50}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
DFBETA
\end_layout

\begin_layout BeginFrame
\begin_inset Quotes eld
\end_inset

drop-one-at-a-time
\begin_inset Quotes erd
\end_inset

 analysis of slopes 
\end_layout

\begin_layout Itemize
Find out if an observation influences the estimate of a slope parameter.
 
\end_layout

\begin_layout Itemize
Let
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\hat{\beta}$
\end_inset

 a vector of regression slopes estimate using all of the data points
\end_layout

\begin_layout Itemize
\begin_inset Formula $\hat{\beta}_{(-j)}$
\end_inset

 slopes estimate after removing observation 
\begin_inset Formula $j$
\end_inset

 .
\end_layout

\end_deeper
\begin_layout Itemize
The 
\series bold
DFBETA
\series default
 value, a measure of influence of observation 
\begin_inset Formula $j$
\end_inset

 on the parameter estimate, is
\begin_inset Formula 
\begin{equation}
d_{j}=\hat{\beta}-\hat{\beta}_{(-j)}\label{eq:DFBETA}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
If an element in this vector is huge, it means you should be cautious about
 observation 
\begin_inset Formula $j$
\end_inset

.
 
\end_layout

\begin_layout BeginFrame
DFBETAS is Standardized DFBETA
\end_layout

\begin_layout Standard
The notation is getting tedious here
\end_layout

\begin_layout Standard
DFBETAS is considered one-variable-at-a-time, one data row at a time.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $d[i]_{j}$
\end_inset

 be the change in the estimate of 
\begin_inset Formula $\hat{\beta}_{i}$
\end_inset

 when row 
\begin_inset Formula $j$
\end_inset

 is omitted.
 
\end_layout

\begin_layout Standard
Standardize that:
\begin_inset Formula 
\begin{equation}
d[i]_{j}*=\frac{d[i]_{j}}{\sqrt{Var(\hat{\beta}_{i(-j)})}}\label{eq:dfbetaij}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The denominator is the standard error of the estimated coefficient when
 j is omitted.
 
\end_layout

\begin_layout Standard
A rule of thumb that is often brought to bear: If the DFBETAS value for
 a particular coefficient is greater than 
\begin_inset Formula $2/\sqrt{N}$
\end_inset

 then the influence is large.
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{dfbetas in the State Spending Data}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<regress70, echo=T, fig=T, include=F, height=6, width=9>>=
\end_layout

\begin_layout Plain Layout

dfbetasPlots(EXfull2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
footnotesize}
\end_layout

\begin_layout Plain Layout


\backslash
includegraphics[width=12cm]{plots/t-regress70}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout BeginFrame
Comes Back To The Hat
\end_layout

\begin_layout Itemize
Of course, you are wondering why I introduced DFBETA relates to the hat
 matrix.
 
\end_layout

\begin_layout Itemize
Well, the matrix calculation is: 
\begin_inset Formula 
\begin{equation}
d[i]_{j}=\frac{\hat{e}(X'X)^{-1}X_{j}}{1-h_{ii}}\label{eq:dfbetaij2}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Cook's distance
\end_layout

\begin_layout BeginFrame
Cook: Integrating the DFBETA 
\end_layout

\begin_layout Itemize
The DFBETA analysis is unsatisfying because we can calculate a whole vector
 of DFBETAS, one for each parameter, but we only analyze them one-by-one.
 Can't we combine all of those parameters?
\end_layout

\begin_layout Itemize
The Cook distance derives from this question: 
\end_layout

\begin_layout Quote
Is the vector of estimates obtained with observation j omitted, 
\begin_inset Formula $\hat{\beta}_{(-j)}$
\end_inset

, meaningfully different from the vector obtained when all observations
 are used?
\end_layout

\begin_layout Itemize
I.e., evaluate the overall distance between the point 
\begin_inset Formula $\hat{\beta}=(\hat{\beta}_{1},\hat{\beta}_{2},...,\hat{\beta}_{p})$
\end_inset

 and the point 
\begin_inset Formula $\hat{\beta}_{(-j)}=(\hat{\beta}_{1(-j)},\hat{\beta}_{2(-j)},...,\hat{\beta}_{p(-j)})$
\end_inset

 .
 
\end_layout

\begin_layout BeginFrame
My Kingdom for Reasonable Weights
\end_layout

\begin_layout Standard
If we were interested only in raw, unstandardized distance, we could use
 the usual 
\begin_inset Quotes eld
\end_inset

straight line between two points
\begin_inset Quotes erd
\end_inset

 measure of distance.
 
\end_layout

\begin_layout Itemize
Pythagorean Theorem 
\begin_inset Formula 
\begin{equation}
\sqrt{(\hat{\beta}_{1}-\hat{\beta}_{1(-j)})^{2}+(\hat{\beta}_{2}-\hat{\beta}_{2(-j)})^{2}+\ldots(\hat{\beta}_{p}-\hat{\beta}_{p(-j)})^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Cook proposed we weight the distance calculations in order to bring them
 into a meaningful scale.
\end_layout

\begin_layout Itemize
The weights use the estimated 
\begin_inset Formula $\widehat{Var(\hat{\beta})}$
\end_inset

 to scale the results
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{car Package's "influencePlot" Interesting!}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<carinfl10, include=F, fig=T, echo=T>>=
\end_layout

\begin_layout Plain Layout

influencePlot(EXfull2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{plots/t-carinfl10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout BeginFrame
Matrix Explanation of Cook's Proposal
\end_layout

\begin_layout Itemize
Cook's weights: the cross product matrix divided by the number of parameters
 that are estimated and the MSE.
\begin_inset Formula 
\[
\frac{X'X}{p\cdot\hat{\sigma}_{e}^{2}}
\]

\end_inset


\end_layout

\begin_layout Itemize
Cook's distance 
\begin_inset Formula $D_{j}$
\end_inset

 summarizes the size of the difference in parameter estimates when j is
 omitted.
\begin_inset Formula 
\[
D_{j}=\frac{(\hat{\beta}_{(-j)}-\hat{\beta})'X'X(\hat{\beta}_{(-j)}-\hat{\beta})}{p\cdot\hat{\sigma}_{e}^{2}}
\]

\end_inset

 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout BeginFrame
Cook D Explanation (cont)
\end_layout

\begin_layout Itemize
Think of the change in predicted value as 
\begin_inset Formula $X(\hat{\beta}_{(-j)}-\hat{\beta})$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $D_{j}$
\end_inset

 is thus a squared change in predicted value divided by a normalizing factor.
 
\end_layout

\begin_layout Itemize
To see that, regroup as
\begin_inset Formula 
\[
D_{j}=\frac{[X(\hat{\beta}_{(-j)}-\hat{\beta})]'[X(\hat{\beta}_{(-j)}-\hat{\beta})]}{p\cdot\hat{\sigma}_{e}^{2}}
\]

\end_inset


\begin_inset Newline newline
\end_inset

The denominator includes 
\begin_inset Formula $p$
\end_inset

 because there are 
\begin_inset Formula $p$
\end_inset

 parameters that can change and 
\begin_inset Formula $\hat{\sigma}_{e}^{2}$
\end_inset

 is, of course, your friend, the MSE, the estimate of the variance of the
 error term.
\end_layout

\begin_layout BeginFrame
How does the hat matrix figure into that?
\end_layout

\begin_layout Standard
You know what's coming.
 Cook's distance can be calculated as:
\begin_inset Formula 
\begin{equation}
D_{j}=\frac{r_{j}^{2}}{p}\frac{h_{jj}}{(1-h_{jj})}\label{eq:Cookhat}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $r_{j}^{2}$
\end_inset

 is the squared standardized residual.
 
\end_layout

\begin_layout Section
So What? (Are You Supposed to Do?)
\end_layout

\begin_layout BeginFrame
Omit or Re-Estimate
\end_layout

\begin_layout Itemize
Fix the data!
\end_layout

\begin_layout Itemize
Omit the suspicious case
\end_layout

\begin_layout Itemize
Use a 
\begin_inset Quotes eld
\end_inset

robust
\begin_inset Quotes erd
\end_inset

 estimator with a 
\begin_inset Quotes eld
\end_inset

high breakdown
\begin_inset Quotes erd
\end_inset

 point (median versus mean).
 
\end_layout

\begin_deeper
\begin_layout Itemize
in R, look at ?rlm
\end_layout

\end_deeper
\begin_layout Itemize
Revise the whole model as a 
\begin_inset Quotes eld
\end_inset

mixture
\begin_inset Quotes erd
\end_inset

 of different random processes.
\end_layout

\begin_deeper
\begin_layout Itemize
in R, look at package flexmix
\end_layout

\end_deeper
\begin_layout EndFrame

\end_layout

\begin_layout Section
A Simulation Example
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{$y_i = 2 + 0.2*x1 + 0.2*x2 + e_i$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d10, echo=F, include=F, results=tex>>=
\end_layout

\begin_layout Plain Layout

library(rockchalk)
\end_layout

\begin_layout Plain Layout

set.seed(22323)
\end_layout

\begin_layout Plain Layout

stde <- 3
\end_layout

\begin_layout Plain Layout

x1 <- rnorm(15, m=50, s=10)
\end_layout

\begin_layout Plain Layout

x2 <- rnorm(15, m=50, s=10)
\end_layout

\begin_layout Plain Layout

y <- 2 + 0.2 *x1 + 0.2*x2 + stde * rnorm(15,m=0,s=1)
\end_layout

\begin_layout Plain Layout

modbase <- lm(y~x1 + x2)
\end_layout

\begin_layout Plain Layout

outreg(modbase)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
15 cases observed
\end_layout

\begin_layout Column
8cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d11, fig=T, include=F, echo=F>>=
\end_layout

\begin_layout Plain Layout

modout <- mcGraph3(x1, x2, y)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=9cm]{plots/t-ex3d11}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rstudent: scan for large values (t distributed)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d12, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

rstudent(modbase)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d12}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{dfbetas}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d13, include=F, fig=T, echo=T,height=6,width=9>>=
\end_layout

\begin_layout Plain Layout

dfbetasPlots(modbase)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{plots/t-ex3d13}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{leverage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d14, include=F, fig=T>>=
\end_layout

\begin_layout Plain Layout

##plot.lm(modbase, which=5)
\end_layout

\begin_layout Plain Layout

plot(modbase, which=5)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{plots/t-ex3d14}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Add high $h_{ii}$ case, observation 16 (x1=50, x2=0, y=30)}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d20,include=F,  echo=F, fig=T, results=tex>>=
\end_layout

\begin_layout Plain Layout

x1[16] <- 50
\end_layout

\begin_layout Plain Layout

x2[16] <- 0
\end_layout

\begin_layout Plain Layout

y[16] <- 30
\end_layout

\begin_layout Plain Layout

outreg(mod3A <- lm(y~x1+x2))
\end_layout

\begin_layout Plain Layout

modout <- mcGraph3(x1, x2, y)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d20}
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{plots/t-ex3d20.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rstudent: scan for large values (t distributed)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d23, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

rstudent(mod3A)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d23}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{dfbetas}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d24, include=F, fig=T, echo=T,height=6,width=9>>=
\end_layout

\begin_layout Plain Layout

dfbetasPlots(mod3A)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{plots/t-ex3d24}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{leverage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d25, include=F, fig=T>>=
\end_layout

\begin_layout Plain Layout

#plot.lm(mod3A, which=5)
\end_layout

\begin_layout Plain Layout

plot(mod3A, which=5)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{plots/t-ex3d25}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Set the 16th case at (mean(x1), 0), but set y=-10}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d30,include=F,  echo=F, fig=T, results=tex>>=
\end_layout

\begin_layout Plain Layout

y[16] <- -10
\end_layout

\begin_layout Plain Layout

outreg(mod3B <- lm(y~x1+x2))
\end_layout

\begin_layout Plain Layout

modout <- mcGraph3(x1, x2, y)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d30}
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{plots/t-ex3d30.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rstudent: scan for large values (t distributed)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d31, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

rstudent(mod3B)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d31}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{dfbetas}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d32, include=F, fig=T, echo=T,height=6,width=9>>=
\end_layout

\begin_layout Plain Layout

dfbetasPlots(mod3B)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{plots/t-ex3d32}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{leverage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d33, include=F, fig=T>>=
\end_layout

\begin_layout Plain Layout

##plot.lm(mod3B, which=5)
\end_layout

\begin_layout Plain Layout

plot(mod3B, which=5)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{plots/t-ex3d33}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Add a case at (mean(x1), 0), but set y[16]=-30}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned

\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d40,include=F,  echo=F, fig=T, results=tex>>=
\end_layout

\begin_layout Plain Layout

y[16] <- -30
\end_layout

\begin_layout Plain Layout

outreg(mod3C <- lm(y~x1+x2))
\end_layout

\begin_layout Plain Layout

modout <- mcGraph3(x1, x2, y)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d40}
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Column
8cm
\end_layout

\end_deeper
\begin_layout ColumnsTopAligned
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{plots/t-ex3d40.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rstudent: scan for large values (t distributed)}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d41, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

rstudent(mod3C)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots/t-ex3d41}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{dfbetas}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d42, include=F, fig=T, echo=T,height=6,width=9>>=
\end_layout

\begin_layout Plain Layout

dfbetasPlots(mod3C)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{plots/t-ex3d42}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{leverage}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<ex3d43, include=F, fig=T>>=
\end_layout

\begin_layout Plain Layout

#plot.lm(mod3C, which=5)
\end_layout

\begin_layout Plain Layout

plot(mod3C, which=5)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=6cm]{plots/t-ex3d43}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Practice Problems
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand include
filename "RegDiagnostics-1-lecture-problems.lyx"

\end_inset


\end_layout

\begin_layout EndFrame

\end_layout

\end_body
\end_document
