#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass beamer
\begin_preamble
\usepackage{Sweavel}
\usepackage{dcolumn}
\usepackage{booktabs}

% use 'handout' to produce handouts
%\documentclass[handout]{beamer}
\usepackage{wasysym}
\usepackage{pgfpages}
\newcommand{\vn}[1]{\mbox{{\it #1}}}\newcommand{\vb}{\vspace{\baselineskip}}\newcommand{\vh}{\vspace{.5\baselineskip}}\newcommand{\vf}{\vspace{\fill}}\newcommand{\splus}{\textsf{S-PLUS}}\newcommand{\R}{\textsf{R}}


\usepackage{graphicx}
\usepackage{listings}
\lstset{tabsize=2, breaklines=true,style=Rstyle}

% In document Latex options:
\fvset{listparameters={\setlength{\topsep}{0em}}}
\def\Sweavesize{\normalsize} 
\def\Rcolor{\color{black}} 
\def\Rbackground{\color[gray]{0.95}}

%%not for article, but for presentation
\mode<presentation>
  %\newcommand\makebeamertitle{\frame{\maketitle}}%
  \usetheme{Antibes}
  \usecolortheme{dolphin} %dark blues

%%\newcommand\makebeamertitle{\frame{\maketitle}}

%%only for presentation
\setbeamertemplate{frametitle continuation}[from second]
\renewcommand\insertcontinuationtext{...}

\expandafter\def\expandafter\insertshorttitle\expandafter{%
 \insertshorttitle\hfill\insertframenumber\,/\,\inserttotalframenumber}
\end_preamble
\use_default_options false
\begin_modules
sweave
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "lmss" "default"
\font_typewriter "lmtt" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\branch R
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch notrun
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Branch R
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=F>>=
\end_layout

\begin_layout Plain Layout

unlink("plots2", recursive=T)
\end_layout

\begin_layout Plain Layout

dir.create("plots2", showWarnings=T)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

% In document Latex options:
\end_layout

\begin_layout Plain Layout


\backslash
fvset{listparameters={
\backslash
setlength{
\backslash
topsep}{0em}}}
\end_layout

\begin_layout Plain Layout


\backslash
SweaveOpts{prefix.string=plots2/t,split=T,ae=F,height=5,width=7.5}
\end_layout

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize} 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<Roptions, echo=F>>=
\end_layout

\begin_layout Plain Layout

options(width=100, prompt=" ", continue="  ")
\end_layout

\begin_layout Plain Layout

options(useFancyQuotes = FALSE) 
\end_layout

\begin_layout Plain Layout

set.seed(12345)
\end_layout

\begin_layout Plain Layout

op <- par() 
\end_layout

\begin_layout Plain Layout

pjmar <- c(5.1, 5.1, 1.5, 2.1) 
\end_layout

\begin_layout Plain Layout

#pjmar <- par("mar")
\end_layout

\begin_layout Plain Layout

options(SweaveHooks=list(fig=function() par(mar=pjmar, ps=12)))
\end_layout

\begin_layout Plain Layout

pdf.options(onefile=F,family="Times",pointsize=12)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Title
Lecture 2: Multiple Predictors in OLS Regression 
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Multiple Regression
\end_layout

\end_inset


\end_layout

\begin_layout Author
Paul E.
 Johnson
\begin_inset Flex InstituteMark
status open

\begin_layout Plain Layout
1
\end_layout

\end_inset


\end_layout

\begin_layout Institute
\begin_inset Flex InstituteMark
status collapsed

\begin_layout Plain Layout
1
\end_layout

\end_inset

Departments of Political Science & Psychology, KU
\begin_inset Argument 1
status open

\begin_layout Plain Layout
K.U.
\end_layout

\end_inset


\end_layout

\begin_layout Date
\begin_inset Argument 1
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
The following causes the table of contents to be shown at the beginning
 of every subsection.
 Delete this, if you do not want it.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
AtBeginSection[]{
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  
\backslash
frame<beamer>{ 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    
\backslash
frametitle{Outline}   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    
\backslash
tableofcontents[currentsection,currentsubsection] 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

  }
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
frametitle{Outline}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{What the heck is this lecture about?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Cautions about variable selection
\end_layout

\begin_layout Itemize
partial and semi-partial correlations, and 
\begin_inset Quotes eld
\end_inset

importance
\begin_inset Quotes erd
\end_inset

 conundrum
\end_layout

\begin_layout Itemize
W&R notation for regression
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Choosing Variables: An Unsolved Problem
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{How to decide which variables belong in a model?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
At its core, multiple regression has NOT MUCH to say about this.
\end_layout

\begin_layout Itemize
Regression models are fit with the assumption that the correct variables
 were selected.
\end_layout

\begin_layout Itemize
Leaving a variable out means you assume 
\begin_inset Formula $\beta_{j}=0.$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

Automatic
\begin_inset Quotes erd
\end_inset

 variable selection tools are inadequate/misleading.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The 
\begin_inset Quotes eld
\end_inset

Oracle
\begin_inset Quotes erd
\end_inset

 Model, in a Perfect World}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Suppose you have 100s of 
\begin_inset Formula $x$
\end_inset

 variables floating about.
 The general model would be too huge:
\begin_inset Formula 
\[
y_{i}=\beta_{o}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+\beta_{4}x4_{i}+\beta_{5}x5_{i}+\ldots+\beta_{100}x100_{i}+\ldots+e_{i}
\]

\end_inset


\end_layout

\begin_layout Itemize
Estimation would likely fail.
 Even if we could get estimates, they would have huge standard errors.
\end_layout

\begin_layout Itemize
Suppose the Oracle (a voice from God) tells you the 
\begin_inset Quotes eld
\end_inset

true slope
\begin_inset Quotes erd
\end_inset

 is zero for most coefficients.
\end_layout

\begin_layout Itemize
The Oracle says 
\begin_inset Quotes eld
\end_inset

set all of the irrelevant 
\begin_inset Formula $\beta_{j}'s$
\end_inset

 set to 
\begin_inset Formula $0$
\end_inset


\begin_inset Quotes erd
\end_inset

, so you fit
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
y_{i}=\beta_{o}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+e_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{If You Stop There, OK!}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
The statistical derivations we emphasize pre-suppose you stop at this point.
 Standard errors, p-values, etc, are derived with that assumption
\end_layout

\begin_layout Itemize
Danger arises from building a model 
\begin_inset Quotes eld
\end_inset

stepwise
\begin_inset Quotes erd
\end_inset

, especially 
\begin_inset Quotes eld
\end_inset

building-up
\begin_inset Quotes erd
\end_inset

 by adding variables one-at-a-time if they have 
\begin_inset Quotes eld
\end_inset

good
\begin_inset Quotes erd
\end_inset

 p-values.
 
\end_layout

\begin_layout Itemize
More commonly, we fit a model with a large number of coefficients, and then
 wrestle with the question of 
\begin_inset Quotes eld
\end_inset

which ones should we throw out?
\end_layout

\begin_layout Itemize
You risk misleading yourself and others.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Edward Leamer.
 1983.
 Lets Take the Con Out of Econometrics.
 
\emph on
American Economic Review
\emph default
, 31-43.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Big Picture: Selection and Regularization}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Variable 
\begin_inset Quotes eld
\end_inset

selection
\begin_inset Quotes erd
\end_inset

.
 Exclude variables, assuming their true coefficient is actually 0
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
stepwise methods add and remove variables in a sequence
\end_layout

\begin_layout Enumerate
\begin_inset Quotes eld
\end_inset

best subset
\begin_inset Quotes erd
\end_inset

 methods: systematic search over all possible regressions for the combination
 of predictors that reduces prediction error
\end_layout

\end_deeper
\begin_layout Enumerate
Parameter regularization.
 Try to estimate a giant vector 
\begin_inset Formula $\beta=(\beta_{0},\beta_{1},\ldots,\beta_{100})$
\end_inset

 but use some criteria to 
\begin_inset Quotes eld
\end_inset

stabilize
\begin_inset Quotes erd
\end_inset

 the vector, to 
\begin_inset Quotes eld
\end_inset

penalize
\begin_inset Quotes erd
\end_inset

 the estimates that are unstable and shrink them toward 0
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
ridge regression.
 
\end_layout

\begin_layout Enumerate
The 
\begin_inset Quotes eld
\end_inset

lasso
\begin_inset Quotes erd
\end_inset

 (described well in James et al, 
\emph on
An Introduction to Statistical Learning
\emph default
,(2013))
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Don't Use Stepwise Variable Selection}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Frank Harrell.
 2001.
 
\emph on
Regression Modeling Strategies.

\emph default
 Stepwise regression is bad because it biases parameter estimates and often
 chooses the 
\begin_inset Quotes eld
\end_inset

wrong
\begin_inset Quotes erd
\end_inset

 variables.
\end_layout

\begin_layout Itemize
Flom and Cassell.
 2007.
 
\begin_inset Quotes eld
\end_inset

Stopping Stepwise: Why stepwise and similar selection methods are bad, and
 what you should use.
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Itemize
Stata website: Problems with stepwise regression: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://www.stata.com/support/faqs/stat/stepwise.html
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Forward stepwise regression seems most dangerous to me.
 Many of us are 
\begin_inset Quotes eld
\end_inset

closet
\begin_inset Quotes erd
\end_inset

 practitioners of a subject 
\begin_inset Quotes eld
\end_inset

backwards stepwise
\begin_inset Quotes erd
\end_inset

 approach that throws out variables
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{I suggest a hierarchical approach}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Lets avoid all variants of automatic 
\begin_inset Quotes eld
\end_inset

stepwise regression.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
Don't try the 
\begin_inset Quotes eld
\end_inset

lasso
\begin_inset Quotes erd
\end_inset

 or other fancy tools unless you really understand them
\end_layout

\begin_layout Itemize
Lets 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
follow our substantive knowledge as far as it will guide us
\end_layout

\begin_layout Itemize
When uncertain, fit several models and compare side by side.
\end_layout

\end_deeper
\begin_layout Itemize
Basic idea: 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
If 
\begin_inset Formula $\hat{\beta}_{j}$
\end_inset

 is similar across various regressions, then we probably have a good estimate
\end_layout

\begin_layout Itemize
Otherwise, we have a problem that requires some hard thought.
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Including Extra Variables: What Danger?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
If extra 
\begin_inset Formula $X$
\end_inset

's are 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
uncorrelated with your predictors that do belong,
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
then you are doing no 
\begin_inset Quotes eld
\end_inset

damage
\begin_inset Quotes erd
\end_inset

 to your estimates.
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
But, if those extra variables are correlated with your predictors that do
 belong, then 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
you are diluting the estimates of the ones that do belong, and
\end_layout

\begin_layout Itemize
causing 
\begin_inset Quotes eld
\end_inset

inefficiency
\begin_inset Quotes erd
\end_inset

 (higher variance) and 
\end_layout

\begin_layout Itemize
the estimated standard errors are inflated
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Excluding Variables: What Danger?}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
If you remove variables that really do belong, and those variables are
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
uncorrelated with your predictors that are still included, then 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
your estimated slopes for the included variables are still unbiased
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
But, if they are correlated with your other predictors, then 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
your estimated slopes for the included variables are biased.
 (omitted variable bias)
\end_layout

\end_deeper
\begin_layout Itemize
Called the 
\begin_inset Quotes eld
\end_inset

omitted variable bias
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Non-Orthogonal Predictor Columns
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The Virtues Orthogonal data}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
2 columns are orthogonal if the deviations about the means are not related
 (Interpretation: Knowing a respondent's score on one variable implies nothing
 about the other one).
\end_layout

\begin_layout Itemize
The numerator of the covariance is zero:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\sum_{i=1}^{N}(x1_{i}-\overline{x1})\times(x2_{i}-\overline{x2}) & =(x1_{1}-\overline{x1})(x2_{1}-\overline{x2})\\
 & +(x1_{2}-\overline{x1})(x2_{2}-\overline{x2})+(\ldots N\,times)=0
\end{align*}

\end_inset


\end_layout

\begin_layout Itemize
Since 
\begin_inset Formula $r=\frac{Cov(x1,x2)}{\sqrt{Var(x1)\cdot Var(x2)}}$
\end_inset

, Pearson correlation is 0.
\end_layout

\begin_layout Itemize
Geometrically, 
\begin_inset Formula $x1$
\end_inset

 and 
\begin_inset Formula $x2$
\end_inset

 are 
\begin_inset Quotes eld
\end_inset

perpendicular
\begin_inset Quotes erd
\end_inset

, at right angles to one another
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Here is the important thing I want to convey}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
If the columns of 
\begin_inset Formula $X$
\end_inset

 are not correlated with each other, THEN regression is easy!
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\hat{\beta}$
\end_inset

 estimates are stable, not affected by inserting or removing other variables!
\end_layout

\end_deeper
\begin_layout Enumerate
If the columns of 
\begin_inset Formula $X$
\end_inset

 are correlated with each other, THEN regression is difficult!
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\hat{\beta}$
\end_inset

 fluctuate as variables go in and out.
\end_layout

\begin_layout Enumerate
it is difficult to know which variables 
\begin_inset Quotes eld
\end_inset

truly belong
\begin_inset Quotes erd
\end_inset

 in the model (
\begin_inset Quotes eld
\end_inset

specification
\begin_inset Quotes erd
\end_inset

 is difficult)
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{For Interpreting Regression Formulas}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Variance 
\begin_inset Formula $\Longleftrightarrow$
\end_inset

sums of squares 
\begin_inset Formula 
\begin{equation}
\sum(x_{i}-\bar{x})^{2}\mbox{\,\ is the same as\,\ensuremath{(N-1)\widehat{Var[x_{i}]}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
CoVariance 
\begin_inset Formula $\Longleftrightarrow$
\end_inset

sums of 
\begin_inset Quotes eld
\end_inset

cross products
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\sum(x1_{i}-\overline{x1})(x2_{i}-\overline{x2})\,\mbox{is the same as \ensuremath{(N-1)\widehat{Cov[x1,x2]}\,\,}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Covariance 
\begin_inset Formula $\Longleftrightarrow$
\end_inset

Correlation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\widehat{Cov[x1,x2]}=\mbox{\ensuremath{\widehat{Std.Dev.(x1)}\cdot\widehat{Std.Dev.}(x2)\cdot r_{x1,x2}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Cohen et al, for example, show 
\begin_inset Formula $\hat{\beta}_{j}$
\end_inset

 in terms of correlation coefficients.
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Cohen offers estimation formula for 2 predictors}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
For 2 predictors x1 and x2.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\beta}_{1}=\frac{\left(\sum(x1_{i}-\overline{x1})(y_{i}-\bar{y})\right)\left(\sum(x2_{i}-\overline{x2})^{2}\right)-\left(\sum(x2_{i}-\overline{x2})(y_{i}-\bar{y})\right)\left(\sum(x1_{i}-\overline{x1})(x2_{i}-\overline{x2}\right)}{\left(\sum(x1_{i}-\overline{x1})^{2}\right)\left(\sum(x2{}_{i}-\overline{x2})^{2}\right)-\left(\sum(x1_{i}-\overline{x1})(x2_{i}-\overline{x2})\right)^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
With 
\begin_inset Quotes eld
\end_inset

mean centered
\begin_inset Quotes erd
\end_inset

 data, formula simplifies: 
\begin_inset Formula $\overline{x}1=0$
\end_inset

, 
\begin_inset Formula $\overline{x2}=0$
\end_inset

, 
\begin_inset Formula $\overline{y}=0$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\beta}_{1}=\frac{\left(\sum x1_{i}y_{i}\right)\left(\sum x2_{i}{}^{2}\right)-\left(\sum x2_{i}y_{i}\right)\left(\sum x1_{i}x2_{i}\right)}{\left(\sum x1_{i}{}^{2}\right)\left(\sum x2{}_{i}{}^{2}\right)-\left(\sum x1_{i}x2_{i}\right)^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Can interpret beta coefficient as a ratio of Pearson correlations}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
With Centered data, we replace
\begin_inset Formula $\mbox{\ensuremath{\overline{x1}}}$
\end_inset

 and 
\begin_inset Formula $\overline{x2}$
\end_inset

 with 0
\end_layout

\begin_layout Itemize
With Standardized data:
\begin_inset Formula 
\begin{equation}
\mbox{\ensuremath{\widehat{Var[x1]}=\frac{\sum(x1_{i}-\overline{x1})^{2}}{N-1}}}\mbox{=\ensuremath{\widehat{Var[x2]}=\frac{\sum(x2_{i}-\overline{x2})^{2}}{N-1}=1}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Recalling 
\begin_inset Formula $\widehat{Cov[x1,y]}=\frac{\sum(x1_{i}-\overline{x1})(y_{i}-\overline{y})}{N-1}$
\end_inset

 and 
\begin_inset Formula $r_{y,x1}=\frac{\widehat{Cov[x1,y]}}{\sqrt{\widehat{Var[x1]}}\sqrt{\widehat{Var[y]}}}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\beta}_{1}=\frac{r_{y,x1}-r_{y,x2}r_{x1,x2}}{1-r_{x1,x2}^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Note, if 
\begin_inset Formula $r_{x1,x2}=0,$
\end_inset

 it all collapses to 
\begin_inset Formula $\hat{\beta}_{1}=r_{y,x1}$
\end_inset


\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Another way to describe it}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
With orthogonal data, the regression coefficient is the ratio of covariance
 to variance.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\beta}_{1}=\frac{\sum(x1_{i}-\overline{x1})(y_{i}-\bar{y})}{\sum(x1_{i}-\overline{x1})^{2}}=\frac{\widehat{Cov[y,x1]}}{\widehat{Var[x1]}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Some experimental designs can give us orthogonal data.
\end_layout

\begin_layout Itemize
We rarely find in 
\begin_inset Quotes eld
\end_inset

real life samples.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
You see now why political scientists who collect data in the field are jealous
 of psychologists who design experiments so that their predictors are orthogonal.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Hat matrix
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Foreshadowing: The Hat Matrix}
\end_layout

\end_inset


\end_layout

\begin_layout BeginFrame
Recall the OLS estimator
\end_layout

\begin_layout Itemize
\begin_inset Formula $\hat{\beta}=(X^{T}X)^{-1}X^{T\,}y$
\end_inset


\end_layout

\begin_layout Itemize
The part before the 
\begin_inset Formula $y$
\end_inset

 is a critical part of the 
\begin_inset Quotes eld
\end_inset

hat matrix
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $H=H(X^{T}X)^{-1}X^{T}$
\end_inset

 is a 
\begin_inset Formula $N\times N$
\end_inset

 weighting matrix
\end_layout

\begin_layout Itemize
called hat because 
\begin_inset Formula 
\begin{align}
\hat{y} & =X\hat{\beta}\nonumber \\
\mbox{\ensuremath{\hat{y}}=} & X(X^{T}X)^{-1}X^{T}\,\,y\nonumber \\
 & =Hy
\end{align}

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize

\series bold
The Hat Matrix
\series default
 turns observed 
\begin_inset Formula $y$
\end_inset

 into predictions 
\begin_inset Formula $\hat{y}$
\end_inset


\end_layout

\begin_layout Itemize
The Hat matrix is 
\begin_inset Formula $N\times N$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $(X^{T}X)$
\end_inset

 is a 
\begin_inset Formula $p\times p$
\end_inset

 square.
 The covariance of the 
\begin_inset Formula $X$
\end_inset

's.
\end_layout

\begin_layout Itemize
\begin_inset Formula $X^{T}$
\end_inset

 is 
\begin_inset Formula $p\times N$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $X(X^{T}X)^{-1}X^{T}$
\end_inset

 is a matrix: 
\begin_inset Formula $N\times N$
\end_inset

 (Because matrices of sizes: 
\begin_inset Formula $(N\times p)(p\times p)(p\times N)$
\end_inset

)
\end_layout

\end_deeper
\begin_layout Itemize
Most regression diagnostics and analysis of predictive power focus on the
 Hat matrix.
\end_layout

\begin_layout Itemize
See Simon Wood, 
\emph on
Generalized Additive Models: An Introduction with R
\emph default
.
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Multiple 
\begin_inset Formula $R^{2}$
\end_inset

 and adjusted 
\begin_inset Formula $R^{2}$
\end_inset


\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{We Need to Revise $R^2$}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
If you were enthusiastic about 
\begin_inset Formula $R^{2}$
\end_inset

 before, wait till you hear this awesome news:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout ExampleBlock
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset

Ever Expanding R-Square 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $R^{2}$
\end_inset

 always gets bigger when more variables are added.
 Never gets smaller.
\end_layout

\end_deeper
\begin_layout Itemize
The Sum of Squared errors can't get worse, so we are mislead into adding
 more and more variables into a regression model.
 
\end_layout

\begin_layout Itemize
Various 
\begin_inset Quotes eld
\end_inset

corrections
\begin_inset Quotes erd
\end_inset

 have been suggested, either 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
a revision of 
\begin_inset Formula $R^{2}$
\end_inset

 to include a penalty for more predictors, or
\end_layout

\begin_layout Itemize
alternative 
\begin_inset Quotes eld
\end_inset

information criteria
\begin_inset Quotes erd
\end_inset

 that help us to gauge the predictive fit of the model.
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Adjusted $R^2$}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Proposal.
 Replace 
\begin_inset Formula $R^{2}=1-\frac{ESS}{TSS}$
\end_inset

 with 
\begin_inset Formula 
\begin{equation}
adjusted\,R^{2}=1-\frac{ESS/(N-k-1)}{TSS/(N-1)}=\frac{MSE}{\widehat{Var[y]}}
\end{equation}

\end_inset


\begin_inset Formula 
\[
adjusted\,R^{2}=1-(1-R^{2})\frac{N-1}{N-k-1}
\]

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $adjusted\,R^{2}$
\end_inset

 can go down as more variables are added
\end_layout

\begin_layout Itemize
Sometimes called 
\begin_inset Quotes eld
\end_inset

corrected 
\begin_inset Formula $R^{2}$
\end_inset


\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

shrunken 
\begin_inset Formula $R^{2}$
\end_inset


\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Other Suggestions: Information Criteria}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Akaike's Information Criterion (AIC)
\end_layout

\begin_layout Itemize
Bayesian Information Criterion (BIC)
\end_layout

\begin_layout Itemize
Mallow's 
\begin_inset Formula $C_{p}$
\end_inset

 statistic
\end_layout

\begin_layout Standard
These are decisions that are similar to 
\begin_inset Formula $Adj\,R^{2}$
\end_inset

 in a linear model, but they are applicable to maximum likelihood models
 (as opposed to ordinary least squares)
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Which Variables are 
\begin_inset Quotes eld
\end_inset

Important
\begin_inset Quotes erd
\end_inset

?
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Struggle to Assess Separate Effect of Predictors}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
We fit a model, and we want to report to our sponsors 
\begin_inset Quotes eld
\end_inset

variable X1 is very influential
\begin_inset Quotes erd
\end_inset

, and 
\begin_inset Quotes eld
\end_inset

variable X2 doesn't have a very substantial effect.
\begin_inset Quotes erd
\end_inset

 
\end_layout

\begin_layout Itemize
We want to gauge the relative 
\begin_inset Quotes eld
\end_inset

predictive power
\begin_inset Quotes erd
\end_inset

 of the predictors.
\end_layout

\begin_layout Itemize
We want these things; I think they don't exist, aren't very meaningful
\end_layout

\begin_layout Itemize
But, nevertheless, I have to introduce
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

partial correlation
\begin_inset Quotes erd
\end_inset

 coefficients.
 
\end_layout

\begin_layout Itemize
semi-partial correlations
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The Famous Ballantine Graph of Cohen, et al
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Ballantine Graph=Venn Diagram}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Think of 
\begin_inset Quotes eld
\end_inset

variance accounted for
\begin_inset Quotes erd
\end_inset

 as areas in a Venn diagram (Cohen, et al, 3ed, p.
 72)
\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
5cm
\end_layout

\begin_layout Standard
Variance of 
\begin_inset Formula $y$
\end_inset

, Subdivided
\end_layout

\begin_layout Standard
\begin_inset External
	template XFig
	filename importfigs/ballantine-1.fig
	width 5cm

\end_inset


\end_layout

\begin_layout Standard
Var(y)=a+b+c+e
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Column
7cm
\end_layout

\begin_layout Itemize
e is error term's variance
\end_layout

\begin_layout Itemize
\begin_inset Formula $R^{2}$
\end_inset

 is represented by area (a + b + c)/(a+b+c+e)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
(separate plus shared parts =
\begin_inset Quotes eld
\end_inset

accounted for
\begin_inset Quotes erd
\end_inset

)
\end_layout

\end_deeper
\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Areas c and d are troublemakers}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
Variance of 
\begin_inset Formula $y$
\end_inset

, Subdivided
\end_layout

\begin_layout Standard
\begin_inset External
	template XFig
	filename importfigs/ballantine-1.fig
	width 4cm

\end_inset


\end_layout

\begin_layout Standard
Var(y)=a+b+c+e
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Column
8cm
\end_layout

\begin_layout Itemize
a and b are 
\begin_inset Quotes eld
\end_inset

uniquely
\begin_inset Quotes erd
\end_inset

 accounted for by predictors
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

c
\begin_inset Quotes erd
\end_inset

 is overlapped explanatory power–we can't tell which causes what
\end_layout

\begin_layout Itemize
c+d is 
\begin_inset Quotes eld
\end_inset

multicollinearity
\begin_inset Quotes erd
\end_inset

, overlap of 2 predictors
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{All is Well if there's no Overlap}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
Variance of 
\begin_inset Formula $y$
\end_inset

, Subdivided
\end_layout

\begin_layout Standard
\begin_inset External
	template XFig
	filename importfigs/ballantine-2.fig
	width 4cm

\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Column
8cm
\end_layout

\begin_layout Itemize
Here, x1 and x2 are 
\begin_inset Quotes eld
\end_inset

orthogonal
\begin_inset Quotes erd
\end_inset

, completely uncorrelated.
 
\end_layout

\begin_layout Itemize
Separate regressions 
\begin_inset Formula $y\sim x1$
\end_inset

 and 
\begin_inset Formula $y\sim x2$
\end_inset

 would yield the same slope estimates as 
\begin_inset Formula $y\sim x1+x2$
\end_inset


\end_layout

\begin_layout Itemize
Clearly, the separate effect of 
\begin_inset Formula $x1$
\end_inset

 is 
\begin_inset Quotes eld
\end_inset

a
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
However, that is not true if x1 and x2 overlap (Multicollinearity)
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Big Overlap=Bad Problem}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
Variance of 
\begin_inset Formula $y$
\end_inset

, Subdivided
\end_layout

\begin_layout Standard
\begin_inset External
	template XFig
	filename importfigs/ballantine-3.fig
	width 4cm

\end_inset


\end_layout

\begin_layout Column
8cm
\end_layout

\begin_layout Itemize
When 2 predictors 
\begin_inset Quotes eld
\end_inset

coincide
\begin_inset Quotes erd
\end_inset

, it means we can't distinguish them.
\end_layout

\begin_layout Itemize
We can't say meaningfully that x1 has an effect that is separate from x2
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Partial Correlation
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Partial Correlation}
\end_layout

\end_inset


\end_layout

\begin_layout Description
partial
\begin_inset space ~
\end_inset

correlation
\begin_inset space ~
\end_inset

coefficient: 
\begin_inset Formula $r_{yx1\cdot x2}$
\end_inset

 Correlation between 
\begin_inset Formula $y$
\end_inset

 and 
\begin_inset Formula $x1$
\end_inset

, after 
\begin_inset Quotes eld
\end_inset

accounting for
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

partialing out
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $x2$
\end_inset


\end_layout

\begin_layout Standard
Can be described as a sequence of regressions:
\end_layout

\begin_layout Itemize
Fit: 
\begin_inset Formula $\hat{y}_{i}=\hat{c}_{0}+\hat{c}_{1}x2_{i}$
\end_inset

 
\begin_inset Formula $and$
\end_inset

 
\begin_inset space ~
\end_inset


\begin_inset Formula $\widehat{x1}_{i}=\hat{d}_{o}+\hat{d}_{1}x2_{i}$
\end_inset


\end_layout

\begin_layout Itemize
Create 
\begin_inset Quotes eld
\end_inset

residuals
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $y_{i}*=y_{i}-\hat{y}_{i}$
\end_inset

 and 
\begin_inset Formula $x1_{i}^{*}=x1-\widehat{x1_{i}}$
\end_inset


\end_layout

\begin_layout Itemize
We have 
\begin_inset Quotes eld
\end_inset

partialed out
\begin_inset Quotes erd
\end_inset

 the effect of 
\begin_inset Formula $x2$
\end_inset

, so
\end_layout

\begin_layout Itemize
Correlation b/t 
\begin_inset Formula $y*$
\end_inset

 and 
\begin_inset Formula $x1*$
\end_inset

 equals the 
\begin_inset Quotes eld
\end_inset

partial correlation between 
\begin_inset Formula $x1$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Partial Correlation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Lots of ways to write and re-organize this, Cohen, et al (p.
 74):
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
pr_{1}=r_{yx1\cdot x2}=\frac{r_{y,x1}-r_{y,x2}r_{x1,x2}}{\sqrt{1-r_{x1,x2}^{2}}\sqrt{1-r_{y,x2}^{2}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Valid only if there are 2 predictors 
\begin_inset Formula $x1$
\end_inset

 and 
\begin_inset Formula $x2$
\end_inset

.
\end_layout

\begin_layout Itemize
Look what happens if 
\begin_inset Formula $r_{x1,x2}=0$
\end_inset

 (orthogonal variables!)
\end_layout

\begin_layout Itemize
I think this is 
\begin_inset Quotes eld
\end_inset

harsh
\begin_inset Quotes erd
\end_inset

 toward 
\begin_inset Formula $x1$
\end_inset

.
 
\begin_inset Formula $x2$
\end_inset

 is given 
\begin_inset Quotes eld
\end_inset

all the influence it can account for
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Formula $x1$
\end_inset

 gets only 
\begin_inset Quotes eld
\end_inset

what it can account for after 
\begin_inset Formula $x2$
\end_inset

 takes everything it can grab.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $x1$
\end_inset

 and 
\begin_inset Formula $x2$
\end_inset

 overlap substantially, meaning both have small partial correlations 
\begin_inset Formula $y$
\end_inset

.
 
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Partial in the Ballantine Graph}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
4cm
\end_layout

\begin_layout Standard
\begin_inset External
	template XFig
	filename importfigs/ballantine-1.fig
	width 4cm

\end_inset


\end_layout

\begin_layout Standard
Var(y)=a+b+c+e
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Column
8cm
\end_layout

\begin_layout Itemize
Pearson correlations referred to as 
\begin_inset Quotes eld
\end_inset

zero order
\begin_inset Quotes erd
\end_inset

 correlations
\end_layout

\begin_layout Itemize
\begin_inset Formula $r_{yx1}$
\end_inset

 is correlation between 
\begin_inset Formula $y$
\end_inset

 and 
\begin_inset Formula $x1,$
\end_inset

 ignoring other variables
\end_layout

\begin_layout Itemize
Partial for X1 = 
\begin_inset Formula $pr_{1}^{2}$
\end_inset

 = 
\begin_inset Formula $r_{yx1.x2}^{2}=(R^{2}–r_{yx2}^{2})/(1-r_{yx2}^{2})$
\end_inset

 
\end_layout

\begin_layout Itemize

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
In the diagram 
\begin_inset Formula $r_{yx1.x2}^{2}$
\end_inset

=a/(a+e)
\end_layout

\begin_layout Itemize
Partial for 
\begin_inset Formula $x2$
\end_inset

 is same, just replace 
\begin_inset Formula $x2$
\end_inset

 with 
\begin_inset Formula $x1$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $r_{yx2.x1}^{2}$
\end_inset

= b / (b + e)
\end_layout

\end_deeper
\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\begin_layout Plain Layout


\backslash
begin{frame}
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{I'd Never Calculated These Before 2010}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
They were not emphasized in Econometrics or political science when I was
 a student
\end_layout

\begin_layout Itemize
More popular with behavioral researchers.
 
\end_layout

\begin_layout Itemize
I found various R packages, students ran into trouble with them.
 In 2013, the rockchalk package introduced a function 
\begin_inset Quotes eld
\end_inset

getPartialCor
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Get Public Spending Regression}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public10, include=F, echo=F, results=tex>>=
\end_layout

\begin_layout Plain Layout

library(rockchalk)
\end_layout

\begin_layout Plain Layout

dat <- read.table("/home/pauljohn/SVN/SVN-guides/stat/DataSets/PublicSpending/pub
licspending.txt", header=T)
\end_layout

\begin_layout Plain Layout

mod1 <- lm(EX ~ ECAB + MET + GROW + OLD + YOUNG + WEST, data = dat)
\end_layout

\begin_layout Plain Layout

outreg(mod1, tight=F)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-public10}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Partial Regression Matrix from rockchalk::getPartialCor}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch notrun
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public20, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

mod1pcor <- getPartialCor(mod1, dvonly = FALSE)
\end_layout

\begin_layout Plain Layout

round(mod1pcor, 4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots2/t-public20}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{And We really want $pr^2$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public30, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

round(mod1pcor^2, 4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots2/t-public30}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Compare effect of Young and West.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Conduct "regression on residuals" to verify}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch notrun
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public40, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

m1 <- lm(EX ~ MET + GROW + YOUNG + OLD + WEST, data=dat)
\end_layout

\begin_layout Plain Layout

EXStar <- resid(m1)
\end_layout

\begin_layout Plain Layout

m2 <- lm(ECAB ~ MET + GROW + YOUNG + OLD + WEST, data=dat)
\end_layout

\begin_layout Plain Layout

ECABStar <- resid(m2)
\end_layout

\begin_layout Plain Layout

m3 <- lm(EXStar ~ ECABStar)
\end_layout

\begin_layout Plain Layout

hopePcor <- summary(m3)
\end_layout

\begin_layout Plain Layout

hopePcor$r.squared
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-public40}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Oh, Sweet mystery of life at last I've found you! My regression result partial
 correlation matrix
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{It seems like we made progress, but we really didn't}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Seems like we have a way to summarize each variable's separate 
\begin_inset Quotes eld
\end_inset

explanatory power
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Itemize
But estimates not robust against changes in columns of the dataset
\end_layout

\begin_layout Itemize
Compare 
\begin_inset Formula $pr^{2}$
\end_inset

 with fewer variables
\end_layout

\begin_layout Standard
\begin_inset Branch notrun
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public60, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

mod2 <- lm(EX ~ YOUNG + WEST, data = dat)
\end_layout

\begin_layout Plain Layout

mod2pcor <- getPartialCor(mod2, dvonly = FALSE)
\end_layout

\begin_layout Plain Layout

round(mod2pcor^2, 4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots2/t-public60}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Compare effect of Young and West.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{My conclusion about partial correlation estimates}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
I avoid partial correlations.
 Because:
\end_layout

\begin_layout Itemize
The conclusions depend VITALLY on which columns from X are included in the
 calculations
\end_layout

\begin_layout Itemize
If I knew the 
\begin_inset Quotes eld
\end_inset

Oracle model,
\begin_inset Quotes erd
\end_inset

 these might be useful.
\end_layout

\begin_layout Itemize
These don't help in choosing variables for a regression (because they are
 calculated on the initial assumption of which variables need to be included
 in the calculation of 
\begin_inset Formula $pr^{2}$
\end_inset

)
\end_layout

\begin_layout Itemize
So I'll file this in the category of 
\begin_inset Quotes eld
\end_inset

something some people know, but I don't use
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Semi-partial Correlation Coefficients
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Semi-partial Correlation Coefficients}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
I never heard term 
\begin_inset Quotes eld
\end_inset

semi-partial correlation
\begin_inset Quotes erd
\end_inset

 before reading Cohen, et al, but have heard other names like delta-
\begin_inset Formula $R^{2}$
\end_inset

.
\end_layout

\begin_layout Itemize
Simplest explanation I've found
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Fit the whole model, with all the predictors, get 
\begin_inset Formula $R^{2}$
\end_inset


\end_layout

\begin_layout Itemize
Remove one predictor, re-estimate, calculate 
\begin_inset Formula $\Delta R_{j}^{2}$
\end_inset

 (change in 
\begin_inset Formula $R^{2}$
\end_inset

 from dropping 
\begin_inset Formula $j'th$
\end_inset

 variable).
\end_layout

\begin_layout Itemize
The 
\begin_inset Formula $sr_{xj}^{2}$
\end_inset

 is the change in the 
\begin_inset Formula $R^{2}$
\end_inset

 that results when 
\begin_inset Formula $x_{j}$
\end_inset

 is removed from the full model.
\end_layout

\end_deeper
\begin_layout Itemize
My 
\begin_inset Quotes eld
\end_inset

gut
\begin_inset Quotes erd
\end_inset

 reaction: still seems 
\begin_inset Quotes eld
\end_inset

harsh
\begin_inset Quotes erd
\end_inset

.
 
\begin_inset Formula $x1$
\end_inset

 gets credit only for 
\begin_inset Quotes eld
\end_inset

what it can account for by itself
\begin_inset Quotes erd
\end_inset

, the part c is 
\begin_inset Quotes eld
\end_inset

lost
\begin_inset Quotes erd
\end_inset

 as neither 
\begin_inset Formula $x1$
\end_inset

 nor 
\begin_inset Formula $x2$
\end_inset

 is given 
\begin_inset Quotes eld
\end_inset

credit
\begin_inset Quotes erd
\end_inset

 for it.
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Semi-Partial in the Ballantine Graph}
\end_layout

\end_inset


\end_layout

\begin_layout ColumnsTopAligned
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Column
5cm
\end_layout

\begin_layout Standard
\begin_inset External
	template XFig
	filename importfigs/ballantine-1.fig
	width 5cm

\end_inset


\end_layout

\begin_layout Standard
Var(y)=a+b+c+effect
\end_layout

\begin_layout Column
8cm
\end_layout

\begin_layout Itemize
Pearson correlations referred to as 
\begin_inset Quotes eld
\end_inset

zero order
\begin_inset Quotes erd
\end_inset

 correlations
\end_layout

\begin_layout Itemize
zero order correlation 
\begin_inset Formula $r_{yx1}$
\end_inset

 is correlation between 
\begin_inset Formula $y$
\end_inset

 and 
\begin_inset Formula $x1,$
\end_inset

 ignoring other variables
\end_layout

\begin_layout Itemize
Notice the semipartial can be seen as
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $sr_{1}^{2}=R^{2}–r_{yx2}^{2}=a/(a+b+c+e)$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $sr_{2}^{2}$
\end_inset

 = 
\begin_inset Formula $R^{2}–r_{yx1}^{2}=b/(a+b+c+e)$
\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Recently added to rockchalk: getDeltaRsquare for Semi-partial
 $R^2$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch notrun
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public105b, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

EXfull <- lm(EX ~ ECAB + MET + GROW + YOUNG + OLD + WEST, data=dat)
\end_layout

\begin_layout Plain Layout

getDeltaRsquare(EXfull)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots2/t-public105b}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Calculate $
\backslash
Delta R^2$ Explicitly To verify}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $sr_{ECAB}^{2}$
\end_inset

.
 Check the change in R-square that results when ECAB is removed
\end_layout

\begin_layout Standard
\begin_inset Branch notrun
inverted 0
status open

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public110, include=F, echo=T>>=
\end_layout

\begin_layout Plain Layout

EXfull <- lm(EX ~ ECAB + MET + GROW + YOUNG + OLD + WEST, data=dat)
\end_layout

\begin_layout Plain Layout

EXnoECAB <- lm(EX ~ MET + GROW + YOUNG + OLD + WEST, data=dat)
\end_layout

\begin_layout Plain Layout

(deltaRecab <- summary(EXfull)$r.square - summary(EXnoECAB)$r.square)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots2/t-public110}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Semi-Partial $r^2$  is Unstable (Dependent on inclusion of columns
 in data frame)}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
semi-partial 
\begin_inset Formula $r^{2}$
\end_inset

 jumps around depending on what other variables are in the model.
\end_layout

\begin_layout Itemize
Since we don't know for sure which ones belong, hard to hold much faith
 in it (that's where I stand now, despite recent changes).
\end_layout

\begin_layout Itemize
Others are seeking ways to improve results.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
relaimpo package
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{A 
\begin_inset Quotes eld
\end_inset

New-ish
\begin_inset Quotes erd
\end_inset

 Proposal}
\end_layout

\end_inset


\end_layout

\begin_layout Quote
Grömping, U.
 (2006).
 Relative Importance for Linear Regression in R: The Package relaimpo.
 
\emph on
Journal of Statistical Software
\emph default
, 17(1), 1–27.
 
\end_layout

\begin_layout Quote
Grömping, U.
 (2007).
 Estimators of Relative Importance in Linear Regression Based on Variance
 Decomposition.
 
\emph on
The American Statistician
\emph default
, 61, 139-147.
 doi:10.1198/000313007X188252
\end_layout

\begin_layout Quote
Discusses a number of criteria to decide how important each variable might
 be, how much variance it accounts for.
\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Grömping Proposes}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Consider possible range of 
\begin_inset Quotes eld
\end_inset

variance accounted for
\begin_inset Quotes erd
\end_inset

 estimates, semi-partial correlations (
\begin_inset Formula $R^{2}$
\end_inset

 changes) when a variable is put into a model.
\end_layout

\begin_layout Itemize
\begin_inset Formula $sr^{2}$
\end_inset

 biggest when the variable is by itself in the model
\end_layout

\begin_layout Itemize
\begin_inset Formula $sr^{2}$
\end_inset

 smallest when competing with other predictors in the model
\end_layout

\begin_layout Itemize
\begin_inset Quotes eld
\end_inset

lmg
\begin_inset Quotes erd
\end_inset

 procedure enters regression variables in all possible orders, and then
 averages the changes in the 
\begin_inset Formula $R^{2}$
\end_inset

.
\end_layout

\begin_layout Itemize
Implemented in the 
\begin_inset Quotes eld
\end_inset

relaimpo
\begin_inset Quotes erd
\end_inset

 package (see also package hier.part)
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout BeginFrame
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Load relaimp}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public150, include=F, fig=T, echo=T>>=
\end_layout

\begin_layout Plain Layout

library(relaimpo)
\end_layout

\begin_layout Plain Layout

EXFull <- lm(EX ~ ECAB+ MET + GROW + YOUNG + OLD + WEST, data=dat) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots2/t-public150}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Test out relaimp}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<public151, include=F, fig=T, echo=T>>=
\end_layout

\begin_layout Plain Layout

(EXFull.relimp <- calc.relimp(EXFull, type=c("lmg"))) 
\end_layout

\begin_layout Plain Layout

plot(EXFull.relimp)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize}
\end_layout

\begin_layout Plain Layout


\backslash
input{plots2/t-public151}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{lmg model averages together the $sr^2$}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=10cm]{plots2/t-public151.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
R Interactions (W&R notation).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{R Uses W
\backslash
&R Notation}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Wilkinson & Rogers introduced a system of notation, which R uses
\end_layout

\begin_layout Itemize
A simple additive model: 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{Sinput}
\end_layout

\begin_layout Plain Layout

mod <- lm(y ~ x1 + x2 + x3)
\end_layout

\begin_layout Plain Layout


\backslash
end{Sinput}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
asks R to estimate the theoretical model 
\begin_inset Formula $y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+e_{i}$
\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
Note you get an intercept 
\begin_inset Quotes eld
\end_inset

for free
\begin_inset Quotes erd
\end_inset

 (to suppress that, insert -1 or 0 as a predictor)
\end_layout

\begin_layout Itemize
W&R notation uses 
\begin_inset Formula $":"$
\end_inset

, 
\begin_inset Formula $"*"$
\end_inset

 and 
\begin_inset Formula $"/"$
\end_inset

 in special ways.
 .
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{In W
\backslash
&R notation, "*" Means Multiplicative Interaction}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Suppose x1 and x2 are numeric predictors.
 This notation
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{Sinput}
\end_layout

\begin_layout Plain Layout

mod <- lm(y ~ x1*x2, data = dat)
\end_layout

\begin_layout Plain Layout


\backslash
end{Sinput}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Is the same as
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{Sinput}
\end_layout

\begin_layout Plain Layout

mod <- lm(y ~ x1 + x2 + x1:x2, data = dat)
\end_layout

\begin_layout Plain Layout


\backslash
end{Sinput}
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
R always inserts the 
\begin_inset Quotes eld
\end_inset

main effects
\begin_inset Quotes erd
\end_inset

 that sit underneath an interaction.
 You ask for x1*x2, get estimates for x1, x2, and x1:x2.
\end_layout

\end_deeper
\begin_layout Itemize
In R output, the product term 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $x1_{i}\times x2_{i}"$
\end_inset

 will appear as 
\begin_inset Formula $"x1:x2"$
\end_inset


\end_layout

\begin_layout Itemize
Interactions can fit together with other predictors as well, of course:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{Sinput}
\end_layout

\begin_layout Plain Layout

mod <- lm(y ~ x1 + x2*x3)
\end_layout

\begin_layout Plain Layout


\backslash
end{Sinput}
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
Asks R to estimate 
\begin_inset Formula $y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+\beta_{4}x2_{i}\times x3_{i}+e_{i}$
\end_inset


\end_layout

\begin_layout Standard
It is considered gauche to write the request explicitly:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{Sinput}
\end_layout

\begin_layout Plain Layout

mod <- lm(y ~ x1 + x2 + x3 + x2:x3)
\end_layout

\begin_layout Plain Layout


\backslash
end{Sinput}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the design matrix, 
\begin_inset Formula $x2:x3$
\end_inset

 is a new constructed column, the product of 
\begin_inset Formula $x2$
\end_inset

 and 
\begin_inset Formula $x3$
\end_inset

.
\end_layout

\begin_layout Itemize
Combine several:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{Sinput}
\end_layout

\begin_layout Plain Layout

mod <- lm(y ~ x1*x2*x3)
\end_layout

\begin_layout Plain Layout


\backslash
end{Sinput}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Asks R to fit: 
\begin_inset Formula $y_{i}=\beta_{0}+\beta_{1}x1_{i}+\beta_{2}x2_{i}+\beta_{3}x3_{i}+\beta_{4}x1_{i}\times x2_{i}+\beta_{5}x1_{i}\times x3_{i}+\beta_{6}x2_{i}\times x3_{i}+\beta_{7}x1_{i}\times x2_{i}\times x3_{i}+e_{i}$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Interact a numeric with a categorical predictor}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<rdesmatrix,include=F,echo=T>>=
\end_layout

\begin_layout Plain Layout

set.seed(123123)
\end_layout

\begin_layout Plain Layout

xnum1 <- rnorm(100)
\end_layout

\begin_layout Plain Layout

xcat2 <- factor(sample(c("Female", "Male"), 100, replace = TRUE))
\end_layout

\begin_layout Plain Layout

z <- factor(sample(c("A","B","C","D"), 100, replace = TRUE))
\end_layout

\begin_layout Plain Layout

y <- rnorm(100)
\end_layout

\begin_layout Plain Layout

mod1 <- lm(y ~ xnum1 + xcat2 + z)
\end_layout

\begin_layout Plain Layout

dat <- model.frame(mod1)
\end_layout

\begin_layout Plain Layout

mod1mm <- model.matrix(mod1)
\end_layout

\begin_layout Plain Layout

dat$y <- mod1mm %*% c(0.1, 0.45, -0.1, 0.2, 0.35, -0.45) + 0.8 *rnorm(100)
\end_layout

\begin_layout Plain Layout

mod1 <- lm(y ~ xnum1 + xcat2 + z, data = dat)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR55, include=F>>=
\end_layout

\begin_layout Plain Layout

mod2 <- lm(y ~ xnum1 * z, data = dat)
\end_layout

\begin_layout Plain Layout

mod2sum <- summary(mod2)
\end_layout

\begin_layout Plain Layout

coef(mod2sum)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-WR55}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
That estimated all of the parallel lines, plus 4 additional terms.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Now let's see what happens with "*"}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
y_{i} & = & \beta_{0}+\beta_{1}x_{i}+\beta_{2}zB_{i}+\beta_{3}zC_{i}+\beta_{4}zD_{i}\nonumber \\
 &  & +\beta_{5}(x\cdot zA_{i})+\beta_{6}(x\cdot zB_{i})+\beta_{7}(x\cdot zC_{i})+\beta_{5}(x\cdot zD_{i})+e_{i}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
Think of 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

 as the 
\begin_inset Quotes eld
\end_inset

baseline
\begin_inset Quotes erd
\end_inset

 estimates, for everybody.
 
\end_layout

\begin_layout Itemize
Then we have to look specifically at groups 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, 
\begin_inset Formula $C$
\end_inset

 and 
\begin_inset Formula $D$
\end_inset

 to figure out what their predicted values need to be.
 
\end_layout

\begin_layout Itemize
Group 
\begin_inset Formula $A,$
\end_inset

 which implies 
\begin_inset Formula $zB_{i}$
\end_inset

= 
\begin_inset Formula $zC_{i}$
\end_inset

= 
\begin_inset Formula $zD_{i}=0$
\end_inset

, so 
\begin_inset Formula 
\begin{eqnarray}
Group\,A:\hat{y}_{i} & = & \hat{\beta}_{0}+\hat{\beta}_{1}x_{i}+\hat{\beta}_{5}x_{i}\nonumber \\
 & = & \hat{\beta}_{0}+(\hat{\beta}_{1}+\hat{\beta}_{5})x_{i}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
Group 
\begin_inset Formula $B$
\end_inset

, which implies 
\begin_inset Formula $zB_{i}=1$
\end_inset

 and 
\begin_inset Formula $zC_{i}=zD_{i}=0$
\end_inset

.
 Predicted values would be:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
Group\,B:\,\hat{y}_{i} & = & \hat{\beta}_{0}+\hat{\beta}_{1}x_{i}+\hat{\beta}_{2}zB_{i}+\hat{\beta}_{6}(x\cdot zB_{i})\nonumber \\
 & = & (\hat{\beta}_{0}+\hat{\beta}_{2})+(\hat{\beta}_{1}+\hat{\beta}_{6})x_{i}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\beta_{2}$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

intercept shift
\begin_inset Quotes erd
\end_inset

 due to membership in group 
\begin_inset Formula $B$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\beta_{6}$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

slope shift
\begin_inset Quotes erd
\end_inset

 due to membership in group 
\begin_inset Formula $B$
\end_inset


\end_layout

\begin_layout Itemize
Lets check, and then plot, the predicted values for the 4 levels of 
\begin_inset Formula $z$
\end_inset

.
 Here's the predictOMatic() output.
 We don't really need this now, but we will later.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR56, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

mod4pmo <- predictOMatic(mod2, predVals = list(z = levels(dat$z), xnum1
 = range(dat$xnum1)))
\end_layout

\begin_layout Plain Layout

mod4pmo
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-WR56}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{rockchalk::plotSlopes output}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR60, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

plotSlopes(mod2, plotx = "xnum1", modx = "z")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{plots2/t-WR60.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-WR60}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset Note Note
status open

\begin_layout Section
R formula using 
\begin_inset Quotes eld
\end_inset

/
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{The "/" Surprise: separate slopes for all groups}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR200>>=
\end_layout

\begin_layout Plain Layout

mod4 <- lm(y ~ z/xnum1, data = dat)
\end_layout

\begin_layout Plain Layout

mod4sum <- summary(mod4)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
That has a weird effect.
 It does not estimate 
\begin_inset Formula $x1num$
\end_inset

 for a baseline group.
 It fits that estimate for 4 separate groups.
 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize} 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR210>>=
\end_layout

\begin_layout Plain Layout

coef(mod4sum)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
That is similar to the output from 
\begin_inset Formula $y\sim x*z$
\end_inset

.
 In fact, the predicted values of 
\begin_inset Formula $y_{i}$
\end_inset

 are identical, but the coefficients are organized differently: 
\begin_inset Formula 
\begin{eqnarray}
y_{i} & = & \beta_{i}+\beta_{1}zB+\beta_{2}zC_{i}+\beta_{3}zD_{i}\\
 &  & +\beta_{5}(x_{i}\times zA_{i})+\beta_{6}(x_{i}\times zB_{i})+\beta_{7}(x_{i}\times zC_{i})+\beta_{8}(x_{i}\times zD_{i})+e_{i}\nonumber 
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Itemize
It turns out that fit leads to the same predicted values as the 
\begin_inset Quotes eld
\end_inset

*
\begin_inset Quotes erd
\end_inset

 model
\end_layout

\begin_layout Plain Layout
As of 2013-03-11, plotSlopes can't handle that model, but I may have an
 even more informative suggestion.
 rockchalk has a new function predictOMatic():
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR220, fig=T, include=F>>=
\end_layout

\begin_layout Plain Layout

mod4pmo <- predictOMatic(mod4, predVals = list(z = levels(dat$z), xnum1
 = range(dat$xnum1)))
\end_layout

\begin_layout Plain Layout

mod4pmo
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-WR220}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
I worked pretty hard on that code (whew).
 Now make a plot.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR230, fig=T, include=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

plot(y ~ xnum1, data = dat, xlim = magRange(dat$xnum1, mult = c(1.2, 1)))
\end_layout

\begin_layout Plain Layout

by(mod4pmo, mod4pmo$z, function(gdat) { 
\end_layout

\begin_layout Plain Layout

	zn <- as.numeric(gdat$z); lines(gdat$xnum1, gdat$fit, lty=zn, col=zn, lwd
 = 2)
\end_layout

\begin_layout Plain Layout

})
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = levels(mod4pmo$z), lty = 1:4, col = 1:4, lwd
 = 2, bg = "white")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-WR230}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{plots2/t-WR230.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim, allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Suppress the intercept, it becomes more obvious what's going
 on}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR400>>=
\end_layout

\begin_layout Plain Layout

mod4a <- lm(y ~ -1 + z/xnum1, data = dat)
\end_layout

\begin_layout Plain Layout

mod4asum <- summary(mod4a)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
And the estimated coefficients are
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
def
\backslash
Sweavesize{
\backslash
scriptsize} 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR410>>=
\end_layout

\begin_layout Plain Layout

coef(mod4asum)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
That's estimating this model
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{eqnarray*}
y_{i} & = & \beta_{1}zA+\beta_{2}zB_{i}+\beta_{3}zC_{i}+\beta_{4}zD_{i}\\
 &  & +\beta_{5}(x_{i}\times zA_{i})+\beta_{6}(x_{i}\times zB_{i})+\beta_{7}(x_{i}\times zC_{i})+\beta_{8}(x_{i}\times zD_{i})+e_{i}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Plain Layout
Which we can understand as 4 separate lines:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{eqnarray*}
y_{i} & = & \beta_{1}zA+\beta_{5}(x_{i}\times zA_{i})\\
 &  & +\beta_{2}zB_{i}+\beta_{6}(x_{i}\times zB_{i})\\
 &  & +\beta_{3}zC_{i}+\beta_{7}(x_{i}\times zC_{i})\\
 &  & +\beta_{4}zD_{i}+\beta_{8}(x_{i}\times zD_{i})+e_{i}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Plain Layout
If you compare the predictOMatic output with the other ones, you see the
 predicted values for the groups are exactly the same.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR420, include=T>>=
\end_layout

\begin_layout Plain Layout

mod4apmo <- predictOMatic(mod4a, predVals = list(z = levels(dat$z), xnum1
 = range(dat$xnum1)))
\end_layout

\begin_layout Plain Layout

mod4apmo
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<WR430, fig=T, include=F, results=hide>>=
\end_layout

\begin_layout Plain Layout

plot(y ~ xnum1, data = dat, xlim = magRange(dat$xnum1, mult = c(1.2, 1)))
\end_layout

\begin_layout Plain Layout

by(mod4apmo, mod4apmo$z, function(gdat) { 
\end_layout

\begin_layout Plain Layout

zn <- as.numeric(gdat$z)
\end_layout

\begin_layout Plain Layout

lines(gdat$x, gdat$fit, lty=zn, lwd = 2, col=zn)
\end_layout

\begin_layout Plain Layout

})
\end_layout

\begin_layout Plain Layout

legend("topleft", legend = levels(mod4apmo$z), lty = 1:4, col = 1:4, bg
 = "white")
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
input{plots2/t-WR430}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
includegraphics[width=8cm]{plots2/t-WR430.pdf}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Practice Problems
\end_layout

\begin_layout EndFrame

\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
small
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{frame}[containsverbatim,allowframebreaks]
\end_layout

\begin_layout Plain Layout


\backslash
frametitle{Problems}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate

\size small
\begin_inset CommandInset label
LatexCommand label
name "Prob 1"

\end_inset

If you want to see an example of really bad 
\begin_inset Quotes eld
\end_inset

overlapping
\begin_inset Quotes erd
\end_inset

 variables, download the cystic fibrosis data set from the DataSets folder.
 Try to predict the DV 
\begin_inset Quotes eld
\end_inset

pemax
\begin_inset Quotes erd
\end_inset

 as a function of these variables age + sex + height + weight.
 
\size default
Wow.
 That's discouraging.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Make a regression table to summarize the results and try to write a paragraph
 about the effect of height in contrast with that of weight.
\end_layout

\begin_layout Enumerate
Write out the formula for the theory you are fitting, and the equation for
 the predicted values.
\end_layout

\begin_layout Enumerate
Conduct a 
\begin_inset Quotes eld
\end_inset

fancy
\begin_inset Quotes erd
\end_inset

 t test to find out if the effect of height is different from that of weight.
 Computing hint.
 If the fitted model is 
\begin_inset Quotes eld
\end_inset

mod1
\begin_inset Quotes erd
\end_inset

, run 
\begin_inset Quotes eld
\end_inset

vcov(mod1)
\begin_inset Quotes erd
\end_inset

 to review the var/covar matrix, then pick the ones you need for the denominator.
 You can do this calculation with a calculator, but you can make R do it
 if you learn how to grab rows and columns from a matrix.
 I can help you with that if you like.
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "Prob2"

\end_inset

Continue with cystfibr.
 Run a regression with each independent variable separately entered.
 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Compare the findings of these one-at-a-time models, try to make sense out
 of the 
\begin_inset Quotes eld
\end_inset

statistical significance
\begin_inset Quotes erd
\end_inset

 of the coefficients.
\end_layout

\begin_layout Standard
You have to stare at this one a while, it really puzzled me at first.
 It helped me to run termplot so I could see the problem graphically.
\end_layout

\end_deeper
\begin_layout Enumerate
Test out R's 
\begin_inset Quotes eld
\end_inset

anova
\begin_inset Quotes erd
\end_inset

 function to to a test of the null hypothesis that several coefficients
 are actually 0.
 Any data set with several predictors will do.
 Suppose the 
\begin_inset Quotes eld
\end_inset

unrestricted
\begin_inset Quotes erd
\end_inset

 model is 
\begin_inset Formula $m1$
\end_inset

, and the restricted model is 
\begin_inset Formula $m2$
\end_inset


\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

m1 <- lm(y ~ x1 + x2 + x3 + x4 + x5 + x6, data=dat)
\end_layout

\begin_layout Plain Layout

m2 <- lm(y ~ x1 + x5 + x6, data=dat)
\end_layout

\begin_layout Plain Layout

anova(m2, m1, test="F")
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Your idea here is that variables x3 and x4 do not belong, so you need to
 test the null that 
\begin_inset Formula $\beta_{3}=\beta_{4}=0$
\end_inset

.
 Can you interpret the results? 
\end_layout

\end_deeper
\begin_layout Enumerate
Practice making professional looking regression tables.
 Make a table that summarizes the 
\begin_inset Quotes eld
\end_inset

full
\begin_inset Quotes erd
\end_inset

 model from problem 
\begin_inset CommandInset ref
LatexCommand ref
reference "Prob 1"

\end_inset

 and also includes columns for one or two of the 
\begin_inset Quotes eld
\end_inset

partial
\begin_inset Quotes erd
\end_inset

 models in problem 
\begin_inset CommandInset ref
LatexCommand ref
reference "Prob2"

\end_inset

.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
To do that work, I've used some R functions that generate \SpecialChar LaTeX
 tables.
 The outreg function in new-ish rockchalk can create html files, which Word
 can import.
 If you like word.
\size small

\begin_inset Newpage newpage
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate

\size small
While you have that cystfibr data open, here are a few fun things to do.
 
\size default

\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate

\size small
Create a correlation matrix showing the bivariate (one-on-one) correlations
 of all the predictors.
 (code hint: Run 
\begin_inset Quotes eld
\end_inset

cor(dat)
\begin_inset Quotes erd
\end_inset

 if your data set is named dat.
 To round numbers after 3 decimal values, do 
\begin_inset Quotes eld
\end_inset

round(cor(dat), 3)
\begin_inset Quotes erd
\end_inset

.
 Then try to think of some way to wrestle that into a document.
 (For me, that's a hassle).
\end_layout

\begin_layout Enumerate

\size small
Regress each IVs on the other IVs.
 Do the 
\begin_inset Formula $R_{j}^{2}$
\end_inset

 of these 
\begin_inset Quotes eld
\end_inset

auxiliary
\begin_inset Quotes erd
\end_inset

 regressions differ much from the bivariate correlations? 
\end_layout

\begin_layout Enumerate

\size small
Get the squared partial and semi-partial correlation coefficients.
 I implemented those in rockchalk, getPartialCor and getDeltaRsquare, but
 I'm sure you'll find other packages with similar
\end_layout

\begin_layout Enumerate

\size small
If you have relaimpo, that's interesting.
 Run 
\begin_inset Quotes eld
\end_inset

calc.relimp(mod1)
\begin_inset Quotes erd
\end_inset

.
 It gives a somewhat different conclusion than the correlation coefficients.
 calc.relimp has a lot of options I've not tested yet.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{frame}
\end_layout

\end_inset


\end_layout

\begin_layout EndFrame

\end_layout

\end_body
\end_document
